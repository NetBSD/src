Bugs
----

fix crashdump for mvsata - request times out (maybe same as HEAD?)

siisata - fix all new XXX and unmergable bits, fix PMP

test crashdump with siisata
- fails with recursive panic via pmap_kremove_local() regardless if
  drive connected via PMP or direct

test wd* at umass?, confirm the ata_channel kludge works
+ add detach code (channel detach, free queue)

is ata_exec_xfer() + POLL safe wrt. more outstanding I/Os? why is it waiting
until xfer is head of queue? also layer violation with the ata_xfer_free() call

test device error handling (currently appears to not work well, at least in NCQ case)

do proper NCQ error recovery (currently not even really attempted)

maybe do device error handling in not-interrupt-context (maybe this should be
done on a mpata branch?)

atabus(4) queue depth can only shrink, causing NCQ to not be available if NCQ
drive rescaned after detach of non-NCQ drive
- careful with PMP, must be minimum of openings supported by drives
  attached to the same channel
- the downsize can leak transfers with PMP if other device happens
  to have active or pending transfers (e.g. when non-NCQ device is attached
  while there is already NCQ device present)

add mechanics to re-check queue when xfer is finished - needed on PMP
and for IDE disks, when one drive uses up all available xfers nothing
ever restarts queue for the other drives

Other random notes (do outside the NCQ branch):
-----------------------------------------------------
change wd(4) to use dk_open()

dump to unopened disk fails (e.g. dump do wd1b when wd1a not mounted), due
to the open path executing ata_get_params(), which eventually tsleeps()
while waiting for the command to finish; specifically, if WDF_LOADED is not
set 
- happens due to wd_get_params() with just AT_WAIT in wdopen()

add nibble to control number of tags (1==disable NCQ)?

add support for the NCQ TRIM if supported by device?

protect more of wddone() with mutex?

implement DIOCGCACHE/DIOCCACHESYNC for ld@ataraid? just passthrough, like ccd

MSI/MSI-X support for AHCI and mvsata(4)

mvsata - constify mvsata_pci_products and move pci-specific code to
the pci attach code

mvsata(4) 64-bit DMA
- at least with AHA1430SA does not really work, crash in mvsata_intr() on boot

malloc(M_CANFAIL) actually doesn't do anything
