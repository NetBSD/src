# $NetBSD: CHANGES-7.3,v 1.1.2.76 2020/02/12 20:21:12 martin Exp $

A complete list of changes from the NetBSD 7.2 release to the NetBSD 7.3
release:

doc/README.files				patched by hand
gnu/usr.bin/groff/tmac/mdoc.local		patched by hand
sys/sys/param.h					patched by hand

	Welcome to 7.2_STABLE.
	[snj]

sys/arch/x86/include/cacheinfo.h		1.23-1.26
sys/arch/x86/include/cpu.h			1.70
sys/arch/x86/include/specialreg.h		1.91-1.93,1.98,1.100,1.102-1.124,1.126,1.130 via patch
sys/arch/x86/x86/cpu_topology.c			1.10
sys/arch/x86/x86/identcpu.c			1.56-1.57,1.70 via patch
usr.sbin/cpuctl/arch/i386.c			1.71,1.75-1.79,1.81-1.85 via patch

	Add some register definitions for x86:
	  - Add CLWB bit.
	  - Fix a few (unused) MSR values, and add some bit definitions of
	    MSR_EFER from Murray Armfield in PR#42861.
	  - CPUID_CFLUSH bit is not for CFLUSH insn but CLFLUSH insn, so modify
	    comments and snprintb() string.
	  - Define CPUID Fn00000001 %ebx bits and use them.
	    No functional change.
	  - Add Structured Extended Flags Enumeration Leaf's bit definitions:
	    AVX512_{IFMA,VBMI2,VNNI,BITALG,VPOPCNTDQ,4VNNIW,4FMAPS},GFNI&VAES.
	  - Add Turbo Boost Max Technology 3.0 bit.
	  - Add AMD SVM features definitions.
	  - Add Intel cpuid 7 %edx IBRS and STIBP bit definitions.
	  - Fix swapped comments for EFER LME and LMA
	  - Add Intel cpuid 7 %edx bit 29 IA32_ARCH_CAPABILITIES supported bit.
	  - Add MSR_IA32_ARCH_CAPABILITIES definition.
	  - Add IA32_SPEC_CTRL MSR and IA32_PRED_CMD MSR.
	  - Add Intel Deterministic Address Translation Parameter Leaf(0x18)
	    definitions.
	  - s/CLFUSH/CLFLUSH/
	  - Add AMD's Disable Indirect Branch Predictor bit definition.
	  - Add the MSR bits definitions for IBRS, STIBP and IBPB.
	  - Add Intel Fn0000_0006 %eax new bit 14-20 (HWP stuff).
	  - Intel Fn0000_0007 %ecx bit 22 is for both RDPID and IA32_TSC_AUX.
	  - Add AMD's CPUID Fn80000001 %edx MMX and FXSR bit definitions.
	  - Add RDCL_NO and IBRS_ALL.
	  - Add SSBD and RSBA bit definitions.
	  - Add AMD's SSB bit definitions for F15H, F16H and F17H.
	  - Add cpuid 7 edx L1D_FLUSH bit.
	  - Add IA32_ARCH_SKIP_L1DFL_VMENTRY bit.
	  - Add IA32_FLUSH_CMD MSR.
	  - Add yet another Shared L2 TLB (2M/4M pages).
	  - Add 3way and 6way of L2 cache or TLB on AMD CPU.
	  - AMD L3 cache association bitfield is not 8bit but 4bit like others
	    association bitfields.
	  - Sort entries. No functional change.
	  - Modify comment, fix typo in comment and add comment.
	cpuctl(8):
	  - Add detection for Quark X1000, Xeon E5 v4, E7 v4,
	    Core i7-69xx Extreme Edition, Xeon Scalable (Skylake),
	    Xeon Phi [357]200 (Knights Landing), Atom (Goldmont),
	    Atom (Denverton), Future Core (Cannon Lake), Atom (Goldmont Plus),
	    Xeon Phi 7215, 7285 and 7295 (Knights Mill) and
	    7th or 8th gen Core (Kaby Lake, Coffee Lake).
	  - Print Structured Extended Feature leaf Fn0000_0007 %ebx on AMD,too.
	  - Print Fn0000_0007 %ecx on Intel.
	  - Print Intel cpuid 7 %edx.
	  - Parse the TLB info from `cpuid leaf 18H' on Intel processor.
	  - Use aprint_error_dev() for error output.
	[msaitoh, ticket #1636]

sbin/gpt/gpt.c					1.76

	When changing entries skip those that do not match the -L option.
	Should fix PR 53668.
	[mlelstv, ticket #1643]

sys/dev/pci/if_wm.c				1.589

	Fix KASSERT to prevent panic on CNP(Intel 300 series + I219) with
	INTx interrupt (Xen dom0 or pre netbsd-8).
	[msaitoh, ticket #1647]

sys/dev/hpc/hpckbd.c				1.33-1.35

	Fix kernel crash on hpcmips when console is attached.
	[rin, ticket #1638]

usr.bin/find/function.c				1.77

	When calculating the length of the args that can be
	appended in a "find .... -exec something {} +"
	usage, remember to allow for the arg pointers, which
	form part of what is allowed in ARG_MAX.
	[mrg, ticket #1642]

usr.sbin/sysinst/arch/sgimips/md.c		1.5-1.6

	PR port-sgimips/53583: fetch kernel name always before using it.
	Make the struct utsname local to avoid future similar issues.
	Make sure to install a bootloader even on upgrade installation.
	[tsutsui, #1640]

sys/arch/pmax/pmax/dec_3min.c			1.74

	Fix hangup after framebuffers are attached on 3MIN.
	Addresses PR port-pmax/53611
	[tsutsui, #1641]

usr.bin/systat/main.c				1.52 via patch

	Add missing 'b' to the list of options.
	Alpha-sort the option handling.
	[mrg, ticket #1639]

distrib/sgimips/instkernel/Makefile		1.13
sys/arch/sgimips/conf/INSTALL32_IP2x		1.10
sys/arch/sgimips/stand/boot/Makefile		1.20

	Disable misc options to shrink an INSTALL kernel for IP2x.
	Use elf2ecoff(1) rather than objcopy(1) to generat ecoff for
	old machines.
	[tsutsui, ticket #1637]

external/public-domain/tz/dist/CONTRIBUTING     up to 1.1.1.6
external/public-domain/tz/dist/Makefile         up to 1.1.1.22
external/public-domain/tz/dist/NEWS             up to 1.1.1.24
external/public-domain/tz/dist/README           up to 1.1.1.7
external/public-domain/tz/dist/TZDATA_VERSION   up to 1.14
external/public-domain/tz/dist/africa           up to 1.1.1.17
external/public-domain/tz/dist/antarctica       up to 1.1.1.11
external/public-domain/tz/dist/asia             up to 1.1.1.21
external/public-domain/tz/dist/australasia      up to 1.1.1.16
external/public-domain/tz/dist/backward         up to 1.1.1.9
external/public-domain/tz/dist/backzone         up to 1.1.1.15
external/public-domain/tz/dist/etcetera         up to 1.1.1.3
external/public-domain/tz/dist/europe           up to 1.1.1.23
external/public-domain/tz/dist/factory          up to 1.1.1.3
external/public-domain/tz/dist/leap-seconds.list up to 1.1.1.10
external/public-domain/tz/dist/leapseconds      up to 1.1.1.11
external/public-domain/tz/dist/leapseconds.awk  up to 1.1.1.7
external/public-domain/tz/dist/northamerica     up to 1.1.1.21
external/public-domain/tz/dist/pacificnew       up to 1.1.1.2
external/public-domain/tz/dist/southamerica     up to 1.1.1.15
external/public-domain/tz/dist/systemv          up to 1.1.1.2
external/public-domain/tz/dist/theory.html      up to 1.1.1.6
external/public-domain/tz/dist/version          up to 1.1.1.11
external/public-domain/tz/dist/yearistype.sh    up to 1.1.1.2
external/public-domain/tz/dist/ziguard.awk      up to 1.1.1.3
external/public-domain/tz/dist/zishrink.awk     up to 1.1.1.5
external/public-domain/tz/dist/zone.tab         up to 1.1.1.15
external/public-domain/tz/dist/zone1970.tab     up to 1.1.1.17
external/public-domain/tz/dist/zoneinfo2tdf.pl  up to 1.1.1.2
doc/3RDPARTY					(apply patch)

	Updated tzdata to 2018g.
	[kre, ticket #1644]

common/include/prop/prop_array.h		1.15,1.16
common/include/prop/prop_dictionary.h		1.16
common/lib/libprop/prop_copyin_ioctl.9		1.12
common/lib/libprop/prop_kern.c			1.21-1.23 (patch)

	proplib: add sized versions of the copyin ioctls and document them.
	[sborrill, ticket #1645]

sys/net/npf/npf_ctl.c				1.47 (partial, patch)

	Increase copyin buffer size to 4MB to allow larger rulesets
	to be loaded.
	[sborrill, ticket #1646]

sys/dev/mii/inbmphyreg.h			1.11
sys/dev/pci/if_wm.c				1.586-1.588, 1.590-1.596 via patch
sys/dev/pci/if_wmreg.h				1.108

	- rename tu event counter to txunderrun.
	- Try m_defrag() to reduce the number of DMA segment if
	  bus_dmamap_load_mbuf() returned EFBIG. When m_defrag()
	  is called, txqNNdefrag event counter is incremented.
	  If the 2nd try of bus_dmamap_load_mbuf() failed,
	  txqNNtoomanyseg event counter is incremented.
	- Reduce the max number of DMA segments from 256 to 64 (it's
	  the same value as other BSD's (EM_MAX_SCATTER) and more
	  than before if_wm.c rev. 1.75's value (40)) because we do
	  m_defrag() now.
	- 82574 and newer document says the status field has neither EC
	  (Excessive Collision) bit nor LC (Late Collision) bit
	  (reserved), so don't check the bit.
	- Add workaround for DMA hang problem which result in TX device
	  timeout on PCH_LPT with I218. Same as FreeBSD and Linux. This
	  workaround is only for device ID 0x155a, 0x15a2, 0x1559 and 0x15a3.
	- Fix a PCH2 specific bug that wrong PHY register value can be read
	   when boot. Same as FreeBSD and Linux.
	- After writing MDIC register, don't read quickly the same register
	  but do delay(50). Same as other OSes.
	- Add missing wm_gate_hw_phy_config_ich8lan(false) in
	  wm_phy_post_reset() on PCH2. wm_gate_hw_phy_config_ich8lan(true)
	  is called in wm_reset(), so wm_gate_hw_phy_config_ich8lan(false)
	  should be called after reset in wm_phy_post_reset().
	- On PCH2, set the phy config counter to 50msec after (PHY) reset.
	- KNF & Use macro.
	[msaitoh, ticket #1648]

sys/arch/x86/x86/coretemp.c			1.36

	- Detect and set Atom's Tj(max) to 90 if it's not the 45nm
	  D400/D500/N400 series (90 for Diamondville and 100 for Pineview).
	- Reduce diff a little against FreeBSD.
	[msaitoh, ticket #1649]

sys/arch/x86/x86/procfs_machdep.c		1.25

	Fix output of LAPIC ID and Initial APIC ID.
	[msaitoh, ticket #1650]

sys/arch/macppc/stand/ofwboot/ofdev.c		1.27
sys/arch/macppc/stand/ofwboot/version		1.14

	Fix boot failure from installation floppies.
	PR port-macppc/53727.
	[tsutsui, ticket #1651]

sys/compat/netbsd32/netbsd32_socket.c		1.48 (patch)

	Fix a buffer overflow.
	[maxv, ticket #1652]

sys/kern/kern_event.c				1.104

	Fix kernel info leak.
	[maxv, ticket #1653]

usr.sbin/mtree/create.c				1.76

	Avoid null de-reference.
	[sevan, ticket #1654]

libexec/httpd/testsuite/data/.bzremap           up to 1.1
libexec/httpd/testsuite/t12.out                 up to 1.1
libexec/httpd/testsuite/t12.in                  up to 1.1
libexec/httpd/testsuite/t13.out                 up to 1.1
libexec/httpd/testsuite/t13.in                  up to 1.1
libexec/httpd/testsuite/t14.out                 up to 1.1
libexec/httpd/testsuite/t14.in                  up to 1.1
libexec/httpd/testsuite/t15.out                 up to 1.1
libexec/httpd/testsuite/t15.in                  up to 1.1
libexec/httpd/CHANGES                           up to 1.28
libexec/httpd/Makefile                          up to 1.27
libexec/httpd/auth-bozo.c                       up to 1.22
libexec/httpd/bozohttpd.8                       up to 1.74
libexec/httpd/bozohttpd.c                       up to 1.96
libexec/httpd/bozohttpd.h                       up to 1.56
libexec/httpd/cgi-bozo.c                        up to 1.44
libexec/httpd/content-bozo.c                    up to 1.16
libexec/httpd/daemon-bozo.c                     up to 1.19
libexec/httpd/dir-index-bozo.c                  up to 1.28
libexec/httpd/lua-bozo.c                        up to 1.15
libexec/httpd/main.c                            up to 1.21
libexec/httpd/ssl-bozo.c                        up to 1.25
libexec/httpd/tilde-luzah-bozo.c                up to 1.16
libexec/httpd/libbozohttpd/Makefile             up to 1.3
libexec/httpd/lua/bozo.lua                      up to 1.3
libexec/httpd/lua/glue.c                        up to 1.5
libexec/httpd/lua/optparse.lua                  up to 1.2
libexec/httpd/testsuite/Makefile                up to 1.11
libexec/httpd/testsuite/html_cmp                up to 1.6
libexec/httpd/testsuite/t3.out                  up to 1.4
libexec/httpd/testsuite/t5.out                  up to 1.4
libexec/httpd/testsuite/t6.out                  up to 1.4
libexec/httpd/testsuite/test-bigfile            up to 1.5
libexec/httpd/testsuite/test-simple             up to 1.5

	Sync with HEAD as of 2018-11-24. Includes various changes:
	Cosmetic changes to Lua binding in bozohttpd.
	Fix -C scripts execution and document restrictions.
	Add support for remapping requested paths via a .bzredirect file.
	Handle redirections for any protocol, not just http:.
	Fix a denial of service attack against header contents, which
	is now bounded at 16KiB.
	Fix access checks for special files.
	[mrg, ticket #1655]

sys/dev/pci/if_wm.c				1.599

	Fix a bug that i82578 workarounds didn't work correctly.
	[msaitoh, ticket #1656]

sys/net/rtsock.c				1.244 (adapted)

	Fix kernel info leak (2 bytes of padding in struct if_msghdr)
	[maxv, ticket #1657]

sys/kern/kern_exec.c				1.462

	Fix stack info leak.
	[maxv, ticket #1658]

libexec/httpd/CHANGES				1.29,1.30
libexec/httpd/bozohttpd.c			1.97-1.99
libexec/httpd/bozohttpd.h			1.57
libexec/httpd/cgi-bozo.c			1.45
libexec/httpd/main.c				1.22

	Fix -X option parsing and miscelaneous cleanup.
	[mrg, ticket #1659]

sys/compat/linux/common/linux_misc_notalpha.c	1.110
sys/kern/kern_time.c				1.192,1.193

	Fix kernel info leak.
	[maxv, ticket #1660]

sys/kern/kern_sig.c				1.350

	Fix kernel info leak.
	[maxv, ticket #1661]

sys/arch/amd64/amd64/machdep.c			1.321

	Fix stack info leak.
	[maxv, ticket #1662]

bin/sh/parser.c					1.152 (patch)

	Avoid crash from redirect on null compound command.
	[kre, ticket #1663]

sys/kern/sys_sig.c				1.47

	Fix kernel info leak, 4 bytes of padding in struct _ksiginfo.
	[maxv, ticket #1664]

usr.bin/telnet/telnet.c				1.37
usr.bin/telnet/utilities.c			1.24

	Switch some sprintf to snprintf.
	[maya, ticket #1665]

sys/uvm/uvm_swap.c				1.178 (patch, adapted)
sys/compat/netbsd32/netbsd32_netbsd.c		(patch)

	Fix kernel info leak in swapctl(2).
	[maxv, ticket #1666]

sys/kern/kern_time.c				1.191

	Fix kernel info leak.
	[maxv, ticket #1667]

sys/compat/netbsd32/netbsd32_compat_14.c	1.27
sys/compat/netbsd32/netbsd32_conv.h		1.37
sys/compat/sys/msg.h				1.5
sys/compat/sys/time_types.h			1.3

	Fix kernel info leaks.
	[maxv, ticket #1668]

sys/conf/copyright				1.17

	Welcome to 2019!
	[jnemeth, ticket #1669]

external/public-domain/tz/dist/Makefile         up to 1.1.1.23
external/public-domain/tz/dist/NEWS             up to 1.1.1.26
external/public-domain/tz/dist/TZDATA_VERSION   up to 1.16
external/public-domain/tz/dist/africa           up to 1.1.1.19
external/public-domain/tz/dist/asia             up to 1.1.1.22
external/public-domain/tz/dist/australasia      up to 1.1.1.17
external/public-domain/tz/dist/leapseconds      up to 1.1.1.12
external/public-domain/tz/dist/leapseconds.awk  up to 1.1.1.8
external/public-domain/tz/dist/northamerica     up to 1.1.1.22
external/public-domain/tz/dist/theory.html      up to 1.1.1.7
external/public-domain/tz/dist/version          up to 1.1.1.13
external/public-domain/tz/dist/ziguard.awk      up to 1.1.1.4
external/public-domain/tz/dist/zone.tab         up to 1.1.1.16
external/public-domain/tz/dist/zone1970.tab     up to 1.1.1.18
distrib/sets/lists/base/mi			(patch)
doc/3RDPARTY					(patch)

	Updated tzdata to 2018i.
	[kre, ticket #1670]

sys/dev/usb/usbdi.c				1.181

	Avoid use after free when closing interrupt pipe transfer by calling
	upm_close before destroying the interupt pipe xfer.
	[skrll, ticket #1671]

sys/arch/sparc/sparc/pmap.c			1.366

	Fix deadlocks on machines with more than two cpus.
	[mrg, ticket #1672]

regress/sys/arch/m68k/060sp/Makefile		1.15

	Replace manual realdepend dependency with DPSRCS.
	[msaitoh, ticket #1674]

sys/kern/kern_ntptime.c				1.60

	Zero out the ntptimeval structure to prevent a 4 byte kernel stack
	disclosure.
	[maxv, ticket #1675]

sys/net/link_proto.c				1.37
sys/netatalk/ddp_usrreq.c			1.72
sys/netbt/hci_socket.c				1.46
sys/netbt/l2cap_socket.c			1.36
sys/netbt/rfcomm_socket.c			1.38
sys/netbt/sco_socket.c				1.38
sys/netinet/tcp_usrreq.c			1.223 via patch
sys/netinet6/raw_ip6.c				1.173
sys/netinet6/udp6_usrreq.c			1.146
sys/netmpls/mpls_proto.c			1.32
sys/netnatm/natm.c				patch

	Fix memory leaks pointed out by Ilja Van Sprundel: all
	sendoob() functions are expected to free both passed
	mbuf chains.
	[martin, ticket #1676]

sys/arch/alpha/alpha/machdep.c			1.352
sys/arch/amd64/amd64/netbsd32_machdep.c		1.117
sys/arch/arm/arm/sig_machdep.c			1.51
sys/arch/hppa/hppa/sig_machdep.c		1.26
sys/arch/i386/i386/machdep.c			1.813
sys/arch/m68k/m68k/sig_machdep.c		1.50
sys/arch/mips/mips/netbsd32_machdep.c		1.16
sys/arch/mips/mips/sig_machdep.c		1.24
sys/arch/powerpc/powerpc/sig_machdep.c		1.46
sys/arch/sh3/sh3/sh3_machdep.c			1.106
sys/arch/sparc64/sparc64/machdep.c		1.289
sys/arch/sparc64/sparc64/netbsd32_machdep.c	1.111
sys/arch/usermode/target/i386/cpu_i386.c	1.8
sys/arch/usermode/target/x86_64/cpu_x86_64.c	1.7
sys/arch/vax/vax/sig_machdep.c			1.23

	Fix widespread leak in the sendsig_siginfo() functions.
	[maxv, ticket #1677]

sys/kern/kern_time.c				1.190,1.194

	Fix kernel info leaks.
	[maxv, ticket #1678]

sys/compat/linux/common/linux_ipc.c		1.56
sys/compat/linux32/common/linux32_ipccall.c	1.12
sys/compat/netbsd32/netbsd32_compat_14.c	1.28
sys/compat/netbsd32/netbsd32_compat_14.c	1.29
sys/compat/netbsd32/netbsd32_conv.h		1.38
sys/compat/sys/ipc.h				1.6
sys/compat/sys/ipc.h				1.7
sys/compat/sys/msg.h				1.6
sys/compat/sys/sem.h				1.7
sys/compat/sys/shm.h				1.8
sys/kern/sysv_msg.c				1.73
sys/kern/sysv_sem.c				1.96
sys/kern/sysv_shm.c				1.133

	Fix kernel stack and kernel adddress leaks in msgctl, semctl, and
	shmctl system calls, for native as well as for the netbsd32, linux,
	and linux32 compatibility calls.
	[mrg, ticket #1679]

sys/net/rtsock.c		(patch)

	Fix locking for sysctl_rtable.
	[sborrill, ticket #1680]

sys/kern/kern_time.c				1.196

	Avoid panic from setitimer(2) for CLOCK_MONOTONIC.
	[mlelstv, ticket #1196]

sys/dev/scsipi/files.scsipi			1.42
sys/dev/scsipi/st.c				1.236 (patch), 1.237

	PR kern/53949: fix file mark handling.
	st(4): Fix (but disable by default) SUN compatibility mode.
	[kardel, ticket #1682]

sys/compat/netbsd32/netbsd32_compat_60.c	1.3

	Don't forget to convert the timespec.
	[martin, ticket #1683]

external/bsd/bzip2/dist/bzip2recover.c		1.4

	Apply fix for CVE-2016-3189 bzip2: heap use after free in bzip2recover
	[martin, ticket #1684]

sys/arch/mvme68k/dev/pcctwo_68k.c		1.11

	Fix small (but fatal) oversight in device/softc split.
	[martin, ticket #1685]

lib/libcurses/get_wch.c				1.21
lib/libcurses/getch.c				1.71

	Rename global variable "state" to "_cursesi_state".
	[rin, ticket #1686]

sys/arch/amd64/include/param.h			1.30

	Bump STACK_ALIGNBYTES to (16 - 1) to satisfy requirement by AMD64
	System V ABI in kernel level. This is because
	(1) for LLDB, we want to bypass libc/csu (and therefore manual stack
	     alignment in _start), and
	(2) rtld in glibc >= 2.23 for Linux/x86_64 requires it.

	Fix SEGV for Linux/x86_64 binaries with glibc >= 2.23, reported as
	PR port-amd64/54052.
	[rin, ticket #1687]

sys/kern/sys_mqueue.c				1.44

	mq_send1: fix argument validation and reject too large lengths early.
	Discovered by Andy Nguyen.
	[martin, ticket #1688]

sys/external/bsd/drm2/pci/drm_pci.c		1.32 (patch)

	Don't try to interpret the second half of a 64-bit BAR as another one.
	[dholland, ticket #1673]

sys/compat/common/uipc_syscalls_40.c		1.19 (patch)
sys/compat/linux/common/linux_socket.c		1.145 (patch)
sys/compat/linux32/common/linux32_socket.c	1.30 (patch)
sys/net/if.c					1.449 (patch)

	Zero out the ifreq struct for SIOCGIFCONF to avoid up to 127 bytes
	of stack disclosure.
	[christos, ticket #1689]

external/bsd/dhcpcd/dist/configure			(apply patch)
external/bsd/dhcpcd/dist/src/auth.c			(apply patch)
external/bsd/dhcpcd/dist/src/dhcp.c			(apply patch)
external/bsd/dhcpcd/dist/src/dhcp6.c	 		(apply patch)
external/bsd/dhcpcd/dist/compat/consttime_memequal.h 	(apply patch)

	Security fixes for dhcpcd:
	Fix a potential buffer overflow reading NA/TA addresses.
	Fix a potential 1 byte read overflow with DHO_OPTSOVERLOADED.
	Use consttime_memequal(3) to compare hashes.
	[roy, ticket #1690]

sys/dev/veriexec.config				1.1 (patch)

	Add a configuration file for enabling Veriexec in kernel config(5)
	files.
	[sevan, ticket #1691]

sys/kern/sys_pipe.c				1.147,1.148

	Clean up pipe structure before recycling it.
	Handle half-closed pipes in FIONWRITE and FIONSPACE.
	[mlelstv, ticket #1692]

sys/arch/amd64/amd64/copy.S			1.33
sys/arch/i386/i386/copy.S			1.31

	Don't forget to clear the direction flag if kcopy fails.
	[maxv, ticket #1693]

external/bsd/dhcpcd/dist/src/dhcp6.c		(apply patch)

	DHCPv6: Fix a potential read overflow with D6_OPTION_PD_EXCLUDE.
	[roy, ticket #1695]

sys/netsmb/smb_conn.c				1.30

	Prevent a NULL pointer dereference when the local endpoint is not
	defined.
	[christos, ticket #1696]

sys/ufs/ffs/ffs_alloc.c				1.164

	PR 53990, PR 52380, PR 52102:
	Fix rare allocation botch in ffs_nodealloccg().
	[kardel, ticket #1697]

sys/dev/scsipi/scsipi_ioctl.c			1.72 (patch)

	Use correct size when copying outgoing sense data.
	[mlelstv, ticket #1698]

libexec/httpd/CHANGES				1.31-1.40
libexec/httpd/Makefile				1.28
libexec/httpd/auth-bozo.c			1.23-1.24
libexec/httpd/bozohttpd.8			1.75-1.79
libexec/httpd/bozohttpd.c			1.100-1.113
libexec/httpd/bozohttpd.h			1.58-1.60
libexec/httpd/cgi-bozo.c			1.46-1.48
libexec/httpd/daemon-bozo.c			1.20-1.21
libexec/httpd/dir-index-bozo.c			1.29-1.32
libexec/httpd/ssl-bozo.c			1.26
libexec/httpd/testsuite/Makefile		1.12-1.13
libexec/httpd/testsuite/t11.out			1.2
libexec/httpd/testsuite/test-bigfile		1.6
libexec/httpd/testsuite/test-simple		1.6

	Don't display special files in the directory index.
	Use html tables for directory index.
	Don't include "index.html" in html headers.
	Fix CGI '+' param and error handling.
	Remove unused parameter to daemon_poll_err().
	Avoid sign extension in % handling
	Fix a few problems pointed out by clang static analyzer.
	Add ssl specific timeout value (30s).---
	Fix handling of bozo_set_timeout() timeouts (and `-T' option parsing).
	Avoid .htpasswd exposure to authenticated users when .htpasswd is
	in the slashdir too.
	Avoid possible NULL dereference when sending a big request that timeout.
	Avoid an assertion failure when using cgihandler (-C option).
	[mrg, ticket #1699]

sys/external/bsd/ipf/netinet/fil.c		1.30

	PR/54443: ipf mistakenly regards UDP packet with checksum field
	0xffff as bad.
	[christos, ticket #1701]

distrib/hpcarm/miniroot/list			1.11
distrib/hpcmips/miniroot/list			1.19
distrib/hpcsh/miniroot/list			1.11

	sysctl(8) is useful to have in the install env when debugging.
	[sevan, ticket #1702]

sys/miscfs/kernfs/kernfs_vnops.c		1.161
sys/miscfs/procfs/procfs_vnops.c		1.207

	Add missing operation VOP_GETPAGES() returning EFAULT.
	[hannken, ticket #1703]

external/gpl3/gdb/dist/bfd/coffgen.c		(apply patch)
external/gpl3/gdb/dist/bfd/elf.c		(apply patch)
external/gpl3/gdb/dist/bfd/elflink.c		(apply patch)
external/gpl3/gdb/dist/bfd/reloc.c		(apply patch)
external/gpl3/gdb/dist/bfd/srec.c		(apply patch)

	Cherry-pick fixes for newer compilers from -current, avoiding
	fall-through warnings.
	[mrg, ticket #1704]

sys/conf/files					1.1238
sys/crypto/nist_ctr_drbg/files.nist_ctr_drbg	delete
sys/crypto/nist_ctr_drbg/nist_ctr_aes_rijndael.h delete
sys/crypto/nist_ctr_drbg/nist_ctr_drbg.c	delete
sys/crypto/nist_ctr_drbg/nist_ctr_drbg.h	delete
sys/crypto/nist_ctr_drbg/nist_ctr_drbg_aes128.h	delete
sys/crypto/nist_ctr_drbg/nist_ctr_drbg_aes256.h	delete
sys/crypto/nist_ctr_drbg/nist_ctr_drbg_config.h	delete
sys/crypto/nist_hash_drbg/files.nist_hash_drbg	1.1
sys/crypto/nist_hash_drbg/nist_hash_drbg.c	1.1
sys/crypto/nist_hash_drbg/nist_hash_drbg.h	1.1
sys/dev/rndpseudo.c				1.38
sys/kern/subr_cprng.c				1.31
sys/rump/kern/lib/libcrypto/Makefile		1.5
sys/rump/librump/rumpkern/Makefile.rumpkern	1.176
sys/sys/cprng.h					1.13-1.15

	cprng.h: use static __inline for consistency with other include
	headers and remove an unused function.

	Switch from NIST CTR_DRBG with AES to NIST Hash_DRBG with SHA-256.
	[riastradh, ticket #1705]

lib/libc/nameser/ns_name.c			1.12

	Fix buffer overrun.
	[maya, ticket #1706]

sys/dev/usb/xhci.c				1.109,1.113

	Fix ryzen usb issue and support xhci version 3.10.
	[mrg, ticket #1707]

sys/netinet/ip_input.c				1.390 (patch)
sys/netinet6/ip6_input.c			1.209 (patch)

	Packet filters can return an mbuf chain with fragmented headers, so
	m_pullup() when needed.
	[bouyer, ticket #1708]

sys/netbt/hci.h					1.46
sys/netbt/hci_event.c				1.26

	When encrypted connections are configured, verify that the encryption
	key length has a minimum size when the adaptor supports that.
	This addresses the 'Key Negotiation of Bluetooth' attack,
	CVE-2019-9506.
	[plunky, ticket #1709]

distrib/sets/lists/modules/mi			1.127
distrib/sets/lists/modules/md.amd64		(manually adjusted)
distrib/sets/lists/modules/md.evbppc.powerpc	(manually adjusted)
distrib/sets/lists/modules/md.i386		(manually adjusted)
sys/modules/Makefile				1.229,1.230
sys/modules/filemon/Makefile			1.4 (manually adjusted)

	Do not install the filemon module.
	[maya, ticket #1710]

sys/compat/netbsd32/syscalls.master			1.129
sys/compat/netbsd32/netbsd32_syscallargs.h		(regen)
sys/compat/netbsd32/netbsd32_syscall.h			(regen)
sys/compat/netbsd32/netbsd32_sysent.c			(regen)
sys/compat/netbsd32/netbsd32_syscalls.c 		(regen)
sys/compat/netbsd32/netbsd32_syscalls_autoload.c	(regen)
sys/compat/netbsd32/netbsd32_systrace_args.c		(regen)

	For netbsd32_readlinkat(2), bufsize is netbsd_size_t, not size_t.
	[rin, ticket #1711]

sys/dev/pci/pucdata.c				1.105

	puc(4): the 16C1054 and 16C1058 serial multi-port controllers need
	a clock multiplier of 8, just like the 16C1050 controller.
	[hauke, ticket #1712]

sys/dev/usb/usb_subr.c				1.239 (patch)
sys/dev/usb/usbdi.c				1.186 (patch)
sys/dev/usb/usbdi.h				1.97 (patch)

	Work around memory corruption problem triggered by axe(4).
	[mrg, ticket #1713]

sys/kern/subr_cprng.c				1.33

	Use cprng_strong, not cprng_fast, for sysctl kern.arnd.
	[riastradh, ticket #1714]

share/man/man4/rnd.4				1.25 - 1.28

	Update man page to reflect switch from CTR_DRBG to Hash_DRBG.
	Update NIST SP800-90A reference.
	[riastradh, ticket #1715]

sys/external/bsd/dwc2/dwc2.c			1.60 - 1.66

	Make dwc2debug sysctl'able
	Calulate the right lenght for isoc transfer and the usb_syncmem
	PR/54696: Kernel panic in bus_dma.c on Raspberry Pi 3B/3B+
	[skrll, ticket #1716]

sys/dev/cons.c					1.76,1.77

	Fix reference count leak in cons(4).
	[riastradh, ticket #1717]

sys/dev/ic/ath.c				1.129

	Protect network ioctls from non-authorized users.
	[christos, ticket #1718]

sys/conf/copyright				1.18

	Welcome to 2020.
	[mlelstv, ticket #1719]

sys/compat/common/kern_sig_43.c				1.36
sys/compat/linux/arch/amd64/linux_machdep.c		1.59
sys/compat/linux/common/linux_fcntl.h			1.18
sys/compat/linux/common/linux_file64.c			1.62
sys/compat/linux/common/linux_ipc.c			1.57
sys/compat/linux/common/linux_misc.c			1.243
sys/compat/linux/common/linux_signal.c			1.81
sys/compat/linux/common/linux_socket.c			1.149 (patch)
sys/compat/linux/common/linux_socket.h			1.24
sys/compat/linux/common/linux_statfs.h			1.7
sys/compat/linux/common/linux_termios.c			1.38
sys/compat/linux/common/linux_termios.h			1.22
sys/compat/linux32/common/linux32_dirent.c		1.20
sys/compat/linux32/common/linux32_ioctl.c		1.14
sys/compat/linux32/common/linux32_misc.c		1.27
sys/compat/linux32/common/linux32_signal.c		1.20
sys/compat/linux32/common/linux32_sysinfo.c		1.8
sys/compat/linux32/common/linux32_termios.c		1.15
sys/compat/linux32/common/linux32_utsname.c		1.10
sys/compat/netbsd32/netbsd32_compat_20.c		1.39
sys/compat/netbsd32/netbsd32_compat_43.c		1.59
sys/compat/netbsd32/netbsd32_compat_50.c		1.44
sys/compat/ossaudio/ossaudio.c				1.75
sys/kern/sysv_shm.c					1.138
sys/miscfs/procfs/procfs_linux.c			1.75 (patch)
sys/sys/shm.h						1.54 (patch)

	Fix various info leaks, out of bound access, usage of uninitialized
	values and direct access to userland variables from kernel space
	and memory leaks in system calls implemented for the compatibility
	subsystems. 
	[christos, ticket #1720]

sys/arch/mac68k/nubus/grf_nubus.c		1.78

	Set sc_dev field of softc.
	[tsutsui, ticket #1721]

external/bsd/ppp/dist/pppd/eap.c		1.5

	pppd: Fix bounds check in EAP code
	[christos, ticket #1722]

