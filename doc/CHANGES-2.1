#	$NetBSD: CHANGES-2.1,v 1.1.2.42 2005/03/22 19:09:02 tron Exp $

A complete list of changes from the NetBSD 2.0 release to the NetBSD 2.1 
release

File						Revision(s)
----						--------
sys/sys/param.h                                 patch
share/tmac/doc-common                           patch
gnu/usr.bin/groff/tmac/mdoc.local               patch

	Welcome to 2.0_STABLE

sys/dev/mii/igphy.c				1.5
sys/dev/mii/igphyreg.h				1.2
sys/dev/pci/if_wmreg.h				1.12
sys/dev/pci/if_wm.c				1.78

	Fix major performance issues with the i82547 Gig-E chip:
	- enable the SmartSpeed work-around code for the IGP phy, with some
	  minor adjustments.
	- add some useful constants related to the Packet Buffer Allocation
	  register.
	- add the Receive and Transmit Data FIFO registers.
	- change the Tx:Rx on-chip RAM allocation ratio based on MTU.
	- On the 82547, keep track of how much of the Tx FIFO has been used.
	[thorpej, ticket #897]

sys/dev/pci/if_sk.c				1.11
sys/dev/pci/if_skreg.h				1.3
sys/dev/pci/if_skvar.h				1.4

	Fix Yukon ram sizing.
	Fix tx queue (slist can be corrupted when tx interrupts hit within
	tx_encap.
	Lower interrupt moderation timer to (improves performance).
	Improve chip identification. (from linux sk98lin driver).
	Keep tx queue running by kicking the tx bmu repeatedly.
	[abs, ticket #973]

sys/arch/powerpc/powerpc/trap.c			1.104

	Make sure to do setenv/unsetenv in pairs.  This prevents panics in
	DIAGNOSTIC kernel when crossing segment boundaries.
	[matt, ticket #985]

sys/arch/macppc/conf/INSTALL			1.78

	Now that we have ofwboot load at 0xe00000, it doesn't make sense for
	this kernel to load at 0x800000 - move back to the default and we
	have around 13 MB of space for the kernel.
	[wrstuden, ticket #951]

sys/arch/sparc64/sparc64/pmap.c			1.157

	Do the invalidation of the (virtually-addressed) L1 cache in
	pmap_remove_all() (ie. just before we skip the per-page cache
	invalidations while tearing down each context) instead of just
	before we recycle all the contexts in ctx_alloc().  The latter
	is not good enough since a (physically tagged) L1 cache line is
	valid for all contexts, not just the one that was used to
	instantiate it. PR#24126, PR#25669 and PR#27730.
	[martin, ticket #1013]

sys/arch/sparc64/sparc64/pmap.c			1.158

	Better return value checking for pseg_get/pseg_set. Turn Debugger()
	calls into proper panics and sprinkle some KASSERTs. PR#27288.
	[martin, ticket #1014]

lib/libc/arch/sparc64/gen/_setjmp.S		1.6

	Replace the stack unwinding by a much simpler solution taken from
	../../arch/sparc/gen/_setjmp.S rev. 1.6. This ended up to be
	~identical to the OpenBSD change triggered by the same sparc change.
	[martin, ticket #1020]

lib/libc/arch/x86_64/gen/swapcontext.S 		1.3

	Use correct stack offsets after pushing values onto it.
	PR#28486.
	[hira, ticket #1029]

sys/net/if_media.c				1.23

	Add malloc_type M_IFMEDIA and use it for both malloc'ing and free'ing 
	ifmedia_entrys to prevent panic(9) in DIAGNOSTIC kernels.
	[dyoung, ticket #1030]

sys/arch/xen/i386/locore.S			1.7

	HYPERVISOR_yield is one of the hypervisor calls that's "overloaded";
	it does different things depending what's in %ebx.

	We weren't setting %ebx here *at all*; so we did not get
	SCHEDOP_yield, which was what was wanted; so unpredictable things
	happened, notably immediate return to the NetBSD idle loop, in
	other words spinning on CPU.
	[tls, ticket #1043]

sys/arch/xen/i386/machdep.c			1.11

	Terminate the domain on RB_HALT, not just on reboot.  This avoids
	looping around a cngetc() that will never return while "halted".
	[tls, ticket #1045]

sys/arch/sh3/sh3/mmu.c				1.10
sys/arch/sh3/sh3/mmu_sh3.c			1.7
sys/arch/sh3/sh3/mmu_sh4.c			1.8

	Protect accesses to PTE/TLB registers with 
	_cpu_exception_suspend()/_cpu_exception_resume() pair. Prevents 
	spontaneous reboot under heavy load
	[tsutsui, ticket #1072]

sys/nfs/nfsnode.h				patch
sys/nfs/nfs_vnops.c				patch

	nfs_lookup: check n_nctime for positive entries as well to improve
	cache consistency.
	[yamt, ticket #1077]

sys/nfs/nfs.h					patch
sys/nfs/nfs_socket.c				patch
sys/nfs/nfs_var.h				patch
sys/nfs/nfs_vnops.c				patch
sys/nfs/nfsm_subs.h				patch

	Don't do kludge for a reply to a retransmitted request
	unless we actually retransmitted the request.
	[yamt, ticket #1078]

sys/nfs/nfs_subs.c				1.140
sys/nfs/nfsnode.h				1.53

	Invalidate cache if filesize is changed besides our activity
	because it means that were out of sync with the server.
	[yamt, ticket #1079]

sys/dev/ic/tulip.c				1.130

	Silence the 'receive process failed to idle' message on the Davicom 
	DM9102A.
	[sketch, ticket #1084]

usr.sbin/ypserv/ypinit/ypinit.sh		1.12

	Fix a bug which caused "ypinit" to die with a strange error message
	if "/var/yp/binding" does not exist.
	[tron, ticket #893]

sys/dev/pci/if_wm.c				1.79 via patch
sys/dev/pci/if_wmreg.h				1.13

	Largest Tx descriptor buffer size is actually 4K.
	[thorpej, ticket #898]

sys/dev/pci/if_wm.c				1.80 via patch

	Restructure the loop in wm_start() that passes over the
	DMA map segments slightly to make it easier to drop in
	errata work-arounds that require adding extra descriptors
	onto the end of the packet.
	[thorpej, ticket #899]

dist/ntp/ntpd/ntp_io.c				1.11
dist/ntp/ntpd/ntp_proto.c			1.4

	Fix core dump problem if local system and ntp server do
	not have overlapping protocol family support (IPv4 vs.
	IPv6).  Instead, report server as unreachable, and ignore
	entry.  Fixes PR#27137.
	[christos, ticket #901]

sys/kern/sysv_sem.c				1.55

	Update sem_otime on successful call to semop().
	Fixes long-standing bug in the SYSV semaphore code which
	causes an example in Stevens' UNPv2 to fail when trying
	to compensate for a race condition in a file locking
	implementation.
	[briggs, ticket #903]

x11/Xserver/Makefile				1.13
x11/Xserver/Makefile.common			1.19
x11/Xserver/miext/Makefile			1.2
x11/Xserver/miext/shadow/Makefile		1.3
x11/Xserver/miext/shadow/Makefile.shadow	1.1 (new)
x11/Xserver/miext/shadow/module/Makefile	1.1 (new)
x11/Xserver/miext/layer/Makefile		1.3
x11/Xserver/miext/layer/Makefile.layer		1.1 (new)
x11/Xserver/miext/layer/module/Makefile		1.1 (new)
distrib/sets/lists/xserver/md.amd64		1.9
distrib/sets/lists/xserver/md.cats		1.5
distrib/sets/lists/xserver/md.i386		1.25
distrib/sets/lists/xserver/md.macppc		1.17
distrib/sets/lists/xserver/md.sgimips		1.7

	Build and install libshadow.a and liblayer.a.
	Fixes PR#27156.
	[rtr, tickets 905, 906, 907]

etc/rc.d/syslogd				1.15

	Use "load_rc_config `basename chrootdirscript`" in a subshell
	to determine the rc.conf(5) setting for chrootdirscript, incase
	the configuration for that is in /etc/rc.conf.d/chrootdirscript.
	Fixes PR#26478.
	[lukem, ticket #912]

usr.bin/passwd/krb5_passwd.c			1.12

	Switch to krb5_set_password that can handle the RFC3244 (as
	well as the older change password protocol).  Should enable
	changing password in a Windows2000 (or later) domain.
	[lha, ticket #917]

sys/arch/sparc64/dev/auxio.c			1.13

	In auxio_blink(), only toggle the AUXIO_LED_LED bit, don't
	clear the others.  It looks like bit 3 control the on-board
	le's link test, clearing it breaks the interface (no link
	detected on the remote end). Bit 3 is defined as AUXIO4M_LTE
	(link-test enable) for sun4m systems (maybe all the AUXIO4M_*
	bits are valid on the Ultra/1 too?).
	Tested on Ultra/1 and Ultra/5.  Fixes PR#25039.
	[bouyer, ticket #924]

lib/libc/citrus/citrus_mmap.c			1.2

	Correct check for mmap return value.  Also clean up
	the error path, convert to KNF, and use the proper stat
	macro.  Fixes PR#27283.
	[christos, ticket #931]

sys/fs/smbfs/smbfs_vnops.c			1.45

	Import a change from FreeBSD: use DENYNONE to give unixy
	semantics of permitting everything not forbidden by
	permissions.  I.e. denial is up to the server with
	clients/openers needing to use advisory locks for further
	control.  Fixes file access problem when the file is already
	open on the server.
	[peter, ticket #933]


sys/arch/alpha/a12/if_ade.c			1.23
sys/arch/amiga/dev/if_ed.c			1.46
sys/arch/amiga/dev/if_es.c			1.35
sys/arch/mac68k/dev/if_mc.c			1.24
sys/arch/mac68k/dev/if_sn.c			1.35
sys/arch/mac68k/nubus/if_netdock_nubus.c	1.5
sys/arch/macppc/dev/am79c950.c			1.16
sys/arch/macppc/dev/if_bm.c			1.23
sys/arch/macppc/dev/if_gm.c			1.23
sys/arch/mips/alchemy/dev/if_aumac.c		1.12
sys/arch/newsmips/apbus/if_sn.c			1.15
sys/arch/next68k/dev/mb8795.c			1.34
sys/arch/playstation2/dev/if_smap.c		1.6
sys/arch/powerpc/ibm4xx/dev/if_emac.c		1.19
sys/arch/sgimips/hpc/if_sq.c			1.21
sys/arch/sun3/dev/if_ie.c			1.40
sys/dev/bi/if_ni.c				1.23
sys/dev/i2o/iopl.c				1.14
sys/dev/ic/aic6915.c				1.12
sys/dev/ic/atw.c				1.80
sys/dev/ic/awi.c				1.66
sys/dev/ic/cs89x0.c				1.15
sys/dev/ic/dp8390.c				1.54
sys/dev/ic/dp83932.c				1.10
sys/dev/ic/elink3.c				1.108
sys/dev/ic/elinkxl.c				1.75
sys/dev/ic/gem.c				1.32
sys/dev/ic/hme.c				1.43
sys/dev/ic/i82557.c				1.88
sys/dev/ic/i82586.c				1.49
sys/dev/ic/smc91cxx.c				1.49
sys/dev/ic/i82596.c				1.3
sys/dev/ic/lance.c				1.30
sys/dev/ic/lemac.c				1.26
sys/dev/ic/mb86960.c				1.58
sys/dev/ic/mtd803.c				1.6
sys/dev/ic/rtl81x9.c				1.47
sys/dev/ic/seeq8005.c				1.36
sys/dev/ic/sgec.c				1.23
sys/dev/ic/smc83c170.c				1.56
sys/dev/ic/wi.c					1.188
sys/dev/pci/if_bge.c				1.77
sys/dev/pci/if_de.c				1.112
sys/dev/pci/if_dge.c				1.7
sys/dev/pci/if_pcn.c				1.24
sys/dev/pci/if_re.c				1.6
sys/dev/pci/if_sip.c				1.96
sys/dev/pci/if_sk.c				1.12
sys/dev/pci/if_ste.c				1.20
sys/dev/pci/if_stge.c				1.22
sys/dev/pci/if_tl.c				1.66
sys/dev/pci/if_txp.c				1.8
sys/dev/pci/if_vr.c				1.70
sys/dev/pci/if_wm.c				1.83
sys/dev/pcmcia/if_cnw.c				1.29
sys/dev/pcmcia/if_ray.c				1.54
sys/dev/qbus/if_qe.c				1.58
sys/dev/sbus/be.c				1.44
sys/dev/sbus/qe.c				1.33
sys/dev/scsipi/if_se.c				1.51
sys/dev/usb/if_aue.c				1.88
sys/dev/usb/if_udav.c				1.4
sys/dev/usb/if_url.c				1.12

	When adding or deleting multicast addresses, only change
	the address filter if the interface is marked RUNNING.
	Fixes PR#27678.
	[thorpej, ticket #939]

sys/dev/ic/tulip.c				1.129

	When adding or deleting multicast addresses, only change
	the address filter if the interface is marked RUNNING.
	Fixes PR#27678.
	[thorpej, ticket #940]

sys/dve/isa/if_iy.c				1.65

	When adding or deleting multicast addresses, only change
	the address filter if the interface is marked RUNNING.
	Fixes PR#27678.
	[thorpej, ticket #941]

sys/dev/qbus/if_qt.c				1.5

	In qtinit(), don't skip initialization if the interface is
	already RUNNING.  ether_ioctl() will call (*if_init)() when
	flags change.  Instead, do what other drivers do, and stop
	the interface in this case before re-initializing.
	In qtioctl(), now that qtinit() does the right thing, remove
	the check for the IFF_PROMISC change.
	When adding or deleting multicast addresses, only change
	the address filter if the interface is marked RUNNING.
	Fixes PR#27678.
	[thorpej, ticket #942]

sys/dev/ic/i82596.c				1.4

	Make iee_ioctl() look more like other drivers, and fix a
	missing splx(s) as a side-effect.  Don't bother handling
	IFF_PROMISC here, because ether_ioctl() already calls
	(*if_init)() to handle flag changes.
	When adding or deleting multicast addresses, only change
	the address filter if the interface is marked RUNNING.
	Fixes PR#27678.
	[thorpej, ticket #943]

sys/dev/pci/auvia.c				1.43
sys/dev/pci/auviavar.h				1.6

	Add support for suspending/resuming.  Fixes PR#26432.
	[kent, ticket #949]

bin/pax/options.c				1.82

	Fix broken cpio(1) option handling:
	 o "cpio -i -t" should list the contents of a file, not
	   extract it.
	 o Don't extract a file when only option "-d" is given.
	Fixes PR#26513.
	[tron, ticket #952]

sys/netinet6/ipsec.c				1.98-1.99

	Add a missing break.
	[itojun, ticket #954]

usr.sbin/syslogd/syslogd.c			1.68

	Postpone initial setting of the alarm timer until after
	the call to daemon(), as the timer would be cleared by
	deamon's fork().  Fixes PR#19558.
	[heas, ticket #958]

sys/dev/pci/cs4281.c				1.21

	Make recording of clct(4) work, namely:
	 o cs_4281_intr: advance a pointer after copying data
	 o cs_4281_trigger_input: fix an inverted condition about
	   dma mode
	[yamt, ticket #967]

sys/nfs/nfs_bio.c				1.122
sys/nfs/nfs_subs.c				1.138
sys/nfs/nfsnode.h				1.50

	Since daddr_t is 64-bit these days, simply use nfs directory
	cookies as buffer cache indexes.  This should make the
	regress/sys/fs/getdents test work.  Fixes PR#27112.
	[yamt, ticket #968]

xsrc/xfree/xc/programs/xdm/config/Imakefile	1.4 
xsrc/xfree/xc/programs/xdm/config/NetBSD.xpm	1.1 (new)
xsrc/xfree/xc/programs/xdm/config/NetBSDbw.xpm	1.1 (new)
xsrc/xfree/xc/programs/xdm/config/NetBSDinv.xpm 1.1 (new)
x11/bin/xdm/config/Makefile			1.10 via patch
distrib/sets/lists/xetc/mi			patch
distrib/sets/lists/xbase4/mi			1.14 via patch

	Add new NetBSD logo pixmaps.
	[jschauma, ticket #978]

sys/dist/ipf/netinet/fil.c			1.7 (new)
sys/dist/ipf/netinet/ip_auth.c			1.2 (new)
sys/dist/ipf/netinet/ip_auth.h			1.1 (new)
sys/dist/ipf/netinet/ip_compat.h		1.3 (new)
sys/dist/ipf/netinet/ip_fil.h			1.1 (new)
sys/dist/ipf/netinet/ip_fil_netbsd.c		1.3 (new)
sys/dist/ipf/netinet/ip_frag.c			1.1 (new)
sys/dist/ipf/netinet/ip_frag.h			1.1 (new)
sys/dist/ipf/netinet/ip_ftp_pxy.c		1.4 (new)
sys/dist/ipf/netinet/ip_h323_pxy.c		1.1 (new)
sys/dist/ipf/netinet/ip_htable.c		1.1 (new)
sys/dist/ipf/netinet/ip_htable.h		1.1 (new)
sys/dist/ipf/netinet/ip_ipsec_pxy.c		1.1 (new)
sys/dist/ipf/netinet/ip_irc_pxy.c		1.2 (new)
sys/dist/ipf/netinet/ip_log.c			1.1 (new)
sys/dist/ipf/netinet/ip_lookup.c		1.1 (new)
sys/dist/ipf/netinet/ip_lookup.h		1.1 (new)
sys/dist/ipf/netinet/ip_nat.c			1.3 (new)
sys/dist/ipf/netinet/ip_nat.h			1.2 (new)
sys/dist/ipf/netinet/ip_netbios_pxy.c		1.1 (new)
sys/dist/ipf/netinet/ip_pool.c			1.1 (new)
sys/dist/ipf/netinet/ip_pool.h			1.1 (new)
sys/dist/ipf/netinet/ip_pptp_pxy.c		1.1 (new)
sys/dist/ipf/netinet/ip_proxy.c			1.1 (new)
sys/dist/ipf/netinet/ip_proxy.h			1.1 (new)
sys/dist/ipf/netinet/ip_raudio_pxy.c		1.1 (new)
sys/dist/ipf/netinet/ip_rcmd_pxy.c		1.4 (new)
sys/dist/ipf/netinet/ip_rpcb_pxy.c		1.4 (new)
sys/dist/ipf/netinet/ip_scan.c			1.2 (new)
sys/dist/ipf/netinet/ip_scan.h			1.1 (new)
sys/dist/ipf/netinet/ip_state.c			1.2 (new)
sys/dist/ipf/netinet/ip_state.h			1.1 (new)
sys/dist/ipf/netinet/ip_sync.c			1.1 (new)
sys/dist/ipf/netinet/ip_sync.h			1.1 (new)
sys/dist/ipf/netinet/ipl.h			1.1 (new)
sys/netinet/fil.c				deleted
sys/netinet/ip_auth.c				deleted
sys/netinet/ip_auth.h				deleted
sys/netinet/ip_compat.h				deleted
sys/netinet/ip_fil.h				deleted
sys/netinet/ip_fil_netbsd.c			deleted
sys/netinet/ip_frag.c				deleted
sys/netinet/ip_frag.h				deleted
sys/netinet/ip_ftp_pxy.c			deleted
sys/netinet/ip_h323_pxy.c			deleted
sys/netinet/ip_htable.c				deleted
sys/netinet/ip_htable.h				deleted
sys/netinet/ip_ipsec_pxy.c			deleted
sys/netinet/ip_irc_pxy.c			deleted
sys/netinet/ip_log.c				deleted
sys/netinet/ip_lookup.c				deleted
sys/netinet/ip_lookup.h				deleted
sys/netinet/ip_nat.c				deleted
sys/netinet/ip_nat.h				deleted
sys/netinet/ip_netbios_pxy.c			deleted
sys/netinet/ip_pool.c				deleted
sys/netinet/ip_pool.h				deleted
sys/netinet/ip_pptp_pxy.c			deleted
sys/netinet/ip_proxy.c				deleted
sys/netinet/ip_proxy.h				deleted
sys/netinet/ip_raudio_pxy.c			deleted
sys/netinet/ip_rcmd_pxy.c			deleted
sys/netinet/ip_rpcb_pxy.c			deleted
sys/netinet/ip_scan.c				deleted
sys/netinet/ip_scan.h				deleted
sys/netinet/ip_state.c				deleted
sys/netinet/ip_state.h				deleted
sys/netinet/ip_sync.c				deleted
sys/netinet/ip_sync.h				deleted
sys/netinet/ipl.h				deleted
sys/lkm/netinet/if_ipl/Makefile			1.17
sys/lkm/netinet/if_ipl/mln_ipl.c		1.35
dist/ipf/ip_fil.c				1.4
dist/ipf/l4check/l4check.c			1.2
dist/ipf/lib/addicmp.c				1.2-1.4
dist/ipf/lib/getportproto.c			1.2-1.4
dist/ipf/lib/getproto.c				1.2
dist/ipf/lib/hexdump.c				1.2
dist/ipf/lib/hostnum.c				1.2-1.4
dist/ipf/lib/icmpcode.c				1.2-1.4
dist/ipf/lib/inet_addr.c			1.2
dist/ipf/lib/ipft_hx.c				1.2-1.4
dist/ipf/lib/ipft_tx.c				1.2-1.4
dist/ipf/lib/natparse.c				1.2
dist/ipf/lib/parse.c				1.2
dist/ipf/lib/portnum.c				1.2-1.4
dist/ipf/lib/ports.c				1.2-1.4
dist/ipf/lib/printbuf.c				1.2-1.4
dist/ipf/lib/printsbuf.c			1.2
dist/ipf/lib/var.c				1.4
dist/ipf/tools/ipfstat.c			1.7-1.8
dist/ipf/tools/ipmon.c				1.5
dist/ipf/tools/ipnat_y.y			1.6-1.8
dist/ipf/tools/ipscan_y.y			1.2
dist/ipf/tools/lexer.c				1.8-1.9
dist/ipf/iplang/iplang_y.y			1.6
dist/ipf/ipsd/sbpf.c				1.3
dist/ipf/ipsd/sdlpi.c				1.3
dist/ipf/ipsend/ipsend.c			1.10-1.12
dist/ipf/ipsend/sbpf.c				1.5-1.6
dist/ipf/ipsend/sdlpi.c				1.4
dist/ipf/ipf2netbsd				1.16-1.17
usr.sbin/ipf/Makefile.inc			1.14
usr.sbin/ipf/ipfstat/Makefile			1.19
usr.sbin/ipf/ipftest/Makefile			1.29-1.30
usr.sbin/ipf/ipsend/Makefile			1.24
usr.sbin/ipf/ipmon/Makefile			1.21
distrib/sets/lists/man/mi			1.745
regress/sys/kern/ipf/expected/ni10		1.2
regress/sys/kern/ipf/expected/ni11		1.2
sys/arch/acorn26/conf/Makefile.acorn26		patch
sys/arch/acorn32/conf/Makefile.acorn32		patch
sys/arch/alpha/conf/Makefile.alpha		patch
sys/arch/amd64/conf/Makefile.amd64		patch
sys/arch/amiga/conf/Makefile.amiga		patch
sys/arch/amigappc/conf/Makefile.amigappc	patch
sys/arch/arc/conf/Makefile.arc.inc		patch
sys/arch/arm/conf/Makefile.arm			patch
sys/arch/atari/conf/Makefile.atari		patch
sys/arch/cats/conf/Makefile.cats.inc		patch
sys/arch/cesfic/conf/Makefile.cesfic		patch
sys/arch/dreamcast/conf/Makefile.dreamcast.inc	patch
sys/arch/evbarm/conf/Makefile.evbarm.inc	patch
sys/arch/evbmips/conf/Makefile.evbmips.inc	patch
sys/arch/evbppc/conf/Makefile.evbppc.inc	patch
sys/arch/hp300/conf/Makefile.hp300		patch
sys/arch/hp700/conf/Makefile.hp700		patch
sys/arch/hpcarm/conf/Makefile.hpcarm		patch
sys/arch/luna68k/conf/Makefile.luna68k		patch
sys/arch/mac68k/conf/Makefile.mac68k		patch
sys/arch/mips/conf/Makefile.mips		patch
sys/arch/mipsco/conf/Makefile.mipsco.inc	patch
sys/arch/mmeye/conf/Makefile.mmeye.inc		patch
sys/arch/mvme68k/conf/Makefile.mvme68k		patch
sys/arch/netwinder/conf/Makefile.netwinder.inc	patch
sys/arch/news68k/conf/Makefile.news68k		patch
sys/arch/next68k/conf/Makefile.next68k		patch
sys/arch/pc532/conf/Makefile.pc532		patch
sys/arch/pdp10/conf/Makefile.pdp10		patch
sys/arch/playstation2/conf/Makefile.playstation2.inc		patch
sys/arch/pmax/conf/Makefile.pmax.inc		patch
sys/arch/powerpc/conf/Makefile.powerpc		patch
sys/arch/sbmips/conf/Makefile.sbmips.inc	patch
sys/arch/sgimips/conf/Makefile.sgimips.inc	patch
sys/arch/sh3/conf/Makefile.sh3			patch
sys/arch/sh5/conf/Makefile.sh5			patch
sys/arch/shark/conf/Makefile.shark.inc		patch
sys/arch/sparc/conf/Makefile.sparc		patch
sys/arch/sparc64/conf/Makefile.sparc64		patch
sys/arch/sun2/conf/Makefile.sun2		patch
sys/arch/sun3/conf/Makefile.sun3		patch
sys/arch/vax/conf/Makefile.vax			patch
sys/arch/x68k/conf/Makefile.x68k		patch
sys/arch/xen/conf/Makefile.xen			patch
sys/netinet/Makefile				patch
sys/netinet/files.ipfilter			patch

	Move ipf to sys/dist/ipf and sync w. trunk
	[martti, ticket #1086]

usr.sbin/sup/source/scm.c			1.18

	Dont set AI_NUMERICHOST in matchhost() to resolve given hostname since 
	it is supposed to be an arbitrary name (i.e. not restricted to numeric
	representation). PR#27047
	[soda, ticket #892]

sys/arch/alpha/conf/GENERIC			patch

	Cleanup audio and add USB-2 devices
	[reinoud, ticket #913]

usr.bin/sed/compile.c				1.31

	When adding text due to an a, c, or i command, don't eat the space(s) at
	the beginning of the lines since the addition is supposed to be 
	'verbatim'. Fix a comment for compile_text indicating it's also used 
	for the 'c' command.
	[matt, ticket #982]

sys/dev/ata/wd.c				1.297

	Some drives reports ATA version < 4, and still support (and need) the
	WDCC_FLUSHCACHE command. So for drive < ATA4, test WDC_CMD2_FC in 
	atap_cmd_set2 before returning ENODEV.
	[bouyer, ticket #986]

sys/dist/ipf/netinet/ip_state.c			1.3

	Disable the oow test because it is broken. It is killing valid packets.
	[martti, ticket #1098]

sys/arch/powerpc/powerpc/trap.c			1.105 via patch

	If setfault() returns nonzero (i.e. we trapped), make sure to
	unsetusr().
	[matt, ticket #987]

distrib/sets/lists/xserver/md.sgimips		1.8

	Correct set lists for sgimips.
	[rtr, ticket #993]

usr.bin/vi/vi/v_txt.c				1.12
usr.bin/vi/ex/version.h				1.17

	Move a line of code which was "obviously" misplaced.  Fixes
	a core dump when auto-completing file names and at least
	one of the file names is larger than the screen width.
	Fixes PR#28382.  Bump version.
	[aymeric, ticket #1000]

sys/dev/pci/if_wm.c				1.85

	Also toggle the second port's Ethernet address lsb on the
	WM_T_82546_3, so the two ports get different MAC addresses.
	[thorpej, ticket #1001]

usr.sbin/ifwatchd/ifwatchd.c			1.20
usr.sbin/ifwatchd/ifwatchd.8			1.21-1.23

	In the initial interface scan at start time, query the link
	status of the interfaces and call the CARRIER script if a link
	is already there.  Fixes PR#26830.
	[martin, ticket #1003]

sys/dev/dmover/dmover_io.c			1.14
sys/kern/kern_systrace.c			1.41

	Fix the fcntl entry points; ``cmd'' is a command, not the
	flags themselves.
	[thorpej, ticket #1008]

xsrc/xfree/xc/programs/Xserver/hw/xfree86/common/compiler.h		1.18
xsrc/xfree/xc/programs/Xserver/hw/xfree86/drivers/chips/util/AsmMacros.h 1.3
xsrc/xfree/xc/programs/Xserver/hw/xfree86/int10/generic.c	1.1.1.7 -> 1.2
xsrc/xfree/xc/programs/Xserver/hw/xfree86/loader/xf86sym.c		1.8
xsrc/xfree/xc/programs/Xserver/hw/xfree86/os-support/bsd/arm_video.c	1.5
xsrc/xfree/xc/programs/Xserver/hw/xfree86/os-support/bsd/mips_video.c	1.2
x11/Xserver/hw/xfree86/bin/kbd_mode/Makefile	1.2
x11/Xserver/hw/xfree86/bin/xf86cfg/Makefile	1.5
x11/Xserver/hw/xfree86/bin/xf86config/Makefile	1.5
x11/Xserver/hw/xfree86/xf86/Makefile		1.6
x11/Xserver/hw/xfree86/xf86_os/Makefile		1.9
x11/bin/xdm/config/Makefile			1.11

	Fixes for NetBSD/cats:
	 o Make sure IOPortBase is defined in the server
	 o Stop the int10 module from trying to do unaligned accesses
	 o Add VT switching support to cats port
	Also, make sure x11 still builds for sgimips.
	[skrll, ticket #1009]

etc/etc.amiga/Makefile.inc			1.24

	Ensure ISDN kernels are built for future releases.
	[is, ticket #1010]

sys/arch/amiga/conf/MDINSTALL			1.18

	Remove use of ``idesc'', use ``wdc'' instead.
	[is, ticket #1011]

sys/kern/kern_descrip.c				1.128 (via patch)

	Avoid endless loop in F_CLOSEM fnctl which could be abused for a
	local DoS. This fixes PR kern/28929.
	[cube, ticket #1089]

sys/arch/amd64/amd64/copy.S			1.2
sys/arch/i386/i386/locore.S			1.33

	Check the passed in address as well as determining the maximum length
	using VM_MAXUSER_ADDRESS in copyinstr and copyoutstr.
	[fvdl, ticket #1317]

sys/nfs/nfs_subs.c				1.146

	nfs_clearcommit: don't attempt to clear commit info (n_pushlo, etc)
	unless the vnode is of VREG. union members used to keep commit info
	are used for other purposes in the case of !VREG.
	[yamt, ticket #1148]

sys/arch/sparc/stand/common/mmu.c		1.5

	Make pmap_map() work on sun4 machines.
	[pk, ticket #1118]

sys/nfs/nfs_vnops.c				1.206

	nfs_commit: use NAC_NOTRUNC when loading an attribute
	as we're called holding pages locked.
	[yamt, ticket #1134]

sys/uvm/uvm_amap.c				1.57
sys/uvm/uvm_pdaemon.c				1.61

	Hack around a UVM problem that causes hangs when large processes fork.
	see PR 26908 for details.
	[chs, ticket #1137]

sys/arch/sparc/sparc/trap.c			1.156

	sun4c hardware reports faults by the atomic load/store instructions as
	read faults even if the problem was that the memory was read-only.
	Detect this case and relabel the fault as both read and write.
	Part of PR 25633, PR 25896.
	[chs, ticket #1158]

sys/sys/param.h                                 patch
share/tmac/doc-common                           patch
gnu/usr.bin/groff/tmac/mdoc.local               patch

	Welcome to 2.0.2

sys/arch/sparc/include/lock.h			1.18

	Add the early-clobber modifier on the destination reg of ldstub.
	In some implementations (eg. sun4c), the hardware modifies the
	destination reg before checking for write permission on the memory
	location. Without this change, gcc was using the same register for
	the address and the destination, so if the store part of the
	instruction faulted, the address was already gone when the instruction
	was retried after resolving the fault. Part of PR 25633, PR 25896.
	[chs, ticket #1159]

gnu/usr.bin/groff/tmac/mdoc.local		1.19 via patch

	Teach groff about NetBSD 1.6.3 (used by njs(4), noted by tron).
	[wiz, ticket #1167]

sys/nfs/nfs_vnops.c				1.219

	nfs_readdirrpc, nfs_readdirplusrpc:
	Avoid infinite loops when getting readdir response without
	any entries or EOF. PR/28971.
	[yamt, ticket #1208]

sys/arch/sun3/include/param3.h                  1.50

	Bring back the sun3 MAXPHYS definition that has been missing for
	8 years. More recently, we changed to relying on MAXPHYS rather
	than MAXBSIZE to limit page cache I/O sizes, and sun3 has been
	broken since then.
	[chs, ticket #1229]

sys/kern/vfs_lookup.c				1.57

	Adjust error case handling. If the VOP_LOOKUP() call unlocked the
	parent directory node, remember that.
	[wrstuden, ticket #1298]

sys/dev/pci/pciide_common.c			1.22
sys/dev/pci/pciidevar.h				1.26

	Move bus_dma setup out of pciide_dma_init() in a new function,
	pciide_dma_dmamap_setup(), for the benefit of drivers that needs
	special registers setup in dmainit().
	[bouyer, ticket #1016]

share/mk/bsd.x11.mk				1.42
xfree/xc/config/cf/Imake.rules			1.6

	Modify CppRawFileTarget() to transform trailing backslashes in the
	input manpages so the backslash is followed by a blank, defeating the C
	preprocessor's tendency to remove the following newline (Thomas Dickey,
	Debian #259996). This is a partial fix for our PR misc/28444.
	[fredb, ticket #1017]

sys/arch/xen/i386/locore.S			1.10

	Sync with i386/locore.S 1.33:
	Check the passed in address as well as determining the maximum length
	using VM_MAXUSER_ADDRESS in copyinstr and copyoutstr.
	[bouyer, ticket #1321]

xsrc/xfree/xc/extras/Xpm/lib/Attrib.c		1.4
xsrc/xfree/xc/extras/Xpm/lib/CrDatFrI.c		1.4
xsrc/xfree/xc/extras/Xpm/lib/hashtab.c		1.4
xsrc/xfree/xc/extras/Xpm/lib/parse.c		1.4
xsrc/xfree/xc/extras/Xpm/lib/scan.c		1.4
xsrc/xfree/xc/extras/Xpm/lib/CrBufFrI.c		1.3
xsrc/xfree/xc/extras/Xpm/lib/RdFToI.c		1.3
xsrc/xfree/xc/extras/Xpm/lib/WrFFrI.c		1.3
xsrc/xfree/xc/extras/Xpm/lib/XpmI.h		1.3
xsrc/xfree/xc/extras/Xpm/lib/data.c		1.3
xsrc/xfree/xc/extras/Xpm/lib/xpm.h		1.3
xsrc/xfree/xc/extras/Xpm/lib/Imakefile		1.2
xsrc/xfree/xc/extras/Xpm/lib/RdFToBuf.c		1.2
xsrc/xfree/xc/extras/Xpm/lib/WrFFrBuf.c		1.2
xsrc/xfree/xc/extras/Xpm/lib/misc.c		1.2
xsrc/xfree/xc/extras/Xpm/lib/create.c		1.6

        Import latest Xpm sources from OpenBSD:
          o Changes from X.Org 6.8.2 RC1
          o Fix security problems reported in CAN-2005-0605
        [tron, ticket #1304]

sys/sys/param.h                                 patch
share/tmac/doc-common                           patch
gnu/usr.bin/groff/tmac/mdoc.local               patch

        Note that 2.0.2 exists but this branch is 2.0_STABLE until 2.1
	releases.

distrib/notes/sparc64/install			1.24-1.25

	Add description for Solaris 10 dual boot installation from Ben Collver
	in PR port-sparc64/29703.
	[martin, ticket #1322]

sys/dev/ata/ata_wdc.c				1.55
sys/dev/ata/atavar.h				1.43
sys/dev/ic/wdc.c				1.180

	Only downgrade modes due to an actual CRC error.  Downgrading on other 
	errors is anti-social -- especially given that there's no way to 
	upgrade again short of rebooting.

	Also, downgrade UDMA modes more slowly.  It's entirely possible that 
	they're using an 80-wire cable, but it's just too long for the higher 
	modes, or there is minor crosstalk.
	[mycroft, ticket #1018]

gnu/dist/binutils/bfd/ChangeLog                 1.2 via patch
gnu/dist/binutils/bfd/elf64-sparc.c             1.4

	Fix bug in "binutils" which broke Firefox under NetBSD-sparc64.
	[skrll, ticket #1101]

sys/dev/ata/ata_wdc.c				1.77

	Move ata_dmaerr() so that it's called only when there really has been
	an error (ata_bio->r_error doesn't containt anything meaningfull if
	no error occured). Fix kern/28255 by Izumi Tsutsui, but with a
	different patch.
	[bouyer, ticket #1324]

sys/dev/ata/ata_wdc.c				1.78

	Also call ata_dmaerr() on DMA errors (as reported by the underlying
	controller driver). We want to downgrade to PIO mode if DMA isn't
	functionnal.
	[bouyer, ticket #1325]

sys/dev/tc/px.c					1.22

	Fix a 3 year old error which caused px_init() to fail. Fixes PR 28798.
	[mhitch, ticket #1063]

sys/netinet6/ipsec.c                            1.101

	Fix possible remote DoS via IPSec AH packets.
	[itojun, ticket #1327]

sys/arch/prep/prep/ibm_7043_140.c		1.4
sys/arch/prep/prep/machdep.c			1.52

	Ensure that the OpenPIC register window is mapped during
	the startup; only parts of the PCI memory space is mapped
	already.  Move initialization since it requires UVM.
	[jkunz, ticket 1152]

lib/libpthread/pthread.3			1.4

	Document PTHREAD_CONCURRENCY.
	[daniel, ticket #1166]

sys/arch/sparc/sparc/machdep.c			1.252
sys/arch/sparc64/sparc64/machdep.c		1.177
sys/kern/kern_sa.c				1.57 via patch
sys/sys/lwp.h					1.25 via patch

	Define a new LWP flag which indicates that we're in the process of
	doing a context switch.  use this on sparc and sparc64 to avoid trying
	to access user memory (writing the register windows back to the stack)
	in this case (since it's both unnecessary and wrong).
	[chs, ticket #1160]

sys/dev/cgd_crypto.c				1.4

	Clear freed memory.
	[dan, ticket #1343]

sys/arch/evbppc/conf/Makefile.ev64260.inc	1.3
sys/arch/evbppc/conf/Makefile.obs405.inc	1.2
sys/arch/evbppc/conf/Makefile.walnut.inc	1.3

	Can't depend on shell scripts being executable from CVS. Preface
	mkimg.sh with ${HOST_SH}
	[jmc, ticket #1350]

