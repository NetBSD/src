# $NetBSD: CHANGES-7.1.3,v 1.1.2.24 2018/11/28 19:56:34 martin Exp $

A complete list of changes from the NetBSD 7.1.2 release to the NetBSD 7.1.3
release:

doc/README.files				patched by hand
gnu/usr.bin/groff/tmac/mdoc.local		patched by hand
sys/sys/param.h					patched by hand

	Welcome to 7.1.2_PATCH.
	[snj]

sys/dev/ppbus/if_plip.c				1.28

	Fix an spl(9) leak.
	[msaitoh, ticket #1579]

sys/sys/bitops.h				1.12-1.14

	Fix sign issues.
	Avoid undefined behaviour when a left shift may be greater than
	the size of the bitmap type.
	[mrg, ticket #1582]

external/public-domain/tz/dist/ziguard.awk      up to 1.1.1.1
external/public-domain/tz/dist/CONTRIBUTING     up to 1.1.1.5
external/public-domain/tz/dist/Makefile         up to 1.1.1.20
external/public-domain/tz/dist/NEWS             up to 1.1.1.21
external/public-domain/tz/dist/README           up to 1.1.1.6
external/public-domain/tz/dist/TZDATA_VERSION   up to 1.11
external/public-domain/tz/dist/africa           up to 1.1.1.14
external/public-domain/tz/dist/antarctica       up to 1.1.1.10
external/public-domain/tz/dist/asia             up to 1.1.1.19
external/public-domain/tz/dist/australasia      up to 1.1.1.14
external/public-domain/tz/dist/backzone         up to 1.1.1.14
external/public-domain/tz/dist/checktab.awk     up to 1.1.1.9
external/public-domain/tz/dist/europe           up to 1.1.1.20
external/public-domain/tz/dist/leap-seconds.list up to 1.1.1.9
external/public-domain/tz/dist/leapseconds      up to 1.1.1.10
external/public-domain/tz/dist/northamerica     up to 1.1.1.19
external/public-domain/tz/dist/southamerica     up to 1.1.1.14
external/public-domain/tz/dist/theory.html      up to 1.1.1.3
external/public-domain/tz/dist/version          up to 1.1.1.8
external/public-domain/tz/dist/zishrink.awk     up to 1.1.1.3
external/public-domain/tz/dist/zone.tab         up to 1.1.1.14
external/public-domain/tz/dist/zone1970.tab     up to 1.1.1.16
doc/3RDPARTY					1.1506 (patch)

	Updated tzdata to 2018d.
	[kre, ticket #1589]

sys/netinet6/ip6_forward.c			1.91 (patch)

	Fix two IPv6 ipsec use-after-free issues.
	[maxv, ticket #1590]

sys/netinet6/raw_ip6.c				1.161

	Fix use-after-free.
	[maxv, ticket #1591]

sys/net/npf/npf.h				1.55

	Fix an integer overflow that allows incoming IPv6 packets
	to bypass a certain number of filtering rules.
	[maxv, ticket #1593]

sys/kern/uipc_mbuf.c				1.182
sys/netinet/ip_reass.c				1.14
sys/netinet6/frag6.c				1.67
sys/sys/mbuf.h					1.179

	Remove M_PKTHDR from secondary mbufs when reassembling packets.
	[maxv, ticket #1594]

external/gpl3/binutils/dist/bfd/elflink.c	1.14

	When trying to decide the status of a weak symbol, resolve any
	indirectness first.
	[joerg, ticket #1595]

bin/ed/ed.1					1.32
bin/ed/main.c					1.29
usr.bin/patch/pch.c				1.29

	patch: Pass -S to ed(1) so that patches containing ! commands
	don't run commands.
	ed: add -S to disable ! commands.
	[christos, ticket #1596]

sys/arch/amiga/amiga/cc.c			1.27

	Fix a spl(9) leak.
	[msaitoh, ticket #1597]

sys/kern/uipc_mbuf.c				1.190

	m_pkthdr_remove(): if the mbuf is shared leave M_PKTHDR
	in place.
	[maxv, ticket #1598]

sys/netipsec/ipsec_mbuf.c			1.23,1.24 (patch)

	Don't assume M_PKTHDR is set only on the first mbuf of the chain.
	Fix a pretty bad mistake (IPsec DoS).
	[maxv, ticket #1599]

sys/netipsec/ipsec_output.c			1.67,1.75 (patch)

	compute_ipsec_pos: strengthen checks to avoid overruns,
	allow the function to fail (and drop the misformed packet).
	[maxv, ticket #1600]

crypto/external/bsd/heimdal/dist/kdc/connect.c	1.3

	Avoid busy-waiting on a dead child.
	[spz, ticket #1601]

sys/kern/uipc_mbuf.c				1.211 (patch)

	Modify m_defrag, so that it never frees the first mbuf of
	the chain.
	[maxv, ticket #1602]

sys/net/npf/npf_alg_icmp.c			1.27-1.29
sys/net/npf/npf_inet.c				1.45

	Fix use-after-free.
	[maxv, ticket #1605]

sys/kern/uipc_mbuf.c				1.214

	Revert ticket #1598:
	remove the M_READONLY check. The initial code was correct.
	[maxv, ticket #1606]

sys/netinet/udp_usrreq.c			1.237 (patch)

	Fix bad/wrong memory deallocations and dangling pointer
	issues in NAT-T.
	[maxv, ticket #1607]

sbin/fsck_lfs/bufcache.c			1.20
sbin/fsck_lfs/bufcache.h			1.14

	Fix incore(), use a 64bit logical block number.
	[maya, ticket #1612]

usr.sbin/makefs/ffs.c				1.70

	Fix makefs UFS2 lazy inode initialization.
	[maya, ticket #1615]

share/i18n/esdb/ISO-8859/ISO-8859.alias		1.4

	Add more aliases for Hebrew and Arabic ISO-8859-... encodings.
	[maya, ticket #1616]

xsrc/xfree/xc/programs/mkfontscale/ident.c	(apply patch)

	Pass gzFile, not gzFile * to gzio functions.
	[mrg, ticket #1618]

usr.bin/printf/printf.c				1.37-1.39

	Fix some error handling.
	Avoid running off into oblivion when a format string,
	or arg to a %b conversion ends in an unescaped backslash.
	Avoid printing error messages twice when an invalid
	escape sequence (\ sequence) is present in an arg to a %b
	conversion.
	[kre, ticket #1619]

sys/netinet6/frag6.c				1.64

	Ignore zero-sized fragments.
	[maxv, ticket #1630]

xsrc/external/mit/libX11/dist/src/FontNames.	(patch)
xsrc/external/mit/libX11/dist/src/GetFPath.c	(patch)
xsrc/external/mit/libX11/dist/src/LiHosts.c	(patch)
xsrc/external/mit/libX11/dist/src/ListExt.c	(patch)

	Apply fixes from libX11 1.6.5 for the following vulnerabilities:
	Fixed off-by-one writes (CVE-2018-14599)
	Validation of server response in XListHosts
	Fixed out of boundary write (CVE-2018-14600)
	Fixed crash on invalid reply (CVE-2018-14598)
	[mrg, ticket #1635]

external/public-domain/tz/dist/CONTRIBUTING     up to 1.1.1.6
external/public-domain/tz/dist/Makefile         up to 1.1.1.22
external/public-domain/tz/dist/NEWS             up to 1.1.1.24
external/public-domain/tz/dist/README           up to 1.1.1.7
external/public-domain/tz/dist/TZDATA_VERSION   up to 1.14
external/public-domain/tz/dist/africa           up to 1.1.1.17
external/public-domain/tz/dist/antarctica       up to 1.1.1.11
external/public-domain/tz/dist/asia             up to 1.1.1.21
external/public-domain/tz/dist/australasia      up to 1.1.1.16
external/public-domain/tz/dist/backward         up to 1.1.1.9
external/public-domain/tz/dist/backzone         up to 1.1.1.15
external/public-domain/tz/dist/etcetera         up to 1.1.1.3
external/public-domain/tz/dist/europe           up to 1.1.1.23
external/public-domain/tz/dist/factory          up to 1.1.1.3
external/public-domain/tz/dist/leap-seconds.list up to 1.1.1.10
external/public-domain/tz/dist/leapseconds      up to 1.1.1.11
external/public-domain/tz/dist/leapseconds.awk  up to 1.1.1.7
external/public-domain/tz/dist/northamerica     up to 1.1.1.21
external/public-domain/tz/dist/pacificnew       up to 1.1.1.2
external/public-domain/tz/dist/southamerica     up to 1.1.1.15
external/public-domain/tz/dist/systemv          up to 1.1.1.2
external/public-domain/tz/dist/theory.html      up to 1.1.1.6
external/public-domain/tz/dist/version          up to 1.1.1.11
external/public-domain/tz/dist/yearistype.sh    up to 1.1.1.2
external/public-domain/tz/dist/ziguard.awk      up to 1.1.1.3
external/public-domain/tz/dist/zishrink.awk     up to 1.1.1.5
external/public-domain/tz/dist/zone.tab         up to 1.1.1.15
external/public-domain/tz/dist/zone1970.tab     up to 1.1.1.17
external/public-domain/tz/dist/zoneinfo2tdf.pl  up to 1.1.1.2
doc/3RDPARTY					(apply patch)

	Updated tzdata to 2018g.
	[kre, ticket #1644]

sys/compat/netbsd32/netbsd32_socket.c		1.48 (patch)

	Fix a buffer overflow.
	[maxv, ticket #1652]

sys/kern/kern_event.c				1.104

	Fix kernel info leak.
	[maxv, ticket #1653]

libexec/httpd/testsuite/data/.bzremap           up to 1.1
libexec/httpd/testsuite/t12.out                 up to 1.1
libexec/httpd/testsuite/t12.in                  up to 1.1
libexec/httpd/testsuite/t13.out                 up to 1.1
libexec/httpd/testsuite/t13.in                  up to 1.1
libexec/httpd/testsuite/t14.out                 up to 1.1
libexec/httpd/testsuite/t14.in                  up to 1.1
libexec/httpd/testsuite/t15.out                 up to 1.1
libexec/httpd/testsuite/t15.in                  up to 1.1
libexec/httpd/CHANGES                           up to 1.28
libexec/httpd/Makefile                          up to 1.27
libexec/httpd/auth-bozo.c                       up to 1.22
libexec/httpd/bozohttpd.8                       up to 1.74
libexec/httpd/bozohttpd.c                       up to 1.96
libexec/httpd/bozohttpd.h                       up to 1.56
libexec/httpd/cgi-bozo.c                        up to 1.44
libexec/httpd/content-bozo.c                    up to 1.16
libexec/httpd/daemon-bozo.c                     up to 1.19
libexec/httpd/dir-index-bozo.c                  up to 1.28
libexec/httpd/lua-bozo.c                        up to 1.15
libexec/httpd/main.c                            up to 1.21
libexec/httpd/ssl-bozo.c                        up to 1.25
libexec/httpd/tilde-luzah-bozo.c                up to 1.16
libexec/httpd/libbozohttpd/Makefile             up to 1.3
libexec/httpd/lua/bozo.lua                      up to 1.3
libexec/httpd/lua/glue.c                        up to 1.5
libexec/httpd/lua/optparse.lua                  up to 1.2
libexec/httpd/testsuite/Makefile                up to 1.11
libexec/httpd/testsuite/html_cmp                up to 1.6
libexec/httpd/testsuite/t3.out                  up to 1.4
libexec/httpd/testsuite/t5.out                  up to 1.4
libexec/httpd/testsuite/t6.out                  up to 1.4
libexec/httpd/testsuite/test-bigfile            up to 1.5
libexec/httpd/testsuite/test-simple             up to 1.5

	Sync with HEAD as of 2018-11-24. Includes various changes:
	Cosmetic changes to Lua binding in bozohttpd.
	Fix -C scripts execution and document restrictions.
	Add support for remapping requested paths via a .bzredirect file.
	Handle redirections for any protocol, not just http:.
	Fix a denial of service attack against header contents, which
	is now bounded at 16KiB.
	Fix access checks for special files.
	[mrg, ticket #1655]

sys/net/rtsock.c				1.244 (adapted)

	Fix kernel info leak (2 bytes of padding in struct if_msghdr)
	[maxv, ticket #1657]

sys/kern/kern_exec.c				1.462

	Fix stack info leak.
	[maxv, ticket #1658]

libexec/httpd/CHANGES				1.29,1.30
libexec/httpd/bozohttpd.c			1.97-1.99
libexec/httpd/bozohttpd.h			1.57
libexec/httpd/cgi-bozo.c			1.45
libexec/httpd/main.c				1.22

	Fix -X option parsing and miscelaneous cleanup.
	[mrg, ticket #1659]

