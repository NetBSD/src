#	$NetBSD: CHANGES-4.0.2,v 1.1.2.53 2009/08/25 18:13:01 snj Exp $

A complete list of changes from the NetBSD 4.0.1 release to the NetBSD 4.0.2
release:

File						Revision(s)
----						--------
gnu/usr.bin/groff/tmac/mdoc.local		patch
sys/sys/param.h					patch

	Welcome to 4.0.1_PATCH

sys/arch/cobalt/conf/INSTALL                    1.32,1.35

        Enable bpfilter so that dhclient can work.  Allow root device to be
        detected, rather than hardcoding it to nfs.
        [tsutsui, ticket #1217]

doc/3RDPARTY                                    patch
distrib/sets/lists/base/mi                      1.773
share/zoneinfo/africa                           1.1.1.26
share/zoneinfo/asia                             1.1.1.43
share/zoneinfo/australasia                      1.17
share/zoneinfo/backward                         1.1.1.19
share/zoneinfo/europe                           1.1.1.38
share/zoneinfo/iso3166.tab                      1.1.1.17
share/zoneinfo/leapseconds                      1.1.1.15 
share/zoneinfo/northamerica                     1.1.1.42
share/zoneinfo/southamerica                     1.1.1.39,1.1.1.40
share/zoneinfo/zone.tab                         1.1.1.31

        Update to tzdata2008g.
        [jnemeth, ticket #1213]

share/man/man8/afterboot.8			1.35, 1.37, 1.38 via patch

	Fix reference to sshd_config and provide more information
	about DHCP.
	[tsutsui, ticket #1218]

distrib/notes/common/main			1.421
distrib/notes/common/sysinst			1.95
distrib/notes/i386/hardware			1.124
distrib/notes/mac68k/install			1.30

	Use `\*[Am]' rather than `\*&' for ampersand.
	[tsutsui, ticket #1219]

sys/arch/atari/dev/ncr5380.c                    1.56
 
	Fix hang when using SCSI devices on Atari Falcon and TT030.
	[abs, ticket #1222]
        
usr.bin/fsplit/fsplit.c				1.26 via patch

	Two robustness fixes:
	   (1) make ridiculously small filename buffer larger;
	   (2) don't accidentally try to generate files with names
	       containing '/'.
	[dholland, ticket #1238]

common/lib/libprop/prop_dictionary.c		1.33
common/lib/libprop/prop_number.c		1.20
common/lib/libprop/prop_object.c		1.23 via patch
common/lib/libprop/prop_object_impl.h		1.28

	Fix two race conditions in proplib.
	[haad, ticket #1243]

sys/dev/pci/if_wm.c				1.163

	Fixes nasty EEPROM-trashing bug on ich8 and ich9 chipsets
	as described in
	  http://mail-index.netbsd.org/current-users/2008/12/02/msg006435.html
	[sketch, ticket #1246]

sys/arch/atari/dev/clock.c			1.39
sys/arch/atari/include/param.h			1.31
	Simplify delay based on x86 version.
	[tsutsui, ticket #1253]

sys/arch/sparc/stand/bootblk/bootblk.fth	1.8

	Instead of bailing out with "Inode not directory", assume that
	the disk is a RAIDframe mirror, apply the RAID boot offset,
	and try to boot again.
	Fixes the problem where disks would be unbootable if partitioned
	normally and then converted to RAID 1 without being zeroed first.
	[jdc, ticket #1251]

lib/libc/gen/fts.c				1.35

	Ensure fts_close() doesn't spuriously close fd 0,
	by testing FTS_SYMFOLLOW in fts_flags instead of fts_options.
	Fix provided by Ben Harris in PR 40319
	[lukem, ticket #1256]

distrib/atari/floppies/common/dot.profile	1.3
distrib/atari/floppies/install/list		1.8
distrib/atari/floppies/prepare/install.md	1.3
distrib/atari/floppies/prepare/list		1.5
distrib/atari/miniroot/Makefile.inc		delete
distrib/atari/miniroot/disktab.shadow		delete
distrib/atari/miniroot/dot.profile		delete
distrib/atari/miniroot/install.md		delete
distrib/atari/miniroot/list			delete
distrib/atari/miniroot/termcap.vt		delete
sys/arch/atari/stand/installboot/installboot.c	1.21

	Since dl.d_type is always "unknown" now, pick the type of bootblock to
	install based on the device name: eg /dev/fd0c would be floppy
	Fix atari sysinst based miniroot image, and retire old (unreferenced)
	miniroot.
	[abs, ticket #1257]

usr.bin/make/make.1				1.151

	Fix blatantly wrong exposition of .WAIT example.
	PR bin/40372 from Gao Ya'nan.
	[dholland, ticket #1262]

sys/dev/pci/aac_pci.c				1.26

	Allocate enough space for the aac_pci_softc, not just the aac_softc.
	[briggs, ticket #1255]

share/misc/airport				1.31

	PR/40404 - Robert Elz -- Thailand airport updates
	[jnemeth, ticket #1265]

sys/arch/m68k/fpe/fpu_emulate.c			1.28

	In fpu_emul_arith(), check lower 7 bits in word1 rather than only
	6 bits to check 040/060 FP instructions, and don't call fpu_implode()
	and fpu_upd_fpsr() if no vaild emulated result is set otherwise these
	functions cause NULL pointer dereference.
	[tsutsui, ticket #1268]

usr.bin/locale/locale.c				1.7

	Fix off-by-one in malloc().
	[tnozaki, ticket #1269]

sbin/raidctl/raidctl.c				1.40

	Use correct format to print the "numBlocks" element in a RAIDframe
	component label. raidctl(8) should now print the correct number of
	blocks for RAID sets larger than 1TB.

	Patch supplied by Bernhard Moellemann in PR bin/40479.
	[tron, ticket #1270]

tools/compat/compat_defs.h			patch
tools/compat/configure				patch
tools/compat/configure.ac			patch
tools/compat/nbtool_config.h.in			patch

	Fix build on netbsd-5 amd64 hosts.
	[adrianp, ticket #1278]

sys/kern/init_sysctl.c				1.158

	always calculate "needed" for KERN_FILE2 calls.  this allows a caller
	to get an estimate of the needed space, like the intention is.
	[mrg, ticket #1287]

usr.sbin/pstat/pstat.c				1.113

	convert getfiles() to use KERN_FILE2 sysctl.
	Now it can survive "struct file" changing, as is upcoming.
	[mrg, ticket #1289]

share/man/man3/bits.3				1.3

	PR/39381 - Taylor R Campbell
	missing line break causing funny formatting
	[dholland, ticket #1293]

common/lib/libprop/prop_object.c		 patch

	Fix crash where user was able to crash proplib with trying to
	internalize bad xml file with non-existing data type e.g. <number>.
	[haad, ticket #1296]

sys/sys/file.h                                  patch
sys/kern/uipc_usrreq.c                          patch

        Avoid deep recursion and file descriptor exhaustion.
        1. unp_detach: go not call unp_gc directly for descriptors
        that are unixdomain sockets themselves. Instead mark them
        for cleanup during garbage collection.
        2. unp_gc: handle detach of descriptors that were marked earlier.
        3. prohibit transfer of descriptors within SCM_RIGHTS messages if
        (num_files_in_transit > maxfiles / unp_rights_ratio)
        [mlelstv, ticket #1303]

sys/dist/pf/net/pf.c				1.54

	Fix http://www.securityfocus.com/archive/1/502634.
	[christos, ticket #1305]

sys/arch/mvme68k/stand/Makefile.booters		1.18
sys/arch/mvme68k/stand/bootst/dev_tape.c	1.11
sys/arch/mvme68k/stand/bootst/version		1.5

	Fix for install/40961: The RAMDISK kernel has grown significantly
	since bootst was written. Grab 3MB of the kernel image from tape
	in hackprom_diskrd() instead of 2MB.
	Bump bootst version on account of the above fix.
	While here, use -Os instead of -O2 to compile mvme68k stand code.
	[scw, ticket #1304]

dist/ntp/ntpq/ntpq.c				1.12

	Fix CVE-2009-0159.
	[christos, ticket #1308]

lib/libc/db/btree/bt_split.c			1.19
lib/libc/db/hash/hash_buf.c			1.15, 1.16
lib/libc/db/mpool/mpool.c			1.19

	Avoid information leaks by zeroing memory.
	[christos, ticket #1310]

lib/libc/db/hash/hash_buf.c			1.17, 1.18

	Fix build fallout from ticket 1310
	[hauke, ticket #1311]

usr.sbin/racoonctl/Makefile			1.5 via patch

	adjust the ADMINPORTDIR to match that of racoon (with which
	it'll want to talk) fixes PR 41376
	[spz, ticket #1312]

lib/libc/stdio/vfwprintf.c			1.15

	printf("%zi\n", (ssize_t)-1); now correcly prints -1 on i386
	[cube, ticket #1313]

share/man/man8/afterboot.8			1.39

	Fix typo, from Shannon -jj Behrens in PR 41375.
	[dholland, ticket #1314]

sys/arch/sparc/include/psl.h			1.45

	Add memory clobbers to the inline assembler modifying/testing the %psr
	register, to avoid the compiler reordering instructions out of critical
	sections. Should fix PR port-sparc/41372.
	[martin, ticket #1317]

lib/libc/gen/sysctl.3				patch

	document PROC_PID_LIMIT_SBSIZE. Addresses PR 36463.
	[snj, ticket #1318]           

dist/ntp/ntpd/ntp_crypto.c			1.15

	Fix CVE-2009-1252: Buffer overflow in ntpd crypto code. A remote
	attacker can send a specially constructed request packet that
	would overflow the sprintf()'ed buffer causing ntpd to crash.
	[mrg, ticket #1320]

sys/net80211/ieee80211_netbsd.h			1.15
sys/sys/queue.h					1.49

	Move TAILQ_FOREACH_SAFE to sys/queue.h.
	[joerg, ticket #1321]

Makefile					patch
UPDATING					patch
distrib/sets/lists/base/mi			patch
distrib/sets/lists/base/shl.elf			patch
distrib/sets/lists/base/shl.mi			patch
distrib/sets/lists/comp/mi			patch
distrib/sets/lists/comp/shl.mi			patch
distrib/sets/lists/man/mi			patch
external/Makefile				patch
external/bsd/Makefile				patch
external/bsd/fetch/Makefile			patch
external/bsd/fetch/Makefile.inc			patch
external/bsd/fetch/dist/libfetch/common.c	patch
external/bsd/fetch/dist/libfetch/common.h	patch
external/bsd/fetch/dist/libfetch/errlist.sh	patch
external/bsd/fetch/dist/libfetch/fetch.3	patch
external/bsd/fetch/dist/libfetch/fetch.c	patch
external/bsd/fetch/dist/libfetch/fetch.cat3	patch
external/bsd/fetch/dist/libfetch/fetch.h	patch
external/bsd/fetch/dist/libfetch/file.c		patch
external/bsd/fetch/dist/libfetch/ftp.c		patch
external/bsd/fetch/dist/libfetch/ftp.errors	patch
external/bsd/fetch/dist/libfetch/http.c		patch
external/bsd/fetch/dist/libfetch/http.errors	patch
external/bsd/fetch/lib/Makefile			patch
external/bsd/fetch/lib/shlib_version		patch
external/bsd/libarchive/Makefile		patch
external/bsd/libarchive/Makefile.inc		patch
external/bsd/libarchive/prepare-import.sh	patch
external/bsd/libarchive/bin/Makefile		patch
external/bsd/libarchive/bin/Makefile.inc	patch
external/bsd/libarchive/bin/cpio/Makefile	patch
external/bsd/libarchive/bin/tar/Makefile	patch
external/bsd/libarchive/dist/COPYING		patch
external/bsd/libarchive/dist/NEWS		patch
external/bsd/libarchive/dist/cpio/bsdcpio.1	patch
external/bsd/libarchive/dist/cpio/cmdline.c	patch
external/bsd/libarchive/dist/cpio/cpio.c	patch
external/bsd/libarchive/dist/cpio/cpio.h	patch
external/bsd/libarchive/dist/cpio/cpio_platform.h patch
external/bsd/libarchive/dist/cpio/err.c		patch
external/bsd/libarchive/dist/cpio/matching.c	patch
external/bsd/libarchive/dist/cpio/matching.h	patch
external/bsd/libarchive/dist/cpio/pathmatch.c	patch
external/bsd/libarchive/dist/cpio/pathmatch.h	patch
external/bsd/libarchive/dist/cpio/test/list.h	patch
external/bsd/libarchive/dist/cpio/test/main.c	patch
external/bsd/libarchive/dist/cpio/test/test.h	patch
external/bsd/libarchive/dist/cpio/test/test_0.c	patch
external/bsd/libarchive/dist/cpio/test/test_basic.c patch
external/bsd/libarchive/dist/cpio/test/test_format_newc.c patch
external/bsd/libarchive/dist/cpio/test/test_gcpio_compat.c patch
external/bsd/libarchive/dist/cpio/test/test_gcpio_compat_ref.bin.uu patch
external/bsd/libarchive/dist/cpio/test/test_gcpio_compat_ref.crc.uu patch
external/bsd/libarchive/dist/cpio/test/test_gcpio_compat_ref.newc.uu patch
external/bsd/libarchive/dist/cpio/test/test_gcpio_compat_ref.ustar.uu patch
external/bsd/libarchive/dist/cpio/test/test_option_B.c patch
external/bsd/libarchive/dist/cpio/test/test_option_L.c patch
external/bsd/libarchive/dist/cpio/test/test_option_a.c patch
external/bsd/libarchive/dist/cpio/test/test_option_c.c patch
external/bsd/libarchive/dist/cpio/test/test_option_d.c patch
external/bsd/libarchive/dist/cpio/test/test_option_ell.c patch
external/bsd/libarchive/dist/cpio/test/test_option_f.c patch
external/bsd/libarchive/dist/cpio/test/test_option_f.cpio.uu patch
external/bsd/libarchive/dist/cpio/test/test_option_help.c patch
external/bsd/libarchive/dist/cpio/test/test_option_m.c patch
external/bsd/libarchive/dist/cpio/test/test_option_m.cpio.uu patch
external/bsd/libarchive/dist/cpio/test/test_option_t.c patch
external/bsd/libarchive/dist/cpio/test/test_option_t.cpio.uu patch
external/bsd/libarchive/dist/cpio/test/test_option_t.stdout.uu patch
external/bsd/libarchive/dist/cpio/test/test_option_tv.stdout.uu patch
external/bsd/libarchive/dist/cpio/test/test_option_u.c patch
external/bsd/libarchive/dist/cpio/test/test_option_version.c patch
external/bsd/libarchive/dist/cpio/test/test_option_y.c patch
external/bsd/libarchive/dist/cpio/test/test_option_z.c patch
external/bsd/libarchive/dist/cpio/test/test_owner_parse.c patch
external/bsd/libarchive/dist/cpio/test/test_pathmatch.c patch
external/bsd/libarchive/dist/libarchive/archive.h patch
external/bsd/libarchive/dist/libarchive/archive_check_magic.c patch
external/bsd/libarchive/dist/libarchive/archive_endian.h patch
external/bsd/libarchive/dist/libarchive/archive_entry.3 patch
external/bsd/libarchive/dist/libarchive/archive_entry.c patch
external/bsd/libarchive/dist/libarchive/archive_entry.h patch
external/bsd/libarchive/dist/libarchive/archive_entry_copy_stat.c patch
external/bsd/libarchive/dist/libarchive/archive_entry_link_resolver.c patch
external/bsd/libarchive/dist/libarchive/archive_entry_private.h patch
external/bsd/libarchive/dist/libarchive/archive_entry_stat.c patch
external/bsd/libarchive/dist/libarchive/archive_entry_strmode.c patch
external/bsd/libarchive/dist/libarchive/archive_platform.h patch
external/bsd/libarchive/dist/libarchive/archive_private.h patch
external/bsd/libarchive/dist/libarchive/archive_read.3 patch
external/bsd/libarchive/dist/libarchive/archive_read.c patch
external/bsd/libarchive/dist/libarchive/archive_read_data_into_fd.c patch
external/bsd/libarchive/dist/libarchive/archive_read_extract.c patch
external/bsd/libarchive/dist/libarchive/archive_read_open_fd.c patch
external/bsd/libarchive/dist/libarchive/archive_read_open_file.c patch
external/bsd/libarchive/dist/libarchive/archive_read_open_filename.c patch
external/bsd/libarchive/dist/libarchive/archive_read_open_memory.c patch
external/bsd/libarchive/dist/libarchive/archive_read_private.h patch
external/bsd/libarchive/dist/libarchive/archive_read_support_compression_all.c patch
external/bsd/libarchive/dist/libarchive/archive_read_support_compression_bzip2.c patch
external/bsd/libarchive/dist/libarchive/archive_read_support_compression_compress.c patch
external/bsd/libarchive/dist/libarchive/archive_read_support_compression_gzip.c patch
external/bsd/libarchive/dist/libarchive/archive_read_support_compression_none.c patch
external/bsd/libarchive/dist/libarchive/archive_read_support_compression_program.c patch
external/bsd/libarchive/dist/libarchive/archive_read_support_format_all.c patch
external/bsd/libarchive/dist/libarchive/archive_read_support_format_ar.c patch
external/bsd/libarchive/dist/libarchive/archive_read_support_format_cpio.c patch
external/bsd/libarchive/dist/libarchive/archive_read_support_format_empty.c patch
external/bsd/libarchive/dist/libarchive/archive_read_support_format_iso9660.c patch
external/bsd/libarchive/dist/libarchive/archive_read_support_format_mtree.c patch
external/bsd/libarchive/dist/libarchive/archive_read_support_format_tar.c patch
external/bsd/libarchive/dist/libarchive/archive_read_support_format_zip.c patch
external/bsd/libarchive/dist/libarchive/archive_string.c patch
external/bsd/libarchive/dist/libarchive/archive_string.h patch
external/bsd/libarchive/dist/libarchive/archive_string_sprintf.c patch
external/bsd/libarchive/dist/libarchive/archive_util.3 patch
external/bsd/libarchive/dist/libarchive/archive_util.c patch
external/bsd/libarchive/dist/libarchive/archive_virtual.c patch
external/bsd/libarchive/dist/libarchive/archive_windows.c patch
external/bsd/libarchive/dist/libarchive/archive_windows.h patch
external/bsd/libarchive/dist/libarchive/archive_write.3 patch
external/bsd/libarchive/dist/libarchive/archive_write.c patch
external/bsd/libarchive/dist/libarchive/archive_write_disk.3 patch
external/bsd/libarchive/dist/libarchive/archive_write_disk.c patch
external/bsd/libarchive/dist/libarchive/archive_write_disk_private.h patch
external/bsd/libarchive/dist/libarchive/archive_write_disk_set_standard_lookup.c patch
external/bsd/libarchive/dist/libarchive/archive_write_open_fd.c patch
external/bsd/libarchive/dist/libarchive/archive_write_open_file.c patch
external/bsd/libarchive/dist/libarchive/archive_write_open_filename.c patch
external/bsd/libarchive/dist/libarchive/archive_write_open_memory.c patch
external/bsd/libarchive/dist/libarchive/archive_write_private.h patch
external/bsd/libarchive/dist/libarchive/archive_write_set_compression_bzip2.c patch
external/bsd/libarchive/dist/libarchive/archive_write_set_compression_compress.c patch
external/bsd/libarchive/dist/libarchive/archive_write_set_compression_gzip.c patch
external/bsd/libarchive/dist/libarchive/archive_write_set_compression_none.c patch
external/bsd/libarchive/dist/libarchive/archive_write_set_compression_program.c patch
external/bsd/libarchive/dist/libarchive/archive_write_set_format.c patch
external/bsd/libarchive/dist/libarchive/archive_write_set_format_ar.c patch
external/bsd/libarchive/dist/libarchive/archive_write_set_format_by_name.c patch
external/bsd/libarchive/dist/libarchive/archive_write_set_format_cpio.c patch
external/bsd/libarchive/dist/libarchive/archive_write_set_format_cpio_newc.c patch
external/bsd/libarchive/dist/libarchive/archive_write_set_format_pax.c patch
external/bsd/libarchive/dist/libarchive/archive_write_set_format_shar.c patch
external/bsd/libarchive/dist/libarchive/archive_write_set_format_ustar.c patch
external/bsd/libarchive/dist/libarchive/config_freebsd.h patch
external/bsd/libarchive/dist/libarchive/config_windows.h patch
external/bsd/libarchive/dist/libarchive/cpio.5	patch
external/bsd/libarchive/dist/libarchive/filter_fork.c patch
external/bsd/libarchive/dist/libarchive/filter_fork.h patch
external/bsd/libarchive/dist/libarchive/libarchive-formats.5 patch
external/bsd/libarchive/dist/libarchive/libarchive.3 patch
external/bsd/libarchive/dist/libarchive/libarchive_internals.3 patch
external/bsd/libarchive/dist/libarchive/mtree.5	patch
external/bsd/libarchive/dist/libarchive/tar.5 patch
external/bsd/libarchive/dist/libarchive/test/list.h patch
external/bsd/libarchive/dist/libarchive/test/main.c patch
external/bsd/libarchive/dist/libarchive/test/read_open_memory.c patch
external/bsd/libarchive/dist/libarchive/test/test.h patch
external/bsd/libarchive/dist/libarchive/test/test_acl_basic.c patch
external/bsd/libarchive/dist/libarchive/test/test_acl_pax.c patch
external/bsd/libarchive/dist/libarchive/test/test_archive_api_feature.c patch
external/bsd/libarchive/dist/libarchive/test/test_bad_fd.c patch
external/bsd/libarchive/dist/libarchive/test/test_compat_gtar.c patch
external/bsd/libarchive/dist/libarchive/test/test_compat_gtar_1.tgz.uu patch
external/bsd/libarchive/dist/libarchive/test/test_compat_tar_hardlink.c patch
external/bsd/libarchive/dist/libarchive/test/test_compat_tar_hardlink_1.tar.uu patch
external/bsd/libarchive/dist/libarchive/test/test_compat_zip.c patch
external/bsd/libarchive/dist/libarchive/test/test_compat_zip_1.zip.uu patch
external/bsd/libarchive/dist/libarchive/test/test_empty_write.c patch
external/bsd/libarchive/dist/libarchive/test/test_entry.c patch
external/bsd/libarchive/dist/libarchive/test/test_entry_strmode.c patch
external/bsd/libarchive/dist/libarchive/test/test_link_resolver.c patch
external/bsd/libarchive/dist/libarchive/test/test_pax_filename_encoding.c patch
external/bsd/libarchive/dist/libarchive/test/test_pax_filename_encoding.tar.gz.uu patch
external/bsd/libarchive/dist/libarchive/test/test_read_compress_program.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_data_large.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_extract.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_ar.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_cpio_bin.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_cpio_bin_Z.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_cpio_bin_bz2.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_cpio_bin_gz.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_cpio_odc.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_cpio_svr4_gzip.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_cpio_svr4c_Z.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_empty.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_gtar_gz.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_gtar_sparse.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_gtar_sparse_1_13.tgz.uu patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_gtar_sparse_1_17.tgz.uu patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_gtar_sparse_1_17_posix00.tgz.uu patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_gtar_sparse_1_17_posix01.tgz.uu patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_gtar_sparse_1_17_posix10.tgz.uu patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_gtar_sparse_1_17_posix10_modified.tar.uu patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_iso_gz.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_isorr_bz2.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_isorr_bz2.iso.bz2.uu patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_mtree.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_pax_bz2.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_tar.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_tar_empty_filename.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_tar_empty_filename.tar.uu patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_tbz.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_tgz.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_tz.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_zip.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_format_zip.zip.uu patch
external/bsd/libarchive/dist/libarchive/test/test_read_large.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_pax_truncated.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_position.c patch
external/bsd/libarchive/dist/libarchive/test/test_read_truncated.c patch
external/bsd/libarchive/dist/libarchive/test/test_tar_filenames.c patch
external/bsd/libarchive/dist/libarchive/test/test_tar_large.c patch
external/bsd/libarchive/dist/libarchive/test/test_ustar_filenames.c patch
external/bsd/libarchive/dist/libarchive/test/test_write_compress.c patch
external/bsd/libarchive/dist/libarchive/test/test_write_compress_program.c patch
external/bsd/libarchive/dist/libarchive/test/test_write_disk.c patch
external/bsd/libarchive/dist/libarchive/test/test_write_disk_hardlink.c patch
external/bsd/libarchive/dist/libarchive/test/test_write_disk_perms.c patch
external/bsd/libarchive/dist/libarchive/test/test_write_disk_secure.c patch
external/bsd/libarchive/dist/libarchive/test/test_write_format_ar.c patch
external/bsd/libarchive/dist/libarchive/test/test_write_format_cpio.c patch
external/bsd/libarchive/dist/libarchive/test/test_write_format_cpio_empty.c patch
external/bsd/libarchive/dist/libarchive/test/test_write_format_cpio_newc.c patch
external/bsd/libarchive/dist/libarchive/test/test_write_format_cpio_odc.c patch
external/bsd/libarchive/dist/libarchive/test/test_write_format_shar_empty.c patch
external/bsd/libarchive/dist/libarchive/test/test_write_format_tar.c patch
external/bsd/libarchive/dist/libarchive/test/test_write_format_tar_empty.c patch
external/bsd/libarchive/dist/libarchive/test/test_write_format_tar_ustar.c patch
external/bsd/libarchive/dist/libarchive/test/test_write_open_memory.c patch
external/bsd/libarchive/dist/tar/bsdtar.1	patch
external/bsd/libarchive/dist/tar/bsdtar.c	patch
external/bsd/libarchive/dist/tar/bsdtar.h	patch
external/bsd/libarchive/dist/tar/bsdtar_platform.h patch
external/bsd/libarchive/dist/tar/getdate.y	patch
external/bsd/libarchive/dist/tar/matching.c	patch
external/bsd/libarchive/dist/tar/read.c		patch
external/bsd/libarchive/dist/tar/siginfo.c	patch
external/bsd/libarchive/dist/tar/subst.c	patch
external/bsd/libarchive/dist/tar/tree.c		patch
external/bsd/libarchive/dist/tar/tree.h		patch
external/bsd/libarchive/dist/tar/util.cx	patch
external/bsd/libarchive/dist/tar/write.c	patch
external/bsd/libarchive/dist/tar/test/main.c	patch
external/bsd/libarchive/dist/tar/test/test.h	patch
external/bsd/libarchive/dist/tar/test/test_0.c	patch
external/bsd/libarchive/dist/tar/test/test_basic.c patch
external/bsd/libarchive/dist/tar/test/test_copy.c patch
external/bsd/libarchive/dist/tar/test/test_getdate.c patch
external/bsd/libarchive/dist/tar/test/test_help.c patch
external/bsd/libarchive/dist/tar/test/test_option_T.c patch
external/bsd/libarchive/dist/tar/test/test_patterns.c patch
external/bsd/libarchive/dist/tar/test/test_stdio.c patch
external/bsd/libarchive/dist/tar/test/test_version.c patch
external/bsd/libarchive/include/config_netbsd.h	patch
external/bsd/libarchive/lib/Makefile		patch
external/bsd/libarchive/lib/shlib_version	patch
external/bsd/pkg_install/Makefile		patch
external/bsd/pkg_install/Makefile.inc		patch
external/bsd/pkg_install/prepare-import.sh	patch
external/bsd/pkg_install/dist/add/add.h		patch
external/bsd/pkg_install/dist/add/main.c	patch
external/bsd/pkg_install/dist/add/perform.c	patch
external/bsd/pkg_install/dist/add/pkg_add.1	patch
external/bsd/pkg_install/dist/admin/README	patch
external/bsd/pkg_install/dist/admin/admin.h	patch
external/bsd/pkg_install/dist/admin/audit-packages.sh.in patch
external/bsd/pkg_install/dist/admin/audit.c	patch
external/bsd/pkg_install/dist/admin/check.c	patch
external/bsd/pkg_install/dist/admin/download-vulnerability-list.sh.in patch
external/bsd/pkg_install/dist/admin/main.c	patch
external/bsd/pkg_install/dist/admin/pkg_admin.1	patch
external/bsd/pkg_install/dist/bpm/bpm.1		patch
external/bsd/pkg_install/dist/bpm/bpm.sh.in	patch
external/bsd/pkg_install/dist/create/build.c	patch
external/bsd/pkg_install/dist/create/create.h	patch
external/bsd/pkg_install/dist/create/main.c	patch
external/bsd/pkg_install/dist/create/perform.c	patch
external/bsd/pkg_install/dist/create/pkg_create.1 patch
external/bsd/pkg_install/dist/create/pl.c	patch
external/bsd/pkg_install/dist/create/util.c	patch
external/bsd/pkg_install/dist/delete/pkg_delete.1 patch
external/bsd/pkg_install/dist/delete/pkg_delete.c patch
external/bsd/pkg_install/dist/info/info.h	patch
external/bsd/pkg_install/dist/info/main.c	patch
external/bsd/pkg_install/dist/info/perform.c	patch
external/bsd/pkg_install/dist/info/pkg_info.1	patch
external/bsd/pkg_install/dist/info/show.c	patch
external/bsd/pkg_install/dist/lib/automatic.c	patch
external/bsd/pkg_install/dist/lib/config.h.in	patch
external/bsd/pkg_install/dist/lib/conflicts.c	patch
external/bsd/pkg_install/dist/lib/decompress.c	patch
external/bsd/pkg_install/dist/lib/defs.h	patch
external/bsd/pkg_install/dist/lib/dewey.c	patch
external/bsd/pkg_install/dist/lib/dewey.hx	patch
external/bsd/pkg_install/dist/lib/fexec.c	patch
external/bsd/pkg_install/dist/lib/file.c	patch
external/bsd/pkg_install/dist/lib/global.c	patch
external/bsd/pkg_install/dist/lib/gpgsig.c	patch
external/bsd/pkg_install/dist/lib/iterate.c	patch
external/bsd/pkg_install/dist/lib/lib.h		patch
external/bsd/pkg_install/dist/lib/license.c	patch
external/bsd/pkg_install/dist/lib/lpkg.c	patch
external/bsd/pkg_install/dist/lib/opattern.c	patch
external/bsd/pkg_install/dist/lib/parse-config.c patch
external/bsd/pkg_install/dist/lib/pkcs7.c	patch
external/bsd/pkg_install/dist/lib/pkg_install.conf.5.in patch
external/bsd/pkg_install/dist/lib/pkg_io.c	patch
external/bsd/pkg_install/dist/lib/pkg_signature.c patch
external/bsd/pkg_install/dist/lib/pkg_summary.5	patch
external/bsd/pkg_install/dist/lib/pkgdb.c	patch
external/bsd/pkg_install/dist/lib/pkgsrc.7	patch
external/bsd/pkg_install/dist/lib/plist.c	patch
external/bsd/pkg_install/dist/lib/remove.c	patch
external/bsd/pkg_install/dist/lib/str.c		patch
external/bsd/pkg_install/dist/lib/var.c		patch
external/bsd/pkg_install/dist/lib/version.c	patch
external/bsd/pkg_install/dist/lib/version.h	patch
external/bsd/pkg_install/dist/lib/vulnerabilities-file.c patch
external/bsd/pkg_install/dist/lib/xwrapper.c	patch
external/bsd/pkg_install/dist/x509/pkgsrc.cnf	patch
external/bsd/pkg_install/dist/x509/pkgsrc.sh	patch
external/bsd/pkg_install/dist/x509/signing.txt patch
external/bsd/pkg_install/lib/Makefile		patch
external/bsd/pkg_install/lib/config.h		patch
external/bsd/pkg_install/lib/nbcompat.h		patch
external/bsd/pkg_install/sbin/Makefile		patch
external/bsd/pkg_install/sbin/Makefile.inc	patch
external/bsd/pkg_install/sbin/bpm/Makefile	patch
external/bsd/pkg_install/sbin/pkg_add/Makefile	patch
external/bsd/pkg_install/sbin/pkg_admin/Makefile patch
external/bsd/pkg_install/sbin/pkg_create/Makefile patch
external/bsd/pkg_install/sbin/pkg_delete/Makefile patch
external/bsd/pkg_install/sbin/pkg_info/Makefile	patch
external/lib/Makefile				patch
usr.sbin/Makefile				patch

	Pull up pkg_install-20090528, libarchive-2.5.5 and libfetch-2.23
	with the associated build infrastructure as of 20090529 from HEAD. 
	[joerg, ticket #1322]

sys/arch/sh3/sh3/locore_subr.S			1.52

	Fix logic error in copyinstr() when deciding whether to return EFAULT
	or ENAMETOOLONG.
	[uwe, ticket #1323]

lib/libpam/modules/pam_unix/pam_unix.c		1.13
	Restore the good old UNIX behavior of root password changing: only root
	may change the root password.

	(Checked that everybody else's password can be changed without any
	problem, and checked that root can still change the root password.)
	[tonnerre, ticket #1326]

sys/compat/linux/common/linux_sched.c		1.59

	In linux_sys_sched_getaffinity(), do not leak memory on error.
	[njoly, ticket #1328]

external/bsd/pkg_install/dist/admin/pkg_admin.1	1.1.1.7
external/bsd/pkg_install/dist/lib/license.c	1.1.1.3
external/bsd/pkg_install/dist/lib/version.h	1.1.1.16

	Merge pkg_install-20090610 from HEAD
	[joerg, ticket #1325]

dist/tcpdump/print-bgp.c			patch
dist/tcpdump/print-isoclns.c			patch
dist/tcpdump/print-ldp.c			patch
dist/tcpdump/print-rsvp.c			patch

	Fix CAN-2005-1278, CAN-2005-1279 and CAN-2005-1280.
	[tonnerre, ticket #1329]

games/hunt/huntd/answer.c			1.10

	Fix possible remote DoS of a running hunt game, and prevent
	a possible theoretical attack involving >= 1 billion ammo.
	[dholland, ticket #1330]

games/hack/extern.h				1.11
games/hack/hack.do_name.c			1.9, 1.10
games/hack/hack.eat.c				1.8
games/hack/hack.end.c				1.12 via patch
games/hack/hack.fight.c				1.10 via patch
games/hack/hack.h				1.13 via patch
games/hack/hack.invent.c			1.12, 1.13
games/hack/hack.main.c				1.12, 1.13
games/hack/hack.objnam.c			1.9
games/hack/hack.options.c			1.9
games/hack/hack.pri.c				1.11
games/hack/hack.rip.c				1.10, 1.11
games/hack/hack.shk.c				1.10
games/hack/hack.topl.c				1.10, 1.11
games/hack/hack.unix.c				1.12, 1.13

	sprintf -> snprintf, plus some use of strlcpy/strlcat where
	appropriate.
	Fix two serious string-handling bugs (one exploitable, one
	probably exploitable) and also add proper checking/paranoia
	in several other places.
	[dholland, ticket #1331]

crypto/dist/ssh/cipher.c			1.22 via patch
crypto/dist/ssh/cipher.h			1.3 via patch
crypto/dist/ssh/packet.c			1.32 via patch

	Add special handling for CBC cipher modes to make them appear
	less favorable than CTR modes. Also, in order to avoid creating
	oracles unnecessarily, change behavior in various situations
	from "Drop connection" to "Ignore packets up to 256kB". This
	affects CBC mode ciphers only.
	[tonnerre, ticket #1332]

crypto/dist/openssl/apps/speed.c 		patch	
crypto/dist/openssl/apps/spkac.c 		patch
crypto/dist/openssl/apps/verify.c 		patch
crypto/dist/openssl/apps/x509.c 		patch
crypto/dist/openssl/crypto/asn1/asn1.h 		patch
crypto/dist/openssl/crypto/asn1/asn1_err.c 	patch
crypto/dist/openssl/crypto/asn1/tasn_dec.c 	patch
crypto/dist/openssl/ssl/s2_clnt.c 		patch
crypto/dist/openssl/ssl/s2_srvr.c 		patch
crypto/dist/openssl/ssl/s3_clnt.c 		patch
crypto/dist/openssl/ssl/s3_srvr.c 		patch
crypto/dist/openssl/ssl/ssltest.c 		patch

	Fixes for CVE-2009-0590, CVE-2009-0789, and CVE-2008-5077.
	[tonnerre, ticket #1333]

crypto/dist/openssl/crypto/pqueue/pqueue.c	patch
crypto/dist/openssl/crypto/pqueue/pqueue.h	patch
crypto/dist/openssl/ssl/d1_both.c		patch
crypto/dist/openssl/ssl/d1_pkt.c		patch
crypto/dist/openssl/ssl/s3_pkt.c		patch
crypto/dist/openssl/ssl/ssl.h			patch
crypto/dist/openssl/ssl/ssl_err.c		patch

	Another OpenSSL security update.
	[tonnerre, ticket #1334]

crypto/dist/openssl/ssl/d1_both.c		patch

	Fix build problem introduced with ticket 1334.
	[spz, ticket #851]

dist/dhcp/client/dhclient.c			1.20

	Limit the length of the address mask before we copy it.
	Fixes CVE-2009-0692.
	[tonnerre, ticket #1336]

dist/dhcp/server/dhcp.c				1.11

	Fix behavior of dhcpd in the case where clientid and hardware
	ethernet definitions are mixed. Fixes a refcount assertion.
	[tonnerre, ticket #1337]

common/lib/libc/hash/sha2/sha2.c		patch
crypto/dist/openssl/crypto/evp/m_sha1.c		patch
distrib/sets/lists/base/shl.mi			patch
distrib/sets/lists/comp/mi			patch
lib/libc/shlib_version				patch
lib/libc/hash/sha2/Makefile.inc			patch
lib/libc/hash/sha2/sha2.3			patch
lib/libc/hash/sha2/sha224hl.c			patch
lib/libc/include/namespace.h			patch
lib/libcrypto/libc-sha256.c			patch
lib/libcrypto/libc-sha512.c			patch
lib/libcrypto/sha.inc				patch
lib/libcrypto/shlib_version			patch
sys/sys/sha2.h					patch

	- Add support for SHA224 to libc
	- Fix Big Endian support in some cases
	- Use libc support in libcrypto
	[joerg, ticket #1338]

dist/bind/bin/named/update.c			patch

	Fix CVE-2009-0696.
	[christos, ticket #1347]

lib/libc/sys/intro.2				1.53, 1.54

	Mention, along with the behavior of succeeding system calls, the
	normal behavior of succeeding library functions regarding errno.
	(That is, they may leave arbitrary nonzero values in errno.)
	Ok kleink@; related to PR lib/41567 as well as a recent thread on
	tech-userlevel.
	[dholland, ticket #1340]

lib/libc/stdlib/strtol.3			1.25, 1.26 via patch
lib/libc/stdlib/strtoul.3			1.22, 1.23 via patch

	Clarify the description of the errno behavior, based on the recent
	thread in tech-userlevel.
	[dholland, ticket #1341]

lib/libc/sys/intro.2				1.50 via patch

	PR/40060 - Bug Hunting -- grammar fix
	[dholland, ticket #1344]

sbin/wsconsctl/wsconsctl.8			1.26

	PR/40059 - Bug Hunting -- add Xref to wscons.conf(5)
	[dholland, ticket #1345]

lib/libc/sys/semctl.2				1.18
lib/libc/sys/shmctl.2				1.20

	Fix pastos. From Jukka Salmi in PR 41605, with a very minor adjustment.
	[dholland, ticket #1351]

usr.bin/xlint/lint1/init.c			1.22

	pushinit(): fix a use-after-free bug.
	[msaitoh, ticket #1353]

sbin/dkctl/dkctl.8				1.19, 1.20
sbin/dkctl/dkctl.c				1.18

	list the partition types addwedge understands, so you don't need to
	utsl to find out what strings to use here
	fixes PR 37252
	make dkctl conform to its man page and print the device name on
	addwedge when the addition was successful (as well as indicating
	success).
	[spz, ticket #1350]

bin/pax/options.c				1.105 via patch
usr.bin/ctags/C.c				1.19
usr.bin/ctags/ctags.h				1.9
usr.bin/ctags/fortran.c				1.11
usr.bin/ctags/lisp.c				1.11
usr.bin/ctags/print.c				1.10
usr.bin/ctags/yacc.c				1.12
usr.bin/gencat/gencat.c				1.30 via patch

	Rename internal getline() function to get_line() so it does
	not conflict with -current's getline(3) libc function.
	[plunky, ticket #1354]

