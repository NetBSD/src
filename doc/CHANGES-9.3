29~# $NetBSD: CHANGES-9.3,v 1.1.2.75 2022/02/08 14:45:57 martin Exp $

A complete list of changes from the NetBSD 9.2 release to the NetBSD 9.3
release:

external/gpl2/groff/tmac/mdoc.local		patched by hand
sys/sys/param.h 				patched by hand
doc/CHANGES-9.3					added

	Welcome to 9.2_STABLE.
	[martin]

sys/fs/ntfs/ntfs_subr.c				1.64

	PR 56160: fix a kernel crash for some NTFS file systems.
	[hannken, ticket #1272]

sys/dev/pci/xhci_pci.c				1.26

	PR 55855: avoid potential double free of interrupt handles.
	[jakllsch, ticket #1273]

external/cddl/osnet/dist/cmd/zfs/zfs_main.c	1.8
external/cddl/osnet/dist/lib/libzfs/common/libzfs_dataset.c 1.5

	zfs: this is not FreeBSD.
	[nia, ticket #1274]

xsrc/external/mit/libX11/dist/src/Font.c		(apply patch)
xsrc/external/mit/libX11/dist/src/FontInfo.c		(apply patch)
xsrc/external/mit/libX11/dist/src/FontNames.c		(apply patch)
xsrc/external/mit/libX11/dist/src/GetColor.c		(apply patch)
xsrc/external/mit/libX11/dist/src/LoadFont.c		(apply patch)
xsrc/external/mit/libX11/dist/src/LookupCol.c		(apply patch)
xsrc/external/mit/libX11/dist/src/ParseCol.c		(apply patch)
xsrc/external/mit/libX11/dist/src/QuExt.c		(apply patch)
xsrc/external/mit/libX11/dist/src/SetFPath.c		(apply patch)
xsrc/external/mit/libX11/dist/src/SetHints.c		(apply patch)
xsrc/external/mit/libX11/dist/src/StNColor.c		(apply patch)
xsrc/external/mit/libX11/dist/src/StName.c		(apply patch)
xsrc/external/mit/libX11/dist/src/xlibi18n/imKStoUCS.c	(apply patch)

	Apply upstream fixes for CVE-2021-31535 (and one other bug).
	Reject string longer than USHRT_MAX before sending them on the wire.
	Fix out-of-bound access in KeySymToUcs4().
	[mrg, ticket #1275]

external/mit/xorg/server/drivers/xf86-input-keyboard/Makefile 1.17

	Make wskbd(4) default for mac68k; no other protocol is available.
	[rin, ticket #1276]

sys/arch/aarch64/aarch64/netbsd32_machdep.c	1.18

	Fix conversion between aarch64 and aarch32 fpregs to fix crashes
	in VFP-optimized codes running on COMPAT_NETBSD32.
	[rin, ticket #1277]

sys/arch/aarch64/aarch64/aarch64_machdep.c	1.50,1.60,1.61

	Minor fix for aarch64 memory detection.
	[skrll, ticket #1278]

sys/arch/arm/arm32/arm32_boot.c			1.42,1.43

	Minor fix for ARM memory detection.
	[skrll, ticket #1279]

sys/arch/hp300/conf/INSTALL			1.67,1.68

	Add missing 'nhpib at intio' for internal HP-IB.
	Reduce maxusers to 8 (same as GENERIC).
	[tsutsui, ticket #1280]

distrib/miniroot/install.sub			1.60

	Handle recent ifconfig(8) output in the miniroot installation script.
	[tsutsui, ticket #1281]

sys/dev/pci/if_iwmreg.h				1.8

	iwm(4): fix various bit declarations - use unsigned for 2^32.
	[nia, ticket #1282]

sbin/dump/tape.c				1.56

	dump(8): prevent crashes for large file systems.
	[hannken, ticket #1283]

external/bsd/libpcap/bin/Makefile		1.3

	Fix pcap-config output.
	[dholland, ticket #1284]

usr.bin/ftp/ftp.c				1.170
usr.bin/ftp/version.h				1.90

	ftp(1): improve signal handler restoration.
	[lukem, ticket #1290]

usr.bin/ftp/ftp.c				1.169
usr.bin/ftp/util.c				1.161

	ftp(1): exit if lostpeer() is invoked by a signal.
	[lukem, ticket #1291]

usr.bin/ftp/fetch.c				1.232

	ftp(1): improve signal handler restoration.
	[lukem, ticket #1292]

usr.bin/ftp/ftp.c				1.172

	ftp(1): PR 56129: attempt to prevent timeouts of the control
	connection.
	[lukem, ticket #1293]

usr.bin/ftp/cmds.c				1.141
usr.bin/ftp/ftp.1				1.143

	ftp(1): fix description of "debug".
	[lukem, ticket #1294]

usr.bin/ftp/Makefile				1.39
usr.bin/ftp/ssl.c				1.10
usr.bin/ftp/ssl.h				1.5
usr.bin/ftp/version.h				1.93

	ftp(1): PR 56219: in crunched builds (e.g. some install media)
	use fetch_* functions for I/O.
	Set version to 20210603.
	[lukem, ticket #1295]

sys/kern/vfs_lookup.c				1.226
sys/kern/vfs_vnops.c				1.215
sys/sys/namei.src				1.59 (patch)
sys/rump/include/rump/rump_namei.h		(regen)
sys/sys/namei.h					(regen)

	Add a new namei flag NONEXCLHACK for open with O_CREAT and not O_EXCL.
	In the case where that target is the root, or a mount
	point, such that there's no parent dir, "real" CREATE operations fail,
	but O_CREAT without O_EXCL needs to succeed.
	Fixes newer Samba usage of /proc/self/fd/NNN with O_CREAT.
	[dholland, ticket #1296]

external/bsd/libarchive/dist/cat/test/test_0.c			up to 1.2
external/bsd/libarchive/dist/cpio/test/test_basic.c		up to 1.2
external/bsd/libarchive/dist/cpio/test/test_format_newc.c	up to 1.3
external/bsd/libarchive/dist/libarchive/archive_read.c		up to 1.2
external/bsd/libarchive/dist/libarchive/archive_read_disk_posix.c	up to 1.2
external/bsd/libarchive/dist/libarchive/archive_read_open_filename.c	up to 1.2
external/bsd/libarchive/dist/libarchive/archive_read_support_format_xar.c	up to 1.2
external/bsd/libarchive/dist/libarchive/archive_write_disk_posix.c	up to 1.6
external/bsd/libarchive/dist/libarchive/test/test_acl_platform_nfs4.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_acl_platform_posix1e.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_compat_zip.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_fuzz.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_read_extract.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_read_format_gtar_sparse.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_read_format_zip.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_read_format_zip_7075_utf8_paths.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_read_format_zip_comment_stored.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_read_format_zip_extra_padding.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_read_format_zip_high_compression.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_read_format_zip_jar.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_read_format_zip_mac_metadata.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_read_format_zip_malformed.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_read_format_zip_msdos.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_read_format_zip_nested.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_read_format_zip_nofiletype.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_read_format_zip_padded.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_read_format_zip_sfx.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_read_format_zip_with_invalid_traditional_eocd.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_read_format_zip_zip64.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_read_pax_truncated.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_read_truncated_filter.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_sparse_basic.c	up to 1.3
external/bsd/libarchive/dist/libarchive/test/test_write_disk.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_write_disk_secure.c	up to 1.4
external/bsd/libarchive/dist/libarchive/test/test_write_format_cpio_empty.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_write_format_shar_empty.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_write_format_tar.c	up to 1.2
external/bsd/libarchive/dist/libarchive/test/test_write_format_tar_sparse.c	up to 1.2
external/bsd/libarchive/dist/tar/write.c			up to 1.3
external/bsd/libarchive/dist/tar/test/test_basic.c		up to 1.2
external/bsd/libarchive/dist/tar/test/test_copy.c		up to 1.3
external/bsd/libarchive/dist/tar/test/test_option_C_upper.c	up to 1.2
external/bsd/libarchive/dist/tar/test/test_option_s.c		up to 1.2
external/bsd/libarchive/dist/test_utils/test_common.h		up to 1.2
external/bsd/libarchive/dist/test_utils/test_main.c		up to 1.2

	PR 56257: sync libarchive with -current, leaving out extended
	attributes and changes for newer gcc not relevant for this
	branch.
	[christos, ticket #1297]

lib/libc/gen/setjmp.3				1.18

	Clarify what happens when you longjmp(..., 0).
	[riastradh, ticket #1298]

sys/kern/kern_ksyms.c				1.90-1.97

	ksyms(4): Fix races and allow multiple concurrent opens.
	[riastradh, ticket #1299]

sys/external/bsd/drm2/dist/drm/i915/i915_drv.h	1.33 (patch)

	i915drmkms: Fix LOCKDEBUG panic and potential deadlock.
	[riastradh, ticket #1300]

sys/dev/usb/xhci.c				1.139-1.141,1.143 (patch)
sys/dev/usb/xhcireg.h				1.19 (patch)
sys/dev/usb/xhcivar.h				1.18,1.19 (patch)

	xhci(4): support suspend/resume.
	[riastradh, ticket #1301]

sys/dev/usb/ualea.c				1.13

	ualea(4): suport suspend/resume.
	[riastradh, ticket #1302]

sys/arch/x86/pci/dwiic_pci.c			1.5 (patch)

	dwiic(4): Attribute output correctly and relegate to debug-level.
	[riastradh, ticket #1303]

sys/dev/ld.c					1.112
sys/dev/ldvar.h					1.35

	ld(4): fix suspend/resume.
	[riastradh, ticket #1304]

sys/dev/ic/nvme.c				1.56,1.57
sys/dev/ic/nvmevar.h				1.22
sys/dev/pci/nvme_pci.c				1.30

	nvme(4): add suspend/resume.
	[riastradh, ticket #1305]

sys/dev/usb/umass.c				1.185
sys/dev/usb/umass_scsipi.c			1.68

	umass(4): fix suspend/resume.
	[riastradh, ticket #1306]

sys/arch/amd64/amd64/db_disasm.c		1.28
sys/arch/i386/i386/db_disasm.c			1.49

	ddb(4) on amd64 and i386: don't go out of the way to detect
	invalid addresses. Fixes a double fault in ddb when a NULL function
	pointer is called.
	[riastradh, ticket #1307]

sys/arch/amd64/conf/GENERIC			1.581

	Enable tpm at acpi.
	[riastradh, ticket #1308]

compat/arm/oabi/bsd.oabi.mk		(apply patch)

	Fix PR 50192.
	[mrg, ticket #1309]

distrib/miniroot/install.sub			1.61,1.62
distrib/sun2/miniroot/Makefile			1.40
distrib/sun3/miniroot/Makefile			1.50

	Fixes to sun2 and sun3 miniroot upgrade scripts:
	- Replace RELEASE and VERSION strings proplery.
	- Remove netstat(1) calls to print resolver info on upgrade using
	  miniroot, the binary is not available.
	- The modules and rescue sets are also required on upgrade.
	[tsutsui, ticket #1310]

sys/dev/ic/ax88190.c				1.18
sys/dev/ic/dl10019.c				1.17
sys/dev/ic/dp8390.c				1.99

	Make sure the media / mii members in struct ethercom are initialized
	so that the media-related ioctls work.
	[thorpej, ticket #1311]

sys/miscfs/kernfs/kernfs_vnops.c		1.169,1.170

	Add missing VOP_KQFILTER to kernfs.
	Fix permissons on /kern/{r,}rootdev.
	[dholland, ticket #1318]

sys/arch/hppa/hppa/intr.c			1.4

	Fix off by one which resulted in all idle time reported as interrupt
	time.
	[macallan, ticket #1312]

common/lib/libc/arch/arm/atomic/atomic_add_64.S	1.12
common/lib/libc/arch/arm/atomic/atomic_and_64.S	1.11
common/lib/libc/arch/arm/atomic/atomic_cas_8.S	1.8
common/lib/libc/arch/arm/atomic/atomic_nand_64.S 1.5
common/lib/libc/arch/arm/atomic/atomic_or_64.S	1.12
common/lib/libc/arch/arm/atomic/atomic_sub_64.S	1.3
common/lib/libc/arch/arm/atomic/atomic_swap_64.S 1.13
common/lib/libc/arch/arm/atomic/atomic_xor_64.S	1.5

	Whitespace fixes to help later pullups.
	[skrll, ticket #1313]

common/lib/libc/arch/aarch64/atomic/atomic_nand_16.S 1.3
common/lib/libc/arch/aarch64/atomic/atomic_nand_32.S 1.3
common/lib/libc/arch/aarch64/atomic/atomic_nand_32.S 1.4
common/lib/libc/arch/aarch64/atomic/atomic_nand_64.S 1.3
common/lib/libc/arch/aarch64/atomic/atomic_nand_64.S 1.4
common/lib/libc/arch/aarch64/atomic/atomic_nand_8.S 1.3
common/lib/libc/arch/aarch64/atomic/atomic_nand_8.S 1.4

	Fix the logic operation for atomic_nand_{8,16,32,64}.
	[skrll, ticket #1314]

external/cddl/osnet/sys/kern/printf.c		1.3

	Use vpanic, not vprintf and then panic.
	[riastradh, ticket #1315]

external/cddl/osnet/dist/uts/common/dtrace/dtrace.c 1.41

	Remove a pointless printf.
	[riastradh, ticket #1316]

external/cddl/osnet/dist/uts/common/fs/zfs/zfs_vnops.c 1.71 (patch)
sys/rump/librump/rumpkern/vm.c			1.191 (patch)
sys/rump/librump/rumpvfs/vm_vfs.c		1.39-1.41 (patch)
sys/uvm/uvm_anon.c				1.80 (patch)
sys/uvm/uvm_page.c				1.248 (patch)
sys/uvm/uvm_pager.c				1.130 (patch)
tests/rump/rumpkern/t_vm.c			1.5,1.6 (patch)

	PR 55702, PR 55945: fix uvm pageout crashes.
	[riastradh, ticket #1317]

common/lib/libc/arch/aarch64/atomic/atomic_nand_16.S 1.4

	Cosmetics (to help later additional pullups)
	[skrll, ticket #1319]

sys/external/bsd/drm2/linux/linux_reservation.c	1.12

	drm: Release fence after use.
	[riastradh, ticket #1320]

sys/rump/librump/rumpvfs/vm_vfs.c		(apply patch)

	Adapt the uvm pageout changes to the branch.
	[chs, ticket #1321]

sys/arch/hppa/dev/sti_sgc.c			1.3

	PR 52162: Fix silent freeze on probing sti(4) framebuffer on 712/60.
	[tsutsui, ticket #1322]

etc/etc.hp300/MAKEDEV.conf			1.15
sys/arch/hp300/dev/ct.c				1.62,1.63
sys/arch/hp300/dev/ctreg.h			1.11
sys/arch/hp300/dev/hpib.c			1.43 (patch)
sys/arch/hp300/dev/hpibvar.h			1.22-1.24
sys/arch/hp300/dev/mt.c				1.55
sys/arch/hp300/dev/rd.c				1.103-1.109
sys/arch/hp300/dev/rdreg.h			1.14-1.17
sys/arch/hp300/dev/rdvar.h			1.24-1.26
sys/arch/hp300/stand/Makefile.buildboot		1.37
sys/arch/hp300/stand/common/ct.c		1.8
sys/arch/hp300/stand/common/hpibvar.h		1.6
sys/arch/hp300/stand/common/rd.c		1.11

	hp300: various rd(4) improvements.
	[tsutsui, ticket #1323]

sys/arch/arm/rockchip/rk_anxdp.c		1.4

	Fix display init on Pinebook Pro w/ U-Boot 2021.07.
	[jmcneill, ticket #1324]

sys/dev/audio/audio.c				1.105

	AUDIO_SETINFO: fix a bug that the gain and the balance could
	not be set at the same time.  PR kern/56308.
	[isaki, ticket #1325]

distrib/sets/lists/man/mi			1.1724
share/man/man4/man4.x86/Makefile		1.23 via patch
share/man/man4/man4.x86/amdccp.4		1.1

	Add a man page for amdccp(4)
	[nia, ticket #1326]

sys/external/bsd/drm2/linux/linux_reservation.c	1.13,1.14

	drm: fix more drm memory leaks.
	[riastradh, ticket #1327]

lib/libc/compiler_rt/Makefile.inc		1.40
lib/libm/compiler_rt/Makefile.inc		1.11
sys/external/bsd/compiler_rt/abi.mk		1.1
sys/external/bsd/compiler_rt/dist/lib/builtins/adddf3.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/addsf3.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/arm/aeabi_cdcmpeq_check_nan.c 1.2
sys/external/bsd/compiler_rt/dist/lib/builtins/arm/aeabi_cfcmpeq_check_nan.c 1.2
sys/external/bsd/compiler_rt/dist/lib/builtins/arm/aeabi_div0.c 1.2
sys/external/bsd/compiler_rt/dist/lib/builtins/arm/aeabi_drsub.c 1.2
sys/external/bsd/compiler_rt/dist/lib/builtins/arm/aeabi_frsub.c 1.2
sys/external/bsd/compiler_rt/dist/lib/builtins/ashldi3.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/ashrdi3.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/comparedf2.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/comparesf2.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/divdf3.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/divsf3.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/divsi3.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/extendhfsf2.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/extendsfdf2.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/fixdfdi.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/fixdfsi.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/fixsfdi.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/fixsfsi.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/fixunsdfdi.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/fixunsdfsi.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/fixunssfdi.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/fixunssfsi.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/floatdidf.c 1.3-1.5
sys/external/bsd/compiler_rt/dist/lib/builtins/floatdisf.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/floatsidf.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/floatsisf.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/floatundidf.c 1.3,1.4
sys/external/bsd/compiler_rt/dist/lib/builtins/floatundisf.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/floatunsidf.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/floatunsisf.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/int_lib.h 1.2-1.6
sys/external/bsd/compiler_rt/dist/lib/builtins/lshrdi3.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/muldf3.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/muldi3.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/mulsf3.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/negdf2.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/negsf2.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/subdf3.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/subsf3.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/truncdfhf2.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/truncdfsf2.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/truncsfhf2.c 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/udivsi3.c 1.2,1.3
sys/lib/libkern/Makefile.compiler-rt		1.13

	arm: PR 55897: fix various complex arithmetics issues by cherry
	picking the relevant upstream changes.
	[skrll, ticket #1328]

lib/libc/arch/arm/gen/swapcontext.S		1.16-1.18
lib/libc/arch/arm/sys/__clone.S			1.10-1.14
sys/external/bsd/compiler_rt/dist/lib/builtins/arm/aeabi_cfcmp.S 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/arm/divmodsi4.S 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/arm/divsi3.S 1.2,1.3
sys/external/bsd/compiler_rt/dist/lib/builtins/arm/modsi3.S 1.2,1.3

	arm: align stack pointer to 8-byte boundary as required by EABI.
	[skrll, ticket #1329]

common/lib/libc/arch/arm/atomic/atomic_add_16.S	1.4,1.5
common/lib/libc/arch/arm/atomic/atomic_add_32.S	1.9,1.10
common/lib/libc/arch/arm/atomic/atomic_add_64.S	1.13,1.14
common/lib/libc/arch/arm/atomic/atomic_add_8.S	1.4,1.5
common/lib/libc/arch/arm/atomic/atomic_and_16.S	1.4,1.5
common/lib/libc/arch/arm/atomic/atomic_and_32.S	1.9,1.10
common/lib/libc/arch/arm/atomic/atomic_and_64.S	1.12,1.13
common/lib/libc/arch/arm/atomic/atomic_and_8.S	1.4,1.5
common/lib/libc/arch/arm/atomic/atomic_cas_16.S	1.3
common/lib/libc/arch/arm/atomic/atomic_cas_32.S	1.8
common/lib/libc/arch/arm/atomic/atomic_cas_64.S	1.12
common/lib/libc/arch/arm/atomic/atomic_cas_8.S	1.9
common/lib/libc/arch/arm/atomic/atomic_cas_up.S	1.8
common/lib/libc/arch/arm/atomic/atomic_dec_32.S	1.6
common/lib/libc/arch/arm/atomic/atomic_dec_32.S	1.7
common/lib/libc/arch/arm/atomic/atomic_dec_64.S	1.8,1.9
common/lib/libc/arch/arm/atomic/atomic_inc_32.S	1.8,1.9
common/lib/libc/arch/arm/atomic/atomic_inc_64.S	1.10,1.11
common/lib/libc/arch/arm/atomic/atomic_nand_16.S 1.4,1.5
common/lib/libc/arch/arm/atomic/atomic_nand_32.S 1.4,1.5
common/lib/libc/arch/arm/atomic/atomic_nand_64.S 1.6,1.7
common/lib/libc/arch/arm/atomic/atomic_nand_8.S	1.4,1.5
common/lib/libc/arch/arm/atomic/atomic_op_asm.h	1.9,1.10
common/lib/libc/arch/arm/atomic/atomic_or_16.S	1.4,1.5
common/lib/libc/arch/arm/atomic/atomic_or_32.S	1.9,1.10
common/lib/libc/arch/arm/atomic/atomic_or_64.S	1.13,1.14
common/lib/libc/arch/arm/atomic/atomic_or_8.S	1.4,1.5
common/lib/libc/arch/arm/atomic/atomic_sub_64.S	1.4,1.5
common/lib/libc/arch/arm/atomic/atomic_swap.S	1.18,1.19
common/lib/libc/arch/arm/atomic/atomic_swap_16.S 1.6,1.7
common/lib/libc/arch/arm/atomic/atomic_swap_64.S 1.14
common/lib/libc/arch/arm/atomic/atomic_xor_16.S	1.4,1.5
common/lib/libc/arch/arm/atomic/atomic_xor_32.S	1.4,1.5
common/lib/libc/arch/arm/atomic/atomic_xor_64.S	1.6,1.7
common/lib/libc/arch/arm/atomic/atomic_xor_8.S	1.4,1.5
common/lib/libc/arch/arm/atomic/membar_ops.S	1.8,1.9
common/lib/libc/arch/arm/atomic/sync_bool_compare_and_swap_1.S 1.4
common/lib/libc/arch/arm/atomic/sync_bool_compare_and_swap_2.S 1.4
common/lib/libc/arch/arm/atomic/sync_bool_compare_and_swap_4.S 1.4
common/lib/libc/arch/arm/atomic/sync_bool_compare_and_swap_8.S 1.5
common/lib/libc/arch/arm/atomic/sync_fetch_and_add_8.S 1.6
common/lib/libc/arch/arm/atomic/sync_fetch_and_and_8.S 1.6
common/lib/libc/arch/arm/atomic/sync_fetch_and_nand_8.S 1.6
common/lib/libc/arch/arm/atomic/sync_fetch_and_or_8.S 1.6
common/lib/libc/arch/arm/atomic/sync_fetch_and_sub_8.S 1.6
common/lib/libc/arch/arm/atomic/sync_fetch_and_xor_8.S 1.6

	arm: various fixes for atomic ops.
	[skrll, ticket #1330]

common/lib/libc/arch/aarch64/atomic/atomic_add_16.S 1.2
common/lib/libc/arch/aarch64/atomic/atomic_add_32.S 1.2
common/lib/libc/arch/aarch64/atomic/atomic_add_64.S 1.2
common/lib/libc/arch/aarch64/atomic/atomic_add_8.S 1.2
common/lib/libc/arch/aarch64/atomic/atomic_and_16.S 1.2
common/lib/libc/arch/aarch64/atomic/atomic_and_32.S 1.2
common/lib/libc/arch/aarch64/atomic/atomic_and_64.S 1.2
common/lib/libc/arch/aarch64/atomic/atomic_and_8.S 1.2
common/lib/libc/arch/aarch64/atomic/atomic_cas_16.S 1.2,1.4
common/lib/libc/arch/aarch64/atomic/atomic_cas_32.S 1.2,1.4
common/lib/libc/arch/aarch64/atomic/atomic_cas_64.S 1.4,1.6
common/lib/libc/arch/aarch64/atomic/atomic_cas_8.S 1.2,1.4
common/lib/libc/arch/aarch64/atomic/atomic_dec_32.S 1.2
common/lib/libc/arch/aarch64/atomic/atomic_dec_64.S 1.2
common/lib/libc/arch/aarch64/atomic/atomic_inc_32.S 1.2
common/lib/libc/arch/aarch64/atomic/atomic_inc_64.S 1.2
common/lib/libc/arch/aarch64/atomic/atomic_nand_16.S 1.2,1.5
common/lib/libc/arch/aarch64/atomic/atomic_nand_32.S 1.2,1.5
common/lib/libc/arch/aarch64/atomic/atomic_nand_64.S 1.2,1.5
common/lib/libc/arch/aarch64/atomic/atomic_nand_8.S 1.2,1.5
common/lib/libc/arch/aarch64/atomic/atomic_op_asm.h 1.5
common/lib/libc/arch/aarch64/atomic/atomic_op_asm.h 1.6
common/lib/libc/arch/aarch64/atomic/atomic_or_16.S 1.2
common/lib/libc/arch/aarch64/atomic/atomic_or_32.S 1.2
common/lib/libc/arch/aarch64/atomic/atomic_or_64.S 1.3
common/lib/libc/arch/aarch64/atomic/atomic_or_8.S 1.2
common/lib/libc/arch/aarch64/atomic/atomic_sub_16.S 1.2
common/lib/libc/arch/aarch64/atomic/atomic_sub_32.S 1.2
common/lib/libc/arch/aarch64/atomic/atomic_sub_64.S 1.2
common/lib/libc/arch/aarch64/atomic/atomic_sub_8.S 1.2
common/lib/libc/arch/aarch64/atomic/atomic_swap_16.S 1.2,1.5
common/lib/libc/arch/aarch64/atomic/atomic_swap_32.S 1.2,1.5
common/lib/libc/arch/aarch64/atomic/atomic_swap_64.S 1.2,1.5
common/lib/libc/arch/aarch64/atomic/atomic_swap_8.S 1.2,1.5
common/lib/libc/arch/aarch64/atomic/atomic_xor_16.S 1.2
common/lib/libc/arch/aarch64/atomic/atomic_xor_32.S 1.2
common/lib/libc/arch/aarch64/atomic/atomic_xor_64.S 1.2
common/lib/libc/arch/aarch64/atomic/atomic_xor_8.S 1.2
common/lib/libc/arch/aarch64/atomic/membar_ops.S 1.2

	aarch64: atomic ops improvements / fixes
	[skrll, ticket #1331]

sys/netinet6/in6_src.c				1.88

	PR 56348: MTU discovery fails with IPv6 sockets bound to IPv4
	mapped address.
	[kardel, ticket #1332]

distrib/notes/hp300/hardware			1.25,1.26

	Improve HP9000/360 and disk related information, mention
	working emulated disks.
	[tsutsui, ticket #1334]

distrib/sun2/miniroot/install.md		1.8,1.9
distrib/sun3/miniroot/install.md		1.8,1.9

	Don't try to add swap on miniroot.
	[tsutsui, ticket #1335]

crypto/external/bsd/openssl/lib/libcrypto/arch/mips/aes.inc 1.6
crypto/external/bsd/openssl/lib/libcrypto/arch/mips/bn.inc 1.7,1.8
crypto/external/bsd/openssl/lib/libcrypto/arch/mips/crypto.inc 1.8
crypto/external/bsd/openssl/lib/libcrypto/arch/mips/mips.inc 1.1,1.2
crypto/external/bsd/openssl/lib/libcrypto/arch/mips/poly1305.inc 1.5
crypto/external/bsd/openssl/lib/libcrypto/arch/mips/sha.inc 1.7
crypto/external/bsd/openssl/lib/libcrypto/arch/sparc/bn.inc 1.3

	PR 56318: fix openssl arch specific usage of optimized asm code
	for mips and sparc.
	[tsutsui, ticket #1336]

sys/compat/common/vfs_syscalls_30.c		1.42
sys/compat/common/vfs_syscalls_43.c		1.67
sys/compat/common/vfs_syscalls_50.c		1.26

	Fix compat stat(2) syscall kernel memory disclosure.
	[christos, ticket #1337]

usr.sbin/sysinst/defs.h				1.72
usr.sbin/sysinst/disks.c			1.75
usr.sbin/sysinst/upgrade.c			1.18

	PR 56354: make swap in sysinst optional for upgrades
	[martin, ticket #1333]

sys/netinet6/nd6.c				1.277

	nd6: avoid use-after-free in ND L2 cache.
	[ozaki-r, ticket #1338]

sys/dev/pci/if_vte.c				1.32

	vte(4): PR 53494: restore original MDC speed control register value
	after MAC reset.
	[andvar, ticket #1339]

sys/dev/usb/ehci.c				1.286

	PR 56366: add missing newline and fix conditional for askroot/single
	user hand over delay message.
	[mrg, ticket #1340]

sys/arch/x86/x86/pmap.c				1.410

	xen: Make pat_init() a NOOP on XENPV; it causes a trap with Xen 4.15.
	[manu, ticket #1341]

sys/arch/mips/mips/trap.c			1.250,1.251

	mips: fix and disable a debug message for TLB handling.
	[tsutsui, ticket #1342]

lib/libc/sys/fcntl.2				1.46 (patch)
lib/libc/sys/flock.2				1.23
share/man/man7/sysctl.7				1.153
sys/kern/vfs_lockf.c				1.74

	Tie the maximum file lock per unprivilegied uid to kern.maxfiles.
	[manu, ticket #1343]

distrib/sets/makesrctars			1.43

	PR 56389: do not include top level .git or .hg directories
	in source sets.
	[martin, ticket #1344]

build.sh					1.348-1.352, 1.356

	Support for MKREPRO and automatic timestamps when the source
	tree is from git or mercurial.
	[martin, ticket #1345]

sys/dev/pci/ixgbe/ixgbe.c			1.252, 1.280-1.283, 1.286-1.287, 1.289-1.290 via patch
sys/dev/pci/ixgbe/ixgbe.h			1.76-1.80 via patch
sys/dev/pci/ixgbe/ix_txrx.c			1.68-1.79, 1.80-1.93
sys/dev/pci/ixgbe/ixv.c				1.153, 1.157-1.161, 1.163-1.166 via patch
sys/dev/pci/ixgbe/if_bypass.c			1.7-1.9
sys/dev/pci/ixgbe/if_fdir.c			1.4-1.5
sys/dev/pci/ixgbe/if_sriov.c			1.10-1.11
sys/dev/pci/ixgbe/ixgbe_bypass.h		1.2
sys/dev/pci/ixgbe/ixgbe_82598.c			1.16
sys/dev/pci/ixgbe/ixgbe_82599.c			1.23
sys/dev/pci/ixgbe/ixgbe_api.c			1.25
sys/dev/pci/ixgbe/ixgbe_common.c		1.30-1.33
sys/dev/pci/ixgbe/ixgbe_dcb.c			1.10-1.11
sys/dev/pci/ixgbe/ixgbe_dcb.h			1.7
sys/dev/pci/ixgbe/ixgbe_dcb_82598.c		1.8-1.9
sys/dev/pci/ixgbe/ixgbe_dcb_82598.h		1.7
sys/dev/pci/ixgbe/ixgbe_dcb_82599.c		1.8-1.9
sys/dev/pci/ixgbe/ixgbe_dcb_82599.h		1.7
sys/dev/pci/ixgbe/ixgbe_fdir.h			1.3
sys/dev/pci/ixgbe/ixgbe_features.h		1.3
sys/dev/pci/ixgbe/ixgbe_mbx.c			1.12
sys/dev/pci/ixgbe/ixgbe_netbsd.c		1.13, 1.16-1.17
sys/dev/pci/ixgbe/ixgbe_netbsd.h		1.13-1.14
sys/dev/pci/ixgbe/ixgbe_netmap.c		1.3-1.4
sys/dev/pci/ixgbe/ixgbe_netmap.h		1.2
sys/dev/pci/ixgbe/ixgbe_osdep.c			1.7
sys/dev/pci/ixgbe/ixgbe_osdep.h			1.29-1.30
sys/dev/pci/ixgbe/ixgbe_phy.c			1.24
sys/dev/pci/ixgbe/ixgbe_rss.h			1.5
sys/dev/pci/ixgbe/ixgbe_sriov.h			1.4
sys/dev/pci/ixgbe/ixgbe_type.h			1.49
sys/dev/pci/ixgbe/ixgbe_vf.c			1.27
sys/dev/pci/ixgbe/ixgbe_x540.c			1.18-1.19
sys/dev/pci/ixgbe/ixgbe_x540.h			1.9
sys/dev/pci/ixgbe/ixgbe_x550.c			1.19-1.20
sys/dev/pci/ixgbe/ixgbe_x550.h			1.6
sys/dev/pci/files.pci				1.438
share/man/man4/ixg.4				1.15
share/man/man4/ixv.4				1.8

	- Use MCLGET() instead of homegrown cluster (jcl) allocation mechanism.
	  Before this commit, resource shortage was easily occurred because
	  the total number of the clusters is small.
	- Improve performace:
	  - Use m_adj(ETHER_ALIGN) more.
	  - Sprinkle __predict_false() in the RX path.
	  - Don't pre-allocate a cluster for RXCOPY case to improve short
	    packet's performance.
	- Call bus_dmamap_unload(9) via ixgbe_dmamap_unload(), before freeing
	  DMA buffer. Also, when the buffer is already freed, do not call
          bus_dmamap_unload(9) (no resource leaks with this change). This
	  change is required to make ixg(4) work on alpha.
	- Keep m_len and m_pkthdr.len consistent to prevent panic on arm.
	- Fix panic when bus_dmamap_load_mbuf() failed in
	  ixgbe_setup_receive_ring().
	- Added BUS_DMA_COHERENT flag to bus_dmamem_map() to improve stability
	  on aarch64.
	- Use uint64_t instead of bus_addr_t for the TX descriptor's buffer
	  address. At least, this change is required for macppc
	  (sizeof(bus_addr_t) == 4) to make TX work.
	- Fix little-endian dependence.
	- Set rxr->next_to_refresh correctly in ixgbe_setup_receive_ring().
	- Refresh unrefreshed descriptors' buffers correctly.
	- Don't call bus_dmamap_sync with rx_mbuf_sz(== MCLBYTES) to prevent
	  panic.
	- Save the discard_multidesc state to not to forget the state by
	  exiting rxeof().
	- Add missing increment of no_mbuf error counter.
	- Don't increment no_mbuf evcnt(9) when discarding multi-descriptor
	  packet.
	- ixv: Modify error message to sync with ixgbe.c
	- Print the error value of ixgbe_reset_hw() for debugging.
	- Remove extra unlock/lock processing around if_percpuq_enqueue().
	- Refactor rxr->next_to_check updating.
	- Add new sysctl "rx_copy_len".
	- Add a new sysctl to read rxr->next_to_refresh.
	- Print error number when error occurred.
	- Comment out flow director processing in fast path.
	- Add missing NetBSD RCS IDs and __KERNEL_RCSID()s.
	- KNF.
	- Fix typos.
	[msaitoh, ticket #1346]

bin/mkdir/mkdir.c				1.39

	mkdir(1): PR 56398: fix mode of final component of paths when -m
	is used.
	[kre, ticket #1347]

bin/cp/utils.c					1.47

	cp(1): PR 54564: cp of a fifo yields an empty file.
	[skrll, ticket #1348]

external/gpl3/gcc/dist/libgomp/oacc-init.c	1.1.1.5

	Fix a pthread_key leak.
	[manu, ticket #1349]

sys/kern/uipc_socket2.c				1.140
sys/miscfs/fifofs/fifo_vnops.c			1.87
tests/lib/libc/sys/t_poll.c			1.5

	PR kern/56429: fix POLLHUP behavior with FIFOs.
	[thorpej, ticket #1350]

sys/kern/uipc_syscalls.c			1.201
sys/miscfs/fifofs/fifo_vnops.c			1.88
tests/lib/libc/sys/t_poll.c			1.6-1.8

	Ensure that FIFOs have the same select/poll thresholds as pipes.
	[thorpej, ticket #1351]

tests/kernel/kqueue/read/t_fifo.c		1.5

	New EVFILT_READ test case for FIFOs; validates readability threshold
	and EV_EOF behavior.
	[thorpej, ticket #1352]

sys/miscfs/fifofs/fifo_vnops.c			1.90
tests/kernel/kqueue/write/t_fifo.c		1.5

	- Add a new EVFILT_WRITE test case for FIFOs that correctly validates
	  the writability thresholds.
	- Fix a bug in fifo_kqfilter() exposed by the new test case.
	[thorpej, ticket #1353]

xsrc/external/mit/xf86-input-keyboard/dist/src/kbd.c	1.8

	PR 56415: restore keyboard settings when the X server aborts on
	ports that use WSDISPLAY_COMPAT_RAWKBD.
	[tsutsui, ticket #1354]

lib/libc/sys/Makefile.inc			1.247
lib/libpthread/pthread_cancelstub.c		1.39,1.40

	PR 56424: recvfrom() is not a cancelation point as documented
	in pthread_setcanceltype.3
	[christos, ticket #1355]

lib/libc/resolv/res_init.c			1.32
lib/libc/resolv/res_private.h			1.4

	res_init(3): handle  kqueue close-on-fork semantics.
	[christos, ticket #1356]

sys/kern/sys_pipe.c				1.157

	PR 56422: fix a deadlock in "pipe_write()".
	[hannken, ticket #1357]

lib/libc/arch/aarch64/gen/_setjmp.S		1.5
lib/libc/arch/aarch64/gen/setjmp.S		1.4

	Fix failure of the lib/libc/setjmp/t_setjmp:{,_}longjmp_zero
	test cases.
	[skrll, ticket #1358]

share/man/man4/man4.amiga/amidisplaycc.4	1.14
sys/arch/amiga/dev/amidisplaycc.c		1.33,1.35,1.36

	amiga: enable wsfb based X11.
	[abs, ticket #1359]

distrib/amd64/Makefile				1.15
distrib/amd64/installimage-bios/Makefile	1.1
distrib/amd64/installimage-bios/boot.cfg.in	1.1
distrib/amd64/installimage-bios/etc.rc		1.1
distrib/amd64/installimage-bios/etc.ttys	1.1
distrib/amd64/installimage-bios/install.sh	1.1
distrib/amd64/installimage-bios/spec.inst	1.1

	Restore having a BIOS-only amd64 USB image.
	[maya, ticket #1360]

sys/dev/raidframe/rf_diskqueue.c		1.58-1.59
sys/dev/raidframe/rf_netbsd.h			1.36 (patch)

	RAIDframe could run out of IO buffers.
	[oster, ticket #1361]

sys/dev/pci/pcidevs				1.1419-1.1440
sys/dev/pci/pcidevs.h				regen
sys/dev/pci/pcidevs_data.h			regen

	- Add newer ciss(4) devices.
	- Add modern QUMRANET/Red Hat VIRTIO range PCI devices.
	- Add some more product IDs for mcx(4).
	- Add current generation NVIDIA graphics cards (3050-3090 etc.).
	- Add RDC R6022 PCI-Host bridge.
	- Add a whole bunch of radeon devices.
	- Add Realtek RTL8821CE.
	- Add Intel 660p SSD, and expand the 760p description.
	- Add Intel I219's version number.
	- Add Intel I219V 15-19 and I219LM 16-19.
	- Add Intel I225V, I225LM and WiFi 6 AX201.
	- Add newer Intel PCH internal devices.
	- Add Intel Jasper Lake devices.
	- PDC20265 is Ultra/100, not 66.
	- Fix Realtek RTL8125 description.
	- Sort Cavium devices.
	[msaitoh, ticket #1362]

share/man/man4/wm.4				1.42
sys/dev/pci/files.pci				1.434
sys/dev/pci/if_wm.c				1.690,1.692-1.693,1.697-1.704,
						1.706-1.715 via patch

	- Add missing drain for pcq in wm_stop_locked().
	- Add support for I219V 15-19 and I219LM 16-19.
	- Fix Tx stall.
	- Use wm_flush_desc_rings() workaround more on I219.
	- Change DMA physical address in wm_flush_desc_rings() to match other
	  OSes.
	- Check return value correctly in wm_lv_jumbo_workaround_ich8lan().
	- Add new sysctl hw.wmN.debug_flags. This sysctl can be used if
	  WM_DEBUG is set.
	- Add some sysctl values for debugging TX/RX queues.
	- Use atomic_{load,store}_relaxed for evcnt 64 bit counter.
	- WM_EVENT_COUNTER is enabled by default on 64 bit architectures.
	- Remove extra unlock/lock processing around if_percpuq_enqueue().
	- Refactor rxq->rxq_ptr updating.
	- Stop legacy interrupts before calling softint.
	- Disable printf()s in wm_flush_desc_rings() because the code is
	  verified.
	- Print I219's version number.
	- Uniform INTx/MSI handler's Tx/Rx behavior to MSI-X's one.
	- Fix return value of interrupt handler.
	- Only print an error about missing I/O BARs for chips that need it.
	- Do not return a void value from a void function.
	- Fix comment.
	- Whitespace fixes. No functional change.
	[msaitoh, ticket #1363]

sys/dev/usb/if_urtwn.c				1.101
sys/dev/usb/usbdevs				1.798
sys/dev/usb/usbdevs.h				(regen)
sys/dev/usb/usbdevs_data.h			(regen)

	urtwn(4): add Edimax N150 adapter.
	[jnemeth, ticket #1364]

usr.bin/ftp/fetch.c				1.233

	ftp(1): use raw write(2) instead of fwrite(3) to avoid stream
	corruption because of the progress bar interrupts.
	[lukem, ticket #1365]

usr.bin/ftp/ftp.c				1.173

	ftp(1): validate address from PASV and LPSV response.
	[lukem, ticket #1366]

usr.bin/ftp/ftp.c				1.174

	ftp(1): cleanup after previous security fix.
	[lukem, ticket #1367]

share/man/man4/options.4			1.520
sys/conf/files					1.1288
sys/kern/uipc_mbuf.c				1.244

	- Fix a bug that NMBCLUSTERS(kern.mbuf.nmbclusters) can't be changed
	  by sysctl.
	- Update NMBCLUSTERS and add NMBCLUSTERS_MAX in options(4).
	[msaitoh, ticket #1368]

sys/net/if_ethersubr.c				1.302

	Fix handling of VLAN 0 tag.
	[ryo, ticket #1369]

lib/libcrypt/crypt-sha1.c			1.10

	libcrypt: Fix a floating point exception when a low number of HMAC-SHA1
	iterations are specified.
	[nia, ticket #1370]

bin/sh/main.c					1.87 (patch),1.88
bin/sh/memalloc.c				1.34,1.35
bin/sh/memalloc.h				1.19,1.20
bin/sh/options.c				1.56
bin/sh/sh.1					1.235 (patch)
bin/sh/shell.h					1.31

	sh(1): PR 56464: read $HOME/.profile (instead of ./profile).
	Do not read it at all in a privileged shell (setuid or setgid).
	[kre, ticket #1371]

bin/sh/cd.c					1.51
bin/sh/sh.1					1.236 (patch)

	sh(1): PR 45390: fix cd/$PWD follies.
	[kre, ticket #1372]

sys/dev/pci/if_wm.c				1.716-1.718 via patch
sys/dev/pci/if_wmreg.h				1.121
sys/dev/mii/ihphy.c				1.20

	- Fix a bug that device timeout still happens when the link is down
	  on ICH/PCH. Fixes PR kern/56478.
	- Add some sysctl info for debugging.
	- ihphy(4): Don't power down the PHY when the interface goes down.
	- Use macro. Fix comment.
	[msaitoh, ticket #1373]

sys/dev/pci/ixgbe/ixgbe.h			1.81-1.83
sys/dev/pci/ixgbe/ixgbe.c			1.291-1.292 via patch
sys/dev/pci/ixgbe/ixgbe_type.h			1.50
sys/dev/pci/ixgbe/ixv.c				1.167-1.168 via patch
sys/dev/pci/ixgbe/ix_txrx.c			1.94

	- Fix a bug that a near 64KB TSO segment can't send.
	- Reduce bus_dmamap_sync() cost.
	- Use macro. Fix typos in comment.
	[msaitoh, ticket #1374]

sys/arch/x86/x86/cpu_topology.c			1.20
usr.sbin/cpuctl/arch/i386.c			1.123

	amd64: fix cpu topology detection for zen3 systems.
	[mrg, ticket #1375]

distrib/notes/common/main			1.566,1.567

	Add a note to the install documentations for amd64
	explaining the legacy amd64-bios-install image.
	[gutteridge, ticket #1376]
 
sys/dev/pci/piixpm.c				patch

	PR 56525: fix a bug that I2C access panics on old AMD chipset
	(e.g SB600).
	[msaitoh, ticket #1378]

usr.bin/msgs/pathnames.h			1.5

	msgs(1): avoid executing /usr/bin/Mail, it no longer exists.
	[nia, ticket #1379]

sys/dev/pci/pcidevs				1.1441-1.1444
sys/dev/pci/pcidevs.h				regen
sys/dev/pci/pcidevs_data.h			regen

	- Add Intel Gemini Lake TXE HECI 1.
	- Add Intel Elkhart Lake and Rocket Lake devices.
	- Update Jasper Lake's Processor Transaction Routers.
	[msaitoh, ticket #1380]

sys/dev/pci/ichsmb.c				1.69, 1.71, 1.73-1.75 via patch
	- Add Intel 400, 495, and 500 series support.
	- Add Intel Jasper Lake and Elkhart Lake support.
	- Ignore the SMBALERT# interrupt. Same as other OSes.
	[msaitoh, ticket #1381]

sys/dev/pci/pucdata.c				1.106-1.112
share/man/man4/puc.4				1.42-1.43

	- Add NetMos NM9900 Quad and Octal serial card.
	- Add ASIX AX99100 PCIe 4port serial card.
	- Add Oxford Semiconductor Exsys EX-41098 PCI serial card.
	[msaitoh, ticket #1382]

sys/dev/sdmmc/sdhc.c				1.110, 1.112
sys/dev/sdmmc/sdmmc_mem.c			1.74
sys/dev/pci/sdhc_pci.c				1.18

	- Support 64bit BAR.
	- Use unsigned to avoid undefined behavior in hwrite[12]() and
	  sdmmc_mem_sd_switch().
	- Fix typo in comment.
	[msaitoh, ticket #1383]

sys/dev/pci/pcireg.h			1.152-1.154, 1.156-1.161
sys/dev/pci/pci_subr.c			1.222, 1.227-1.232 via patch
sys/dev/pci/nvme_pci.c			1.31
sys/dev/pci/pci.c			1.158, 1.163
sys/dev/pci/ppb.c			1.74

	- When parsing Enhanced Allocation entries, use the correct calculation
	  for finding the next entry.
	- Add 32.0GT/s to the list of pcie speeds (PCIe 5.x.).
	- Add Some PCI config information:
	  - Lane Margining at the Receiver
	  - NVME admin interface
	  - UFSHCI
	  - InfiniBand
	  - Host fabric
	  - HDA 1.0 with vendor ext
	  - USB4 HCI
	  - MIPI I3C
	  - Cellular controller/modem (+ Ethernet)
	- Change PCI_VENDOR_MASK and PCI_PRODUCT_MASK to unsigned values, to
	  prevent sign extension of product ID when shifted up into place in
	  PCI_ID_CODE(). Fixes PR kern/56176.
	- Add LCAP & LCAP2 definitions.
	- Use PCI-SIG official acronyms for some macros.
	- Fix typo in some messages.
	- Fix typo in comments.
	- Whitespace fixes.
	[msaitoh, ticket #1384]

sys/arch/x86/x86/procfs_machdep.c		1.40-1.42

	- Add v_spec_ctrl, avx512_fp16, sme, sev, sev_es, sgx, sgx_lc,
	  serialize and tsxldtrk.
	- Whitespace fix.
	[msaitoh, ticket #1385]

sys/dev/usb/ehci.c				1.287

	ehci(4): fix suspend/resume locking.
	[riastradh, ticket #1386]

sys/dev/i2c/sdtemp.c				1.41

	sdtemp(4): use aprint_debug instead of aprint_error for expected
	failure.
	[msaitoh, ticket #1387]

sys/dev/i2c/spdmem_i2c.c			1.23-1.25 via patch

	- Carefully access to the I2C bus in the match function.
	- Improve bank reset code for DDR4.
	[msaitoh, ticket #1388]

sys/arch/x86/x86/identcpu.c			1.103-1.105

	Identify Vortex86EX2.
	[msaitoh, ticket #1389]

sys/arch/x86/x86/identcpu.c			1.121

	Make a numeric literal unsigned as it is bit-negated.
	[msaitoh, ticket #1390]

sys/arch/x86/include/specialreg.h		1.171, 1.173-1.178
sys/arch/x86/x86/identcpu.c			1.106, 1.117, 1.122 via patch
sys/dev/nvmm/x86/nvmm_x86.c			1.18
sys/external/bsd/drm2/drm/drm_cache.c		1.14
sys/external/bsd/drm2/include/asm/cpufeature.h	1.5
usr.sbin/cpuctl/arch/i386.c			1.114-1.117

	- Add LA57, PKE, PKS, CET, CET_U, CET_S, HWP, KL, AVX512_BF16, TME_EN
	  and PCONFIG.
	- Rename some macros to match the x86 specification and the other OSes.
	- Print CPUID 0x8000008 %ebx on Intel, too.
	- Print CPUID leaf 7 subleaf 1.
	- Identify Tiger Lake, 3rd gen Xeon Scalable (Ice Lake), Elkhart Lake
	  and Jasper Lake.
	- Add comment.
	- KNF. Whitespace fix.
	[msaitoh, ticket #1391]

sys/dev/ipmi.c					1.6-1.9

	ipmi(4): various stability improvements and fix for PR 56539.
	[hauke, ticket #1392]

sys/dev/cgd.c					1.141

	cgd(4): PR 56546: wait for worker threads to complete before
	destroying mutex.
	[riastradh, ticket #1393]

sys/dev/raidframe/rf_diskqueue.c		1.63 (patch)

	raid(4): add missing buf_destroy() call.
	[mrg, ticket #1394]

sys/dev/usb/usb_quirks.c			1.101
sys/dev/usb/usbdevs				1.799
sys/dev/usb/usbdevs.h				(regen)
sys/dev/usb/usbdevs_data.h			(regen)

	Add two additional cyperpower UPS ids to be ignored as HID devices.
	[mrg, ticket #1395]

usr.sbin/cpuctl/arch/i386.c			1.118-1.119, 1.121-1.122
usr.sbin/cpuctl/arch/cpuctl_i386.h		1.6
sys/arch/x86/x86/identcpu_subr.c		1.8-1.9
sys/arch/x86/x86/identcpu.c			1.123
sys/arch/x86/include/cacheinfo.h		1.30
sys/arch/x86/include/cpu.h			1.132

	- Fix a bug that some TLB related lines were not printed.
	- Fix a bug that STLB is printed as DTLB.
	- If a TLB is variable sized, print the max size instead of error
	  message.
	- Cosmetic changes to improve readability.
	[msaitoh, ticket #1396]

sys/dev/pckbport/synaptics.c			1.71

	synaptics(4): New sysctl knob hw.synaptics.debug to enable debug
	output.
	[riastradh, ticket #1397]

sys/dev/cgd.c					1.142

	cgd(4): fix detach when still in use by wedges.
	[riastradh, ticket #1398]

external/cddl/osnet/dist/uts/common/fs/zfs/zfs_acl.c 1.7

	Default files to BSD group ownership in line with ffs.
	[hauke, ticket #1400]

sys/conf/copyright				1.20

	Welcome to 2022!
	[jnemeth, ticket #1401]

sys/dev/usb/usbdevs				1.801
sys/dev/usb/usbdevs.h				(regen)
sys/dev/usb/usbdevs_data.h			(regen)

	Add the Microchip PICkit3 programmer.
	[bouyer, ticket #1402]

sys/dev/usb/usb_quirks.c			1.103

	Add UQ_HID_IGNORE for the Microchip PICkit2 and 3 programmers.
	[bouyer, ticket #1403]

sys/dev/usb/usbdevs				1.800
sys/dev/usb/usbdevs.h				(regen)
sys/dev/usb/usbdevs_data.h			(regen)

	Add a new APC UPS device id.
	[martin, ticket #1404]

sys/dev/usb/usb_quirks.c			1.102

	Ignore new APC UPS devices when matching uhid devices.
	[martin, ticket #1405]

sys/dev/acpi/acpi_display.c			1.21

	acpiout(4): Work around firmware that doesn't like some brightnesses.
	[riastradh, ticket #1399]

usr.sbin/sysinst/msg.mi.de			1.35
usr.sbin/sysinst/msg.mi.en			1.37
usr.sbin/sysinst/msg.mi.es			1.31
usr.sbin/sysinst/msg.mi.fr			1.36
usr.sbin/sysinst/msg.mi.pl			1.37
usr.sbin/sysinst/net.c				1.37-1.40

	sysinst(8): Add support for connecting to Wi-Fi networks.
	[nia, ticket #1406]

sys/dev/pci/ixgbe/ixgbe.c			1.298, 1.303 via patch

	Add some missing error counters to ierror.
	[msaitoh, ticket #1407]

sys/dev/pci/ixgbe/ixgbe_vf.h			1.16-1.17 via patch
sys/dev/pci/ixgbe/ixv.c				1.176-1.177 via patch

	Make ifconfig -z ixvN clear event counter.
	[msaitoh, ticket #1408]

sys/dev/mii/igphy.c				1.37
sys/dev/mii/ihphy.c				1.19
sys/dev/mii/makphy.c				1.68

	Fix a bug that "ifconfig xx0 media none" set LINK_STATE_UNKNOWN
	instead of LINK_STATE_DOWN.
	[msaitoh, ticket #1409]

sys/dev/mii/makphy.c				1.67,1.69-1.72 (patch)
sys/dev/mii/makphyvar.h				1.3-1.4 (patch)

	- Add I347-AT4 support.
	- Add three workarounds for QEMU e1000:
	  - QEMU sets BMSR_EXTSTAT but the access to register 15 fails.
	    Set EXTSR_1000TFDX and EXTSR_1000THDX if the access failed in the
	    attach function. It's just a cosmetic change.
	  - Marvell 88E1[01]11 have the Fiber/Copper auto selection feature,
	    but QEMU doesn't implement it. If the register access failed,
	    the media is regarded as copper only. It's just a cosmetic change.
	  - QEMU provides the PHY specific status register at 0x11 but the
	    link indication bit (PSSR_LINK) is always 1. It causes
	    "virsh domif-setlink xxx yyy down" doesn't work. To avoid this
	    problem, read the BMSR and check the BMSR_LINK bit. Add
	    MAKPHY_QUIRK_PSSR_LINK bit for this quirk. Set it if MII_EXTSR
	    doesn't exist because it's one of the case of QEMU.
	- Reduce the number of access to the ESSR register. One of the reason
	  is that the register is not implemented on QEMU. Another reason is
	  that it's not required to access the register if the device is in
	  the copper only mode.
	[msaitoh, ticket #1410]

sys/net/ppp_tty.c				1.68
sys/net/ppp_tty.c				1.69

	Use unsigned to avoid undefined behavior in pppasyncstart()
	and pppinput().
	[msaitoh, ticket #1411]

sys/dev/pci/pci_subr.c				1.232-1.239 via patch
sys/dev/pci/pcireg.h				1.62-1.63

	- Decode link control2's Compliance Preset/De-emphasis more.
	- Decode Physical Layer 16.0 GT/s extended capability.
	- Decode Lane Margining at the Receiver extended capability.
	- Print "reserved" instead of "unknown" when printing equalization
	  preset. One of them is known to be the default value.
	- Fix typo.
	[msaitoh, ticket #1412]

sys/dev/pci/ixgbe/if_sriov.c			1.12-1.16
sys/dev/pci/ixgbe/ixgbe.c			1.295-1.297, 1.300,
						1.304 via patch
sys/dev/pci/ixgbe/ixgbe.h			1.84
sys/dev/pci/ixgbe/ixgbe_82598.c			1.17-1.18
sys/dev/pci/ixgbe/ixgbe_82598.h			1.9
sys/dev/pci/ixgbe/ixgbe_82599.c			1.24-1.28
sys/dev/pci/ixgbe/ixgbe_82599.h			1.8
sys/dev/pci/ixgbe/ixgbe_api.c			1.26-1.27
sys/dev/pci/ixgbe/ixgbe_api.h			1.16
sys/dev/pci/ixgbe/ixgbe_bypass.h		1.3
sys/dev/pci/ixgbe/ixgbe_common.c		1.34-1.42
sys/dev/pci/ixgbe/ixgbe_common.h		1.15-1.16
sys/dev/pci/ixgbe/ixgbe_dcb.c			1.12-1.13
sys/dev/pci/ixgbe/ixgbe_dcb.h			1.8-1.9
sys/dev/pci/ixgbe/ixgbe_dcb_82598.c		1.10-1.12
sys/dev/pci/ixgbe/ixgbe_dcb_82598.h		1.8
sys/dev/pci/ixgbe/ixgbe_dcb_82599.c		1.10-1.11
sys/dev/pci/ixgbe/ixgbe_dcb_82599.h		1.8
sys/dev/pci/ixgbe/ixgbe_fdir.h			1.4
sys/dev/pci/ixgbe/ixgbe_features.h		1.4
sys/dev/pci/ixgbe/ixgbe_mbx.c			1.13-1.15
sys/dev/pci/ixgbe/ixgbe_mbx.h			1.15-1.18
sys/dev/pci/ixgbe/ixgbe_netmap.c		1.5
sys/dev/pci/ixgbe/ixgbe_osdep.c			1.8
sys/dev/pci/ixgbe/ixgbe_osdep.h			1.31
sys/dev/pci/ixgbe/ixgbe_phy.c			1.25-1.29
sys/dev/pci/ixgbe/ixgbe_phy.h			1.13
sys/dev/pci/ixgbe/ixgbe_rss.h			1.6
sys/dev/pci/ixgbe/ixgbe_sriov.h			1.5
sys/dev/pci/ixgbe/ixgbe_type.h			1.51-1.54
sys/dev/pci/ixgbe/ixgbe_vf.c			1.28-1.29
sys/dev/pci/ixgbe/ixgbe_vf.h			1.15
sys/dev/pci/ixgbe/ixgbe_x540.c			1.20-1.22
sys/dev/pci/ixgbe/ixgbe_x540.h			1.10
sys/dev/pci/ixgbe/ixgbe_x550.c			1.21-1.25
sys/dev/pci/ixgbe/ixgbe_x550.h			1.7
sys/dev/pci/ixgbe/ixv.c				1.170, 1.174-1.175 via patch

	- Add typecast for type mismatch.
	- Fix retry count calculation of I2C read/write.
	- Wait longer for link after fiber MAC setup.
	- ixv(4): Use adapter->mta for the multicast array memory instead of
	  the on-stack array.
	- Match X550_PHY_ID correctly on X550.
	- Print NVM image version on 82598.
	- Use 64bit for lxon + lxoff.
	- Don't expose garbage data of hw.ixvN.debug.
	- Some NetBSD unrelated changes:
	  - Fix infinite recursion on PCIe link down if VMDQ is used.
	  - Move PF mailbox initialization from ixgbe_attach() to
	    ixgbe_init_iov().
	  - Add IPv6 mask for flow director.
	  - Change error level in ixgbe_fc_autoneg().
	  - Check host interface return status when writing NVM.
	  - Change DCB credit parameters.
	- Restore some mailbox related functions. Revert part of ixgbe_mbx.c
	  rev. 1.7 and ixgbe_mbx.h rev. 1.11. No functional change.
	- Rename IXGBE_VT_MSGTYPE_{ACK,NACK} to
	  IXGBE_VT_MSGTYPE_{SUCCESS,FAILURE}. No functional change.
	- Remove unused argument. Change argument.
	- Remove unnecessary return value check.
	- Remove debug error message.
	- Remove dead code.
	- Add some unused macros.
	- Fix typo in comment.
	- Rename some functions.
	- Sort lines, modify comment.
	- Whitespace fix.
	[msaitoh, ticket #1414]

sys/dev/usb/usbnet.c				1.44 (patch)

	usbnet(9): defer hardware multicast filter updates to USB task.
	[riastradh, ticket #1415]

sys/dev/pci/ixgbe/if_sriov.c			1.17
sys/dev/pci/ixgbe/ixgbe.c			1.301
sys/dev/pci/ixgbe/ixgbe_82599.c			1.29
sys/dev/pci/ixgbe/ixgbe_mbx.c			1.16
sys/dev/pci/ixgbe/ixgbe_mbx.c			1.17
sys/dev/pci/ixgbe/ixgbe_mbx.c			1.18
sys/dev/pci/ixgbe/ixgbe_mbx.h			1.19
sys/dev/pci/ixgbe/ixgbe_type.h			1.55
sys/dev/pci/ixgbe/ixgbe_vf.c			1.31
sys/dev/pci/ixgbe/ixgbe_x540.c			1.23
sys/dev/pci/ixgbe/ixv.c				1.172
sys/dev/pci/ixgbe/ixv.c				1.173

	Add code to support mailbox API 1.5.
	[msaitoh, ticket #1416]

sys/arch/x86/include/specialreg.h		1.179-1.188 (patch)

	- Add CPUID definitions of Last Branch Record, Thread Director,
	  AVX version of VNNI, Fast short REP MOV, HRESET, PPIN, Architectural
	  LBR, Linear Address Masking and Hybrid Information from the latest
	  Intel SDM.
	- Add CPUID definitions of AddrMaskExt, INT_WBINVD, IbrsSameMode,
	  EferLmsleUnsupported, PSFD and SecureTSC from AMD APM.
	- Print CLFSH instead of CLFLUSH because both Intel and AMD documents
	  say so.
	- Modify comment. Add comment. Fix typo. Use __BIT(). KNF. Sort lines.
	  No functional change.
	[msaitoh, ticket #1417]

usr.sbin/cpuctl/arch/i386.c			1.125-1.127

	- Add Alder Lake, Rocket Lake and Sapphire Rapids.
	- Decode Intel Hybrid Information Enumeration (CPUID Fn0000_001a).
	- Remove debug code and simplify. No functional change.
	[msaitoh, ticket #1418]

sys/arch/x86/x86/procfs_machdep.c		1.43-1.44

	- The CPUID table 11 was changed from CPUID 0x0f leaf 0 %edx to a Linux
	  mapping.
	- The CPUID table 12 was changed from CPUID 0x0f leaf 1 %edx to CPUID
	  0x07 leaf 1 %eax. Print avx_vnni and avx512_bf16.
	- Print cppc, enqcmd and arch_lbr.
	- Modify linux mapping. Not used on NetBSD.
	[msaitoh, ticket #1419]

sys/dev/pci/ixgbe/ixgbe.c			1.264,1.269,1.272,
						1.306 via patch

	Four INTx related fixes:
	- Fix a bug that the all interrupt sources are enabled when the
	  interface is UP and the INTx line is shared with other devices.
	- Fix a bug that it might incorrectly enable interrupt when
	  IFF_RUNNING is not set.
	- Don't process TX/RX if a queue interrupt isn't occurred.
	- Increment legacy interrupt counter after checking INTx sharing.
	[msaitoh, ticket #1420]

sys/dev/scsipi/cd.c				1.351

	PR 56109: limit the buffer size for a device capabilities requests.
	[reinoud, ticket #1421]

usr.sbin/sysinst/arch/acorn32/md.c		1.8
usr.sbin/sysinst/arch/alpha/md.c		1.10
usr.sbin/sysinst/arch/amiga/md.c		1.7
usr.sbin/sysinst/arch/arc/md.c			1.14
usr.sbin/sysinst/arch/atari/md.c		1.8
usr.sbin/sysinst/arch/bebox/md.c		1.10
usr.sbin/sysinst/arch/cats/md.c			1.6
usr.sbin/sysinst/arch/cobalt/md.c		1.15
usr.sbin/sysinst/arch/dummy/md.c		1.7
usr.sbin/sysinst/arch/emips/md.c		1.10
usr.sbin/sysinst/arch/evbarm/md.c		1.22
usr.sbin/sysinst/arch/evbmips/md.c		1.10
usr.sbin/sysinst/arch/evbppc/md.c		1.10
usr.sbin/sysinst/arch/evbsh3/md.c		1.7
usr.sbin/sysinst/arch/ews4800mips/md.c		1.8
usr.sbin/sysinst/arch/hp300/md.c		1.12
usr.sbin/sysinst/arch/hpcarm/md.c		1.11
usr.sbin/sysinst/arch/hpcmips/md.c		1.10
usr.sbin/sysinst/arch/hpcsh/md.c		1.11
usr.sbin/sysinst/arch/hppa/md.c			1.9
usr.sbin/sysinst/arch/i386/md.c			1.34
usr.sbin/sysinst/arch/landisk/md.c		1.15
usr.sbin/sysinst/arch/luna68k/md.c		1.10
usr.sbin/sysinst/arch/mac68k/md.c		1.11
usr.sbin/sysinst/arch/macppc/md.c		1.7
usr.sbin/sysinst/arch/mipsco/md.c		1.9
usr.sbin/sysinst/arch/mvme68k/md.c		1.12
usr.sbin/sysinst/arch/news68k/md.c		1.8
usr.sbin/sysinst/arch/newsmips/md.c		1.7
usr.sbin/sysinst/arch/ofppc/md.c		1.13
usr.sbin/sysinst/arch/playstation2/md.c		1.10
usr.sbin/sysinst/arch/pmax/md.c			1.9
usr.sbin/sysinst/arch/prep/md.c			1.14
usr.sbin/sysinst/arch/sandpoint/md.c		1.10
usr.sbin/sysinst/arch/sgimips/md.c		1.10
usr.sbin/sysinst/arch/shark/md.c		1.7
usr.sbin/sysinst/arch/sparc/md.c		1.7
usr.sbin/sysinst/arch/sparc64/md.c		1.7
usr.sbin/sysinst/arch/vax/md.c			1.8
usr.sbin/sysinst/arch/x68k/md.c			1.12
usr.sbin/sysinst/arch/zaurus/md.c		1.12
usr.sbin/sysinst/defs.h				1.77-1.79
usr.sbin/sysinst/gpt.c				1.27-1.28
usr.sbin/sysinst/install.c			1.22
usr.sbin/sysinst/main.c				1.28
usr.sbin/sysinst/target.c			1.16-1.17
usr.sbin/sysinst/upgrade.c			1.19
usr.sbin/sysinst/util.c				1.64

	sysinst: on x86 make sure to update the bootloader when upgrading
	existing installations.
	Clean up temporary wedges used during extraction/installation.
	[martin, ticket #1422]

build.sh					1.345

	Add "distsets" alias for "distribution sets".
	[mrg, ticket #1423]

sys/dev/pci/ixgbe/ix_txrx.c			1.95
sys/dev/pci/ixgbe/ixgbe.c			1.305 via patch
sys/dev/pci/ixgbe/ixgbe_mbx.c			1.19
sys/dev/pci/ixgbe/ixgbe_netbsd.h		1.15-1.16
sys/dev/pci/ixgbe/ixv.c				1.178 via patch

	Use atomic_{load,store}_relaxed() for event counters.
	[msaitoh, ticket #1424]

xsrc/external/mit/xterm/dist/graphics_sixel.c	1.2 (via patch)

	Apply upstream fix for CVE-2022-24130.
	[mrg, ticket #1425]

sys/dev/ata/ata_recovery.c			1.3
sys/dev/ata/ata_subr.c				1.9

	PR 54790: stop xfer timeouts during recovery, all xfers will be
	requeued anyway.
	[jdolecek, ticket #1426]

