#	$NetBSD: Makefile,v 1.22.4.1 2021/06/06 20:30:47 cjep Exp $

.include <bsd.own.mk>

PROG=	xterm
SRCS=	button.c charproc.c charsets.c cursor.c data.c doublechr.c \
	graphics.c graphics_sixel.c fontutils.c input.c linedata.c menu.c \
	misc.c print.c ptydata.c screen.c scrollback.c scrollbar.c tabs.c \
	util.c xstrings.c TekPrsTbl.c Tekproc.c VTPrsTbl.c main.c \
	charclass.c precompose.c wcwidth.c xutf8.c cachedGCs.c xtermcap.c \
	svg.c html.c version.c

# XXX
# xterm.appdata.xml

CPPFLAGS+=	-I. \
		-I${X11SRCDIR.${PROG}} \
		-I${X11SRCDIR.${PROG}}/../include \
		-I${DESTDIR}${X11INCDIR}/freetype2 \
		-I${DESTDIR}${X11INCDIR}/freetype2/freetype \
		-DPROJECTROOT=${X11ROOTDIR} \
		-DHAVE_CONFIG_H \
		-D_REENTRANT \
		${X11FLAGS.VERSION}

CWARNFLAGS.clang+=	-Wno-empty-body
CWARNFLAGS.gcc+=	-Wno-error=attributes

APPDEFS=XTerm.ad XTerm-color.ad

BUILDSYMLINKS=	XTerm-col.ad XTerm-color.ad

#CPPFLAGS+=-DOPT_TRACE
#SRCS+=trace.c

LDADD+=	${XLIBLDADD_XFT} ${XLIBLDADD_XAW}
DPADD+=	${XLIBDPADD_XFT} ${XLIBDPADD_XAW} 
LDADD+=	-lXinerama
DPADD+=	${LIBXINERAMA}
LDADD+=	${XLIBLDADD_XPM} -lcurses -lterminfo -lutil
DPADD+=	${XLIBDPADD_XPM} ${LIBCURSES} ${LIBTERMINFO} ${LIBUTIL}

SUBDIR=	uxterm

.PATH:	${X11SRCDIR.${PROG}}

COPTS.input.c+=	-Wno-error	# uses XKeycodeToKeysym

# XXXMRG should probably build builtin_icons.h

.SUFFIXES: .def .hin
.def.hin:
	${TOOL_AWK} '/^CASE_/{printf "#define %s %d\n", $$1, n++}' < $< >$@
DPSRCS+= Tekparse.hin VTparse.hin
CLEANFILES+= Tekparse.hin VTparse.hin

.include "Makefile.inc"

.include <bsd.x11.mk>
.include <bsd.prog.mk>
.include <bsd.subdir.mk>
