; config options
server:
	nsid: "0123456789abcdef"

stub-zone:
	name: "example."
	stub-addr: 192.0.2.1
CONFIG_END

SCENARIO_BEGIN Test EDNS string tag option

RANGE_BEGIN 0 1000
	ADDRESS 192.0.2.1
ENTRY_BEGIN
MATCH opcode qtype qname
ADJUST copy_id
REPLY QR NOERROR
SECTION QUESTION
example. IN A
SECTION ANSWER
example. IN A 198.51.100.1
SECTION ADDITIONAL
ENTRY_END
RANGE_END

STEP 10 QUERY
ENTRY_BEGIN
REPLY RD
SECTION QUESTION
example. IN A
SECTION ADDITIONAL
	HEX_EDNSDATA_BEGIN
		00 03 ; Opcode NSID (3)
		00 00 ; Length 0
	HEX_EDNSDATA_END
ENTRY_END

STEP 30 CHECK_ANSWER
ENTRY_BEGIN
MATCH all
REPLY QR RD RA NOERROR
SECTION QUESTION
example. IN A
SECTION ANSWER
example. IN A 198.51.100.1
SECTION ADDITIONAL
	HEX_EDNSDATA_BEGIN
		00 03       ; Opcode NSID (3)
		00 08       ; Length 8
		01 23 45 67 ;
		89 ab cd ef ;
	HEX_EDNSDATA_END
ENTRY_END
SCENARIO_END
