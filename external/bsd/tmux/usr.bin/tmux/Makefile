# $NetBSD: Makefile,v 1.4 2011/08/16 07:57:21 christos Exp $

.include <bsd.own.mk>
WARNS?=	4

SRCDIR=		${NETBSDSRCDIR}/external/bsd/tmux/dist
.PATH:		${SRCDIR}
.PATH:		${SRCDIR}/compat

BINDIR=		/usr/bin
PROG=		tmux
MAN=		tmux.1

SRCS=		attributes.c
SRCS+=		cfg.c
SRCS+=		client.c
SRCS+=		clock.c
SRCS+=		cmd-attach-session.c
SRCS+=		cmd-bind-key.c
SRCS+=		cmd-break-pane.c
SRCS+=		cmd-capture-pane.c
SRCS+=		cmd-choose-buffer.c
SRCS+=		cmd-choose-client.c
SRCS+=		cmd-choose-session.c
SRCS+=		cmd-choose-window.c
SRCS+=		cmd-clear-history.c
SRCS+=		cmd-clock-mode.c
SRCS+=		cmd-command-prompt.c
SRCS+=		cmd-confirm-before.c
SRCS+=		cmd-copy-buffer.c
SRCS+=		cmd-copy-mode.c
SRCS+=		cmd-delete-buffer.c
SRCS+=		cmd-detach-client.c
SRCS+=		cmd-display-message.c
SRCS+=		cmd-display-panes.c
SRCS+=		cmd-find-window.c
SRCS+=		cmd-generic.c
SRCS+=		cmd-has-session.c
SRCS+=		cmd-if-shell.c
SRCS+=		cmd-join-pane.c
SRCS+=		cmd-kill-pane.c
SRCS+=		cmd-kill-server.c
SRCS+=		cmd-kill-session.c
SRCS+=		cmd-kill-window.c
SRCS+=		cmd-last-pane.c
SRCS+=		cmd-last-window.c
SRCS+=		cmd-link-window.c
SRCS+=		cmd-list-buffers.c
SRCS+=		cmd-list-clients.c
SRCS+=		cmd-list-commands.c
SRCS+=		cmd-list-keys.c
SRCS+=		cmd-list-panes.c
SRCS+=		cmd-list-sessions.c
SRCS+=		cmd-list-windows.c
SRCS+=		cmd-list.c
SRCS+=		cmd-load-buffer.c
SRCS+=		cmd-lock-client.c
SRCS+=		cmd-lock-server.c
SRCS+=		cmd-lock-session.c
SRCS+=		cmd-move-window.c
SRCS+=		cmd-new-session.c
SRCS+=		cmd-new-window.c
SRCS+=		cmd-next-layout.c
SRCS+=		cmd-next-window.c
SRCS+=		cmd-paste-buffer.c
SRCS+=		cmd-pipe-pane.c
SRCS+=		cmd-previous-layout.c
SRCS+=		cmd-previous-window.c
SRCS+=		cmd-refresh-client.c
SRCS+=		cmd-rename-session.c
SRCS+=		cmd-rename-window.c
SRCS+=		cmd-resize-pane.c
SRCS+=		cmd-respawn-window.c
SRCS+=		cmd-rotate-window.c
SRCS+=		cmd-run-shell.c
SRCS+=		cmd-save-buffer.c
SRCS+=		cmd-select-layout.c
SRCS+=		cmd-select-pane.c
SRCS+=		cmd-select-window.c
SRCS+=		cmd-send-keys.c
SRCS+=		cmd-send-prefix.c
SRCS+=		cmd-server-info.c
SRCS+=		cmd-set-buffer.c
SRCS+=		cmd-set-environment.c
SRCS+=		cmd-set-option.c
SRCS+=		cmd-set-window-option.c
SRCS+=		cmd-show-buffer.c
SRCS+=		cmd-show-environment.c
SRCS+=		cmd-show-messages.c
SRCS+=		cmd-show-options.c
SRCS+=		cmd-show-window-options.c
SRCS+=		cmd-source-file.c
SRCS+=		cmd-split-window.c
SRCS+=		cmd-start-server.c
SRCS+=		cmd-string.c
SRCS+=		cmd-suspend-client.c
SRCS+=		cmd-swap-pane.c
SRCS+=		cmd-swap-window.c
SRCS+=		cmd-switch-client.c
SRCS+=		cmd-unbind-key.c
SRCS+=		cmd-unlink-window.c
SRCS+=		cmd.c
SRCS+=		colour.c
SRCS+=		environ.c
SRCS+=		grid-utf8.c
SRCS+=		grid-view.c
SRCS+=		grid.c
SRCS+=		input-keys.c
SRCS+=		input.c
SRCS+=		job.c
SRCS+=		key-bindings.c
SRCS+=		key-string.c
SRCS+=		layout-custom.c
SRCS+=		layout-set.c
SRCS+=		layout-string.c
SRCS+=		layout.c
SRCS+=		log.c
SRCS+=		mode-key.c
SRCS+=		names.c
SRCS+=		options.c
SRCS+=		osdep-netbsd.c
SRCS+=		paste.c
SRCS+=		resize.c
SRCS+=		screen-redraw.c
SRCS+=		screen-write.c
SRCS+=		screen.c
SRCS+=		server-client.c
SRCS+=		server-fn.c
SRCS+=		server-window.c
SRCS+=		server.c
SRCS+=		session.c
SRCS+=		signal.c
SRCS+=		status.c
SRCS+=		tmux.c
SRCS+=		tty-acs.c
SRCS+=		tty-keys.c
SRCS+=		tty-term.c
SRCS+=		tty.c
SRCS+=		utf8.c
SRCS+=		window-choose.c
SRCS+=		window-clock.c
SRCS+=		window-copy.c
SRCS+=		window.c
SRCS+=		xmalloc.c
SRCS+=		xterm-keys.c

# Files in compat/
SRCS+=		imsg-buffer.c
SRCS+=		imsg.c
SRCS+=		strtonum.c
#SRCS+=		unvis.c
#SRCS+=		vis.c

VERSION!=	cat "$(.CURDIR)/version.txt"
CPPFLAGS+=	-DBUILD="\"$(VERSION)\""
CPPFLAGS+=	-I${SRCDIR} -I${.CURDIR}

COPTS.cmd-paste-buffer.c+=	-Wno-stack-protector
COPTS.cmd-server-info.c+=	-Wno-stack-protector
COPTS.imsg-buffer.c+=		-Wno-stack-protector
COPTS.imsg.c+=			-Wno-stack-protector
COPTS.screen.c+=		-Wno-stack-protector
COPTS.status.c+=		-Wno-format-nonliteral

LDADD+=		-levent -lterminfo -lutil
DPADD+=		${LIBEVENT} ${LIBTERMINFO} ${LIBUTIL}

.include <bsd.prog.mk>
