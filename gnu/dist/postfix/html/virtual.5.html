<html> <head> </head> <body> <pre>
VIRTUAL(5)                                             VIRTUAL(5)

<b>NAME</b>
       virtual - format of Postfix virtual alias table

<b>SYNOPSIS</b>
       <b>postmap</b> <b>/etc/postfix/virtual</b>

       <b>postmap</b> <b>-q</b> <b>"</b><i>string</i><b>"</b> <b>/etc/postfix/virtual</b>

       <b>postmap</b> <b>-q</b> <b>-</b> <b>/etc/postfix/virtual</b> &lt;<i>inputfile</i>

<b>DESCRIPTION</b>
       The  optional <b>virtual</b> alias table specifies address alias-
       ing for arbitrary local or non-local recipient  addresses.
       Virtual  aliasing is recursive, and is done by the Postfix
       <a href="cleanup.8.html"><b>cleanup</b>(8)</a> daemon.

       The main applications of virtual aliasing are:

       <b>o</b>      To redirect mail for one address  to  one  or  more
              addresses.

       <b>o</b>      To   implement  virtual  alias  domains  where  all
              addresses  are  aliased  to  addresses   in   other
              domains.

              Virtual  alias  domains are not to be confused with
              the virtual mailbox domains  that  are  implemented
              with  the  Postfix  <a href="virtual.8.html"><b>virtual</b>(8)</a> mail delivery agent.
              With  virtual  mailbox  domains,   each   recipient
              address can have its own mailbox.

       Virtual  aliasing  is  applied  only to recipient envelope
       addresses, and does not  affect  message  headers.   Think
       Sendmail  rule  set <b>S0</b>, if you like. Use <a href="canonical.5.html"><b>canonical</b>(5)</a> map-
       ping to rewrite header and envelope addresses in  general.

       Normally,  the  <b>virtual</b> alias table is specified as a text
       file that serves as input to the <a href="postmap.1.html"><b>postmap</b>(1)</a> command.   The
       result,  an  indexed file in <b>dbm</b> or <b>db</b> format, is used for
       fast searching by the mail  system.  Execute  the  command
       <b>postmap</b>  <b>/etc/postfix/virtual</b>  in  order  to  rebuild  the
       indexed file after changing the text file.

       When the table is provided via other means  such  as  NIS,
       LDAP  or  SQL,  the  same lookups are done as for ordinary
       indexed files.

       Alternatively, the table can be  provided  as  a  regular-
       expression map where patterns are given as regular expres-
       sions. In that case, the lookups are done  in  a  slightly
       different way as described below.

<b>TABLE</b> <b>FORMAT</b>
       The input format for the <a href="postmap.1.html"><b>postmap</b>(1)</a> command is as follows:

       <i>pattern</i> <i>result</i>
              When <i>pattern</i> matches a mail address, replace it  by
              the corresponding <i>result</i>.

       blank lines and comments
              Empty  lines and whitespace-only lines are ignored,
              as are lines whose first  non-whitespace  character
              is a `#'.

       multi-line text
              A  logical  line starts with non-whitespace text. A
              line that starts with whitespace continues a  logi-
              cal line.

       With lookups from indexed files such as DB or DBM, or from
       networked tables such as NIS, LDAP or  SQL,  patterns  are
       tried in the order as listed below:

       <i>user</i>@<i>domain</i> <i>address,</i> <i>address,</i> <i>...</i>
              Mail  for  <i>user</i>@<i>domain</i>  is  redirected  to <i>address</i>.
              This form has the highest precedence.

       <i>user</i> <i>address,</i> <i>address,</i> <i>...</i>
              Mail for <i>user</i>@<i>site</i> is redirected  to  <i>address</i>  when
              <i>site</i>  is equal to $<b>myorigin</b>, when <i>site</i> is listed in
              $mydestination,   or   when   it   is   listed   in
              $<i>inet_interfaces</i>.

              This  functionality  overlaps with functionality of
              the local <i>aliases</i>(5) database.  The  difference  is
              that  <b>virtual</b>  mapping  can be applied to non-local
              addresses.

       @<i>domain</i> <i>address,</i> <i>address,</i> <i>...</i>
              Mail for  any  user  in  <i>domain</i>  is  redirected  to
              <i>address</i>.  This form has the lowest precedence.

       In  all the above forms, when <i>address</i> has the form @<i>other-</i>
       <i>domain</i>, the result is the same user in <i>otherdomain</i>.   This
       works for the first address in the expansion only.

<b>ADDRESS</b> <b>EXTENSION</b>
       When a mail address localpart contains the optional recip-
       ient delimiter (e.g., <i>user+foo</i>@<i>domain</i>), the  lookup  order
       becomes: <i>user+foo</i>@<i>domain</i>, <i>user</i>@<i>domain</i>, <i>user+foo</i>, <i>user</i>, and
       @<i>domain</i>.  An unmatched address extension (<i>+foo</i>) is  propa-
       gated to the result of table lookup.

<b>VIRTUAL</b> <b>ALIAS</b> <b>DOMAINS</b>
       Besides  virtual aliases, the virtual alias table can also
       be used to implement virtual alias domains. With a virtual
       alias  domain,  all  recipient  addresses  are  aliased to
       addresses in other domains.

       Virtual alias domains are not to be confused with the vir-
       tual mailbox domains that are implemented with the Postfix
       <a href="virtual.8.html"><b>virtual</b>(8)</a>  mail  delivery  agent.  With  virtual  mailbox
       domains,  each recipient address can have its own mailbox.

       With a virtual alias domain, the virtual  domain  has  its
       own  user  name  space. Local (i.e. non-virtual) usernames
       are not visible in a virtual alias domain. In  particular,
       local  <a href="aliases.5.html"><b>aliases</b>(5)</a>  and local mailing lists are not visible
       as <i>localname@virtual-alias.domain</i>.

       Support for a virtual alias domain looks like:

       /etc/postfix/main.cf:
           virtual_alias_maps = hash:/etc/postfix/virtual

           Note: some systems use <b>dbm</b> databases instead of  <b>hash</b>.
           See the output from <b>postconf</b> <b>-m</b> for available database
           types.

       /etc/postfix/virtual:
           <i>virtual-alias.domain</i> <i>anything</i> (right-hand content does not matter)
           <i>postmaster@virtual-alias.domain</i>      <i>postmaster</i>
           <i>user1@virtual-alias.domain</i>   <i>address1</i>
           <i>user2@virtual-alias.domain</i>   <i>address2,</i> <i>address3</i>

       The <i>virtual-alias.domain</i> <i>anything</i> entry is required for  a
       virtual alias domain. <b>Without</b> <b>this</b> <b>entry,</b> <b>mail</b> <b>is</b> <b>rejected</b>
       <b>with</b> <b>"relay</b> <b>access</b> <b>denied",</b> <b>or</b> <b>bounces</b>  <b>with</b>  <b>"mail</b>  <b>loops</b>
       <b>back</b> <b>to</b> <b>myself".</b>

       Do  not  specify virtual alias domain names in the <b>main.cf</b>
       <b>mydestination</b> or <b>relay</b><i>_</i><b>domains</b> configuration parameters.

       With a virtual  alias  domain,  the  Postfix  SMTP  server
       accepts   mail  for  <i>known-user@virtual-alias.domain</i>,  and
       rejects  mail  for  <i>unknown-user</i>@<i>virtual-alias.domain</i>   as
       undeliverable.

       Instead  of  specifying  the virtual alias domain name via
       the <b>virtual</b><i>_</i><b>alias</b><i>_</i><b>maps</b> table, you may also specify it  via
       the <b>main.cf</b> <b>virtual</b><i>_</i><b>alias</b><i>_</i><b>domains</b> configuration parameter.
       This latter parameter uses the same syntax as the  <b>main.cf</b>
       <b>mydestination</b> configuration parameter.

<b>REGULAR</b> <b>EXPRESSION</b> <b>TABLES</b>
       This  section  describes how the table lookups change when
       the table is given in the form of regular expressions. For
       a  description  of regular expression lookup table syntax,
       see <a href="regexp_table.5.html"><b>regexp</b><i>_</i><b>table</b>(5)</a> or <a href="pcre_table.5.html"><b>pcre</b><i>_</i><b>table</b>(5)</a>.

       Each pattern is a regular expression that  is  applied  to
       the entire address being looked up. Thus, <i>user@domain</i> mail
       addresses are not broken up into their  <i>user</i>  and  <i>@domain</i>
       constituent parts, nor is <i>user+foo</i> broken up into <i>user</i> and
       <i>foo</i>.

       Patterns are applied in the  order  as  specified  in  the
       table,  until  a  pattern is found that matches the search
       string.

       Results are the same as with indexed  file  lookups,  with
       the  additional feature that parenthesized substrings from
       the pattern can be interpolated as <b>$1</b>, <b>$2</b> and so on.

<b>BUGS</b>
       The table format does not understand quoting  conventions.

<b>CONFIGURATION</b> <b>PARAMETERS</b>
       The  following  <b>main.cf</b> parameters are especially relevant
       to this topic. See the Postfix  <b>main.cf</b>  file  for  syntax
       details  and  for  default  values. Use the <b>postfix</b> <b>reload</b>
       command after a configuration change.

       <b>virtual</b><i>_</i><b>alias</b><i>_</i><b>maps</b>
              List of virtual aliasing tables.

       <b>virtual</b><i>_</i><b>alias</b><i>_</i><b>domains</b>
              List of virtual alias domains. This uses  the  same
              syntax as the <b>mydestination</b> parameter.

       Other parameters of interest:

       <b>inet</b><i>_</i><b>interfaces</b>
              The  network  interface  addresses that this system
              receives mail on.  You need to stop and start Post-
              fix when this parameter changes.

       <b>mydestination</b>
              List  of  domains  that  this mail system considers
              local.

       <b>myorigin</b>
              The domain that is appended  to  any  address  that
              does not have a domain.

       <b>owner</b><i>_</i><b>request</b><i>_</i><b>special</b>
              Give special treatment to <b>owner-</b><i>xxx</i> and <i>xxx</i><b>-request</b>
              addresses.

<b>SEE</b> <b>ALSO</b>
       <a href="cleanup.8.html">cleanup(8)</a> canonicalize and enqueue mail
       <a href="postmap.1.html">postmap(1)</a> create mapping table
       <a href="regexp_table.5.html">regexp_table(5)</a> POSIX regular expression table format
       <a href="pcre_table.5.html">pcre_table(5)</a> Perl Compatible Regular Expression table format

<b>LICENSE</b>
       The Secure Mailer license must be  distributed  with  this
       software.

<b>AUTHOR(S)</b>
       Wietse Venema
       IBM T.J. Watson Research
       P.O. Box 704
       Yorktown Heights, NY 10598, USA

                                                       VIRTUAL(5)
</pre> </body> </html>
