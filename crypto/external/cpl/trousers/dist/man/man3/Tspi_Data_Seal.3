.\" Copyright (C) 2004 International Business Machines Corporation
.\" Written by Kathy Robertson based on the Trusted Computing Group Software Stack Specification Version 1.1 Golden
.\"
.de Sh \" Subsection
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Ip \" List item
.br
.ie \\n(.$>=3 .ne \\$3
.el .ne 3
.IP "\\$1" \\$2
..
.TH "Tspi_Data_Seal" 3 "2004-05-26" "TSS 1.1" "TCG Software Stack Developer's Reference"
.SH NAME
Tspi_Data_Seal \- encrypt a data blob in a mannar that is only decryptable by Tspi_Data_Unseal on the same system.
.SH "SYNOPSIS"
.ad l
.hy 0
.nf
.B #include <tss/platform.h>
.B #include <tss/tcpa_defines.h>
.B #include <tss/tcpa_typedef.h>
.B #include <tss/tcpa_struct.h>
.B #include <tss/tss_typedef.h>
.B #include <tss/tss_structs.h>
.B #include <tss/tspi.h>
.sp
.BI "TSS_RESULT Tspi_Data_Seal(TSS_HENCDATA " hEncData ",     TSS_HKEY " hEncKey ","
.BI "                          UINT32       " ulDataLength ", BYTE*    " rgbDataToSeal ","
.BI "                          TSS_HPCRS    " hPcrComposite ");"
.fi
.sp
.ad
.hy

.SH "DESCRIPTION"
.PP
\fBTspi_Data_Seal\fR encrypts a data blob in a mannar that is only decryptable by Tspi_Data_Unseal on the same system. The data blob is encrypted using a public key operation with the nonmigratable key addressed by the given encryption key object.
.SH "PARAMETERS"
.PP
.SS hEncData
Handle of the data object which contains the sealed data on successful completion of the command.
.PP
.SS hEncKey
Handle to the key object addressing the nonmigratable key which is used to encrypt the data.
.PP
.SS ulDataLength
The Length (in bytes) of the rgbDataToSeal parameter.
.PP
.SS rgbDataToSeal
Pointer to memory containing the data to be encrypted.
.PP
.SS hPcrComposite
Handle of the PCR Composite object specifying the PCRs which are part of the sealed data blob. Set to NULL, if the encrypted data should only be bound to the system and PCRs are not of interest. 
.SH "RETURN CODES"
.PP
\fBTspi_Data_Seal\fR returns TSS_SUCCESS on success, otherwise one of the following values are returned:
.TP
.SM TSS_E_INVALID_HANDLE - One of the following parameters \fIhEncData\fR, \fIhEncKey\fR, \fIrgbDataToSeal\fR is invalid.
.TP
.SM TSS_E_INTERNAL_ERROR - An error occurred internal to the TSS.

.SH "CONFORMING TO"

.PP
\fBTspi_Data_Seal\fR conforms to the Trusted Computing Group Software Specification version 1.1 Golden

.SH "SEE ALSO"

.PP
\fBTspi_Data_Unseal\fR(3).



