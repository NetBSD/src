<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>hx509 CMS/pkcs7 functions</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<p>
<a href="http://www.h5l.org/"><img src="http://www.h5l.org/keyhole-heimdal.png" alt="keyhole logo"/></a>
</p>
<!-- end of header marker -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">hx509 CMS/pkcs7 functions</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga59a1f6dc31e384a0d378c8179f2be9c3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hx509__cms.html#ga59a1f6dc31e384a0d378c8179f2be9c3">hx509_cms_wrap_ContentInfo</a> (const heim_oid *oid, const heim_octet_string *buf, heim_octet_string *res)</td></tr>
<tr class="separator:ga59a1f6dc31e384a0d378c8179f2be9c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaacbd636f3053c560782d83251f42b71a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hx509__cms.html#gaacbd636f3053c560782d83251f42b71a">hx509_cms_unwrap_ContentInfo</a> (const heim_octet_string *in, heim_oid *oid, heim_octet_string *out, int *have_data)</td></tr>
<tr class="separator:gaacbd636f3053c560782d83251f42b71a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab13d28bf986e3b66c05e7e33799be07b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hx509__cms.html#gab13d28bf986e3b66c05e7e33799be07b">hx509_cms_unenvelope</a> (hx509_context context, hx509_certs certs, int flags, const void *data, size_t length, const heim_octet_string *encryptedContent, time_t time_now, heim_oid *contentType, heim_octet_string *content)</td></tr>
<tr class="separator:gab13d28bf986e3b66c05e7e33799be07b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga618f32b35fa6f679cc5f32fb8abdbe85"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hx509__cms.html#ga618f32b35fa6f679cc5f32fb8abdbe85">hx509_cms_envelope_1</a> (hx509_context context, int flags, hx509_cert cert, const void *data, size_t length, const heim_oid *encryption_type, const heim_oid *contentType, heim_octet_string *content)</td></tr>
<tr class="separator:ga618f32b35fa6f679cc5f32fb8abdbe85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaedaf18507474021a8d092ca6ac90a1ad"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hx509__cms.html#gaedaf18507474021a8d092ca6ac90a1ad">hx509_cms_verify_signed</a> (hx509_context context, hx509_verify_ctx ctx, unsigned int flags, const void *data, size_t length, const heim_octet_string *signedContent, hx509_certs pool, heim_oid *contentType, heim_octet_string *content, hx509_certs *signer_certs)</td></tr>
<tr class="separator:gaedaf18507474021a8d092ca6ac90a1ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8dfb6d8d72f6a71caffaf11b9d847921"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hx509__cms.html#ga8dfb6d8d72f6a71caffaf11b9d847921">hx509_cms_create_signed_1</a> (hx509_context context, int flags, const heim_oid *eContentType, const void *data, size_t length, const AlgorithmIdentifier *digest_alg, hx509_cert cert, hx509_peer_info peer, hx509_certs anchors, hx509_certs pool, heim_octet_string *signed_data)</td></tr>
<tr class="separator:ga8dfb6d8d72f6a71caffaf11b9d847921"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>See the <a class="el" href="page_cms.html">CMS/PKCS7 message functions.</a> for description and examples. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga8dfb6d8d72f6a71caffaf11b9d847921"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8dfb6d8d72f6a71caffaf11b9d847921">&#9670;&nbsp;</a></span>hx509_cms_create_signed_1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hx509_cms_create_signed_1 </td>
          <td>(</td>
          <td class="paramtype">hx509_context&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const heim_oid *&#160;</td>
          <td class="paramname"><em>eContentType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const AlgorithmIdentifier *&#160;</td>
          <td class="paramname"><em>digest_alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hx509_cert&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hx509_peer_info&#160;</td>
          <td class="paramname"><em>peer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hx509_certs&#160;</td>
          <td class="paramname"><em>anchors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hx509_certs&#160;</td>
          <td class="paramname"><em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">heim_octet_string *&#160;</td>
          <td class="paramname"><em>signed_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decode SignedData and verify that the signature is correct.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>A hx509 context. </td></tr>
    <tr><td class="paramname">flags</td><td></td></tr>
    <tr><td class="paramname">eContentType</td><td>the type of the data. </td></tr>
    <tr><td class="paramname">data</td><td>data to sign </td></tr>
    <tr><td class="paramname">length</td><td>length of the data that data point to. </td></tr>
    <tr><td class="paramname">digest_alg</td><td>digest algorithm to use, use NULL to get the default or the peer determined algorithm. </td></tr>
    <tr><td class="paramname">cert</td><td>certificate to use for sign the data. </td></tr>
    <tr><td class="paramname">peer</td><td>info about the peer the message to send the message to, like what digest algorithm to use. </td></tr>
    <tr><td class="paramname">anchors</td><td>trust anchors that the client will use, used to polulate the certificates included in the message </td></tr>
    <tr><td class="paramname">pool</td><td>certificates to use in try to build the path to the trust anchors. </td></tr>
    <tr><td class="paramname">signed_data</td><td>the output of the function, free with der_free_octet_string().</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns an hx509 error code. </dd></dl>

</div>
</div>
<a id="ga618f32b35fa6f679cc5f32fb8abdbe85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga618f32b35fa6f679cc5f32fb8abdbe85">&#9670;&nbsp;</a></span>hx509_cms_envelope_1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hx509_cms_envelope_1 </td>
          <td>(</td>
          <td class="paramtype">hx509_context&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hx509_cert&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const heim_oid *&#160;</td>
          <td class="paramname"><em>encryption_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const heim_oid *&#160;</td>
          <td class="paramname"><em>contentType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">heim_octet_string *&#160;</td>
          <td class="paramname"><em>content</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Encrypt end encode EnvelopedData.</p>
<p>Encrypt and encode EnvelopedData. The data is encrypted with a random key and the the random key is encrypted with the certificates private key. This limits what private key type can be used to RSA.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>A hx509 context. </td></tr>
    <tr><td class="paramname">flags</td><td>flags to control the behavior.<ul>
<li>HX509_CMS_EV_NO_KU_CHECK - Don't check KU on certificate</li>
<li>HX509_CMS_EV_ALLOW_WEAK - Allow weak crytpo</li>
<li>HX509_CMS_EV_ID_NAME - prefer issuer name and serial number </li>
</ul>
</td></tr>
    <tr><td class="paramname">cert</td><td>Certificate to encrypt the EnvelopedData encryption key with. </td></tr>
    <tr><td class="paramname">data</td><td>pointer the data to encrypt. </td></tr>
    <tr><td class="paramname">length</td><td>length of the data that data point to. </td></tr>
    <tr><td class="paramname">encryption_type</td><td>Encryption cipher to use for the bulk data, use NULL to get default. </td></tr>
    <tr><td class="paramname">contentType</td><td>type of the data that is encrypted </td></tr>
    <tr><td class="paramname">content</td><td>the output of the function, free with der_free_octet_string().</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>an hx509 error code. </dd></dl>

</div>
</div>
<a id="gab13d28bf986e3b66c05e7e33799be07b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab13d28bf986e3b66c05e7e33799be07b">&#9670;&nbsp;</a></span>hx509_cms_unenvelope()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hx509_cms_unenvelope </td>
          <td>(</td>
          <td class="paramtype">hx509_context&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hx509_certs&#160;</td>
          <td class="paramname"><em>certs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const heim_octet_string *&#160;</td>
          <td class="paramname"><em>encryptedContent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>time_now</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">heim_oid *&#160;</td>
          <td class="paramname"><em>contentType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">heim_octet_string *&#160;</td>
          <td class="paramname"><em>content</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decode and unencrypt EnvelopedData.</p>
<p>Extract data and parameteres from from the EnvelopedData. Also supports using detached EnvelopedData.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>A hx509 context. </td></tr>
    <tr><td class="paramname">certs</td><td>Certificate that can decrypt the EnvelopedData encryption key. </td></tr>
    <tr><td class="paramname">flags</td><td>HX509_CMS_UE flags to control the behavior. </td></tr>
    <tr><td class="paramname">data</td><td>pointer the structure the contains the DER/BER encoded EnvelopedData stucture. </td></tr>
    <tr><td class="paramname">length</td><td>length of the data that data point to. </td></tr>
    <tr><td class="paramname">encryptedContent</td><td>in case of detached signature, this contains the actual encrypted data, othersize its should be NULL. </td></tr>
    <tr><td class="paramname">time_now</td><td>set the current time, if zero the library uses now as the date. </td></tr>
    <tr><td class="paramname">contentType</td><td>output type oid, should be freed with der_free_oid(). </td></tr>
    <tr><td class="paramname">content</td><td>the data, free with der_free_octet_string().</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>an hx509 error code. </dd></dl>

</div>
</div>
<a id="gaacbd636f3053c560782d83251f42b71a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaacbd636f3053c560782d83251f42b71a">&#9670;&nbsp;</a></span>hx509_cms_unwrap_ContentInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hx509_cms_unwrap_ContentInfo </td>
          <td>(</td>
          <td class="paramtype">const heim_octet_string *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">heim_oid *&#160;</td>
          <td class="paramname"><em>oid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">heim_octet_string *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>have_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decode an ContentInfo and unwrap data and oid it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>the encoded buffer. </td></tr>
    <tr><td class="paramname">oid</td><td>type of the content. </td></tr>
    <tr><td class="paramname">out</td><td>data to be wrapped. </td></tr>
    <tr><td class="paramname">have_data</td><td>since the data is optional, this flags show dthe diffrence between no data and the zero length data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns an hx509 error code. </dd></dl>

</div>
</div>
<a id="gaedaf18507474021a8d092ca6ac90a1ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaedaf18507474021a8d092ca6ac90a1ad">&#9670;&nbsp;</a></span>hx509_cms_verify_signed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hx509_cms_verify_signed </td>
          <td>(</td>
          <td class="paramtype">hx509_context&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hx509_verify_ctx&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const heim_octet_string *&#160;</td>
          <td class="paramname"><em>signedContent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hx509_certs&#160;</td>
          <td class="paramname"><em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">heim_oid *&#160;</td>
          <td class="paramname"><em>contentType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">heim_octet_string *&#160;</td>
          <td class="paramname"><em>content</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hx509_certs *&#160;</td>
          <td class="paramname"><em>signer_certs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decode SignedData and verify that the signature is correct.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>A hx509 context. </td></tr>
    <tr><td class="paramname">ctx</td><td>a hx509 verify context. </td></tr>
    <tr><td class="paramname">flags</td><td>to control the behaivor of the function.<ul>
<li>HX509_CMS_VS_NO_KU_CHECK - Don't check KeyUsage</li>
<li>HX509_CMS_VS_ALLOW_DATA_OID_MISMATCH - allow oid mismatch</li>
<li>HX509_CMS_VS_ALLOW_ZERO_SIGNER - no signer, see below. </li>
</ul>
</td></tr>
    <tr><td class="paramname">data</td><td>pointer to CMS SignedData encoded data. </td></tr>
    <tr><td class="paramname">length</td><td>length of the data that data point to. </td></tr>
    <tr><td class="paramname">signedContent</td><td>external data used for signature. </td></tr>
    <tr><td class="paramname">pool</td><td>certificate pool to build certificates paths. </td></tr>
    <tr><td class="paramname">contentType</td><td>free with der_free_oid(). </td></tr>
    <tr><td class="paramname">content</td><td>the output of the function, free with der_free_octet_string(). </td></tr>
    <tr><td class="paramname">signer_certs</td><td>list of the cerficates used to sign this request, free with <a class="el" href="group__hx509__keyset.html#gaa3df96cfe4137beaea7e7b87b95dbe3f">hx509_certs_free()</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>an hx509 error code. </dd></dl>
<p>If HX509_CMS_VS_NO_KU_CHECK is set, allow more liberal search for matching certificates by not considering KeyUsage bits on the certificates.</p>
<p>If HX509_CMS_VS_ALLOW_DATA_OID_MISMATCH, allow encapContentInfo mismatch with the oid in signedAttributes (or if no signedAttributes where use, pkcs7-data oid). This is only needed to work with broken CMS implementations that doesn't follow CMS signedAttributes rules.</p>
<p>If HX509_CMS_VS_NO_VALIDATE flags is set, do not verify the signing certificates and leave that up to the caller.</p>
<p>If HX509_CMS_VS_ALLOW_ZERO_SIGNER is set, allow empty SignerInfo (no signatures). If SignedData have no signatures, the function will return 0 with signer_certs set to NULL. Zero signers is allowed by the standard, but since its only useful in corner cases, it make into a flag that the caller have to turn on.</p>

</div>
</div>
<a id="ga59a1f6dc31e384a0d378c8179f2be9c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga59a1f6dc31e384a0d378c8179f2be9c3">&#9670;&nbsp;</a></span>hx509_cms_wrap_ContentInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hx509_cms_wrap_ContentInfo </td>
          <td>(</td>
          <td class="paramtype">const heim_oid *&#160;</td>
          <td class="paramname"><em>oid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const heim_octet_string *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">heim_octet_string *&#160;</td>
          <td class="paramname"><em>res</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Wrap data and oid in a ContentInfo and encode it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">oid</td><td>type of the content. </td></tr>
    <tr><td class="paramname">buf</td><td>data to be wrapped. If a NULL pointer is passed in, the optional content field in the ContentInfo is not going be filled in. </td></tr>
    <tr><td class="paramname">res</td><td>the encoded buffer, the result should be freed with der_free_octet_string().</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns an hx509 error code. </dd></dl>

</div>
</div>
</div><!-- contents -->
<hr size="1"><address style="text-align: right;"><small>
Generated on Tue Nov 15 2022 14:04:25 for Heimdal x509 library by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.9.1</small></address>
</body>
</html>
