<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>hx509 verification functions</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<p>
<a href="http://www.h5l.org/"><img src="http://www.h5l.org/keyhole-heimdal.png" alt="keyhole logo"/></a>
</p>
<!-- end of header marker -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">hx509 verification functions</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gacf53ef0c8202b75d946b47266e4777da"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hx509__verify.html#gacf53ef0c8202b75d946b47266e4777da">hx509_context_set_missing_revoke</a> (hx509_context context, int flag)</td></tr>
<tr class="separator:gacf53ef0c8202b75d946b47266e4777da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga53a78d7c374e238354600b754f8ef4c7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hx509__verify.html#ga53a78d7c374e238354600b754f8ef4c7">hx509_verify_init_ctx</a> (hx509_context context, hx509_verify_ctx *ctx)</td></tr>
<tr class="separator:ga53a78d7c374e238354600b754f8ef4c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa90ca3387075fbdf3ae014beda0b4108"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hx509__verify.html#gaa90ca3387075fbdf3ae014beda0b4108">hx509_verify_destroy_ctx</a> (hx509_verify_ctx ctx)</td></tr>
<tr class="separator:gaa90ca3387075fbdf3ae014beda0b4108"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaacc284cfe15ebfd4372aa0725d24e8a0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hx509__verify.html#gaacc284cfe15ebfd4372aa0725d24e8a0">hx509_verify_attach_anchors</a> (hx509_verify_ctx ctx, hx509_certs set)</td></tr>
<tr class="separator:gaacc284cfe15ebfd4372aa0725d24e8a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaf1e783c744e3ce3918d7c00f101f1fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hx509__verify.html#gaaf1e783c744e3ce3918d7c00f101f1fc">hx509_verify_attach_revoke</a> (hx509_verify_ctx ctx, hx509_revoke_ctx revoke_ctx)</td></tr>
<tr class="separator:gaaf1e783c744e3ce3918d7c00f101f1fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1490c2944163f25cf02377bae5d0ab37"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hx509__verify.html#ga1490c2944163f25cf02377bae5d0ab37">hx509_verify_set_time</a> (hx509_verify_ctx ctx, time_t t)</td></tr>
<tr class="separator:ga1490c2944163f25cf02377bae5d0ab37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga11a6fe7afbd5cee1af2dedeffcaad33c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hx509__verify.html#ga11a6fe7afbd5cee1af2dedeffcaad33c">hx509_verify_set_max_depth</a> (hx509_verify_ctx ctx, unsigned int max_depth)</td></tr>
<tr class="separator:ga11a6fe7afbd5cee1af2dedeffcaad33c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga50cae1e3d318471ff444770cfec4b0a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hx509__verify.html#ga50cae1e3d318471ff444770cfec4b0a8">hx509_verify_set_proxy_certificate</a> (hx509_verify_ctx ctx, int boolean)</td></tr>
<tr class="separator:ga50cae1e3d318471ff444770cfec4b0a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7c301cedab40be9a495dea2778202140"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hx509__verify.html#ga7c301cedab40be9a495dea2778202140">hx509_verify_set_strict_rfc3280_verification</a> (hx509_verify_ctx ctx, int boolean)</td></tr>
<tr class="separator:ga7c301cedab40be9a495dea2778202140"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1e84c0d08972e2dd87ba89f105183914"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hx509__verify.html#ga1e84c0d08972e2dd87ba89f105183914">hx509_verify_path</a> (hx509_context context, hx509_verify_ctx ctx, hx509_cert cert, hx509_certs pool)</td></tr>
<tr class="separator:ga1e84c0d08972e2dd87ba89f105183914"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae7e5973c6c9a66d599c44d9473ade82a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hx509__verify.html#gae7e5973c6c9a66d599c44d9473ade82a">hx509_ocsp_verify</a> (hx509_context context, time_t now, hx509_cert cert, int flags, const void *data, size_t length, time_t *expiration)</td></tr>
<tr class="separator:gae7e5973c6c9a66d599c44d9473ade82a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8b46fa446893a189808deabc2bc630d1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hx509__verify.html#ga8b46fa446893a189808deabc2bc630d1">hx509_crl_alloc</a> (hx509_context context, hx509_crl *crl)</td></tr>
<tr class="separator:ga8b46fa446893a189808deabc2bc630d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga51a77209dd8f88e8ca52ad618dc62fe6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hx509__verify.html#ga51a77209dd8f88e8ca52ad618dc62fe6">hx509_crl_add_revoked_certs</a> (hx509_context context, hx509_crl crl, hx509_certs certs)</td></tr>
<tr class="separator:ga51a77209dd8f88e8ca52ad618dc62fe6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaff0e82873a480d002cc7f1b69f430e8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hx509__verify.html#gaaff0e82873a480d002cc7f1b69f430e8">hx509_crl_lifetime</a> (hx509_context context, hx509_crl crl, int delta)</td></tr>
<tr class="separator:gaaff0e82873a480d002cc7f1b69f430e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab59b054be16d4607aed4001ee071ecb6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hx509__verify.html#gab59b054be16d4607aed4001ee071ecb6">hx509_crl_free</a> (hx509_context context, hx509_crl *crl)</td></tr>
<tr class="separator:gab59b054be16d4607aed4001ee071ecb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7361cfd5f3b413ea4715977fae210760"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hx509__verify.html#ga7361cfd5f3b413ea4715977fae210760">hx509_crl_sign</a> (hx509_context context, hx509_cert signer, hx509_crl crl, heim_octet_string *os)</td></tr>
<tr class="separator:ga7361cfd5f3b413ea4715977fae210760"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a id="gacf53ef0c8202b75d946b47266e4777da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacf53ef0c8202b75d946b47266e4777da">&#9670;&nbsp;</a></span>hx509_context_set_missing_revoke()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hx509_context_set_missing_revoke </td>
          <td>(</td>
          <td class="paramtype">hx509_context&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Selects if the <a class="el" href="group__hx509__revoke.html#ga3faf6194dc7429f8850e02b3ae2bbeeb">hx509_revoke_verify()</a> function is going to require the existans of a revokation method (OCSP, CRL) or not. Note that <a class="el" href="group__hx509__verify.html#ga1e84c0d08972e2dd87ba89f105183914">hx509_verify_path()</a>, <a class="el" href="group__hx509__cms.html#gaedaf18507474021a8d092ca6ac90a1ad">hx509_cms_verify_signed()</a>, and other function call <a class="el" href="group__hx509__revoke.html#ga3faf6194dc7429f8850e02b3ae2bbeeb">hx509_revoke_verify()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>hx509 context to change the flag for. </td></tr>
    <tr><td class="paramname">flag</td><td>zero, revokation method required, non zero missing revokation method ok </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga51a77209dd8f88e8ca52ad618dc62fe6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga51a77209dd8f88e8ca52ad618dc62fe6">&#9670;&nbsp;</a></span>hx509_crl_add_revoked_certs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hx509_crl_add_revoked_certs </td>
          <td>(</td>
          <td class="paramtype">hx509_context&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hx509_crl&#160;</td>
          <td class="paramname"><em>crl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hx509_certs&#160;</td>
          <td class="paramname"><em>certs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add revoked certificate to an CRL context.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>a hx509 context. </td></tr>
    <tr><td class="paramname">crl</td><td>the CRL to add the revoked certificate to. </td></tr>
    <tr><td class="paramname">certs</td><td>keyset of certificate to revoke.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An hx509 error code, see <a class="el" href="group__hx509__error.html#ga15791abff76719acb531223fdcbcac87">hx509_get_error_string()</a>. </dd></dl>

</div>
</div>
<a id="ga8b46fa446893a189808deabc2bc630d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8b46fa446893a189808deabc2bc630d1">&#9670;&nbsp;</a></span>hx509_crl_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hx509_crl_alloc </td>
          <td>(</td>
          <td class="paramtype">hx509_context&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hx509_crl *&#160;</td>
          <td class="paramname"><em>crl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a CRL context. Use <a class="el" href="group__hx509__verify.html#gab59b054be16d4607aed4001ee071ecb6">hx509_crl_free()</a> to free the CRL context.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>a hx509 context. </td></tr>
    <tr><td class="paramname">crl</td><td>return pointer to a newly allocated CRL context.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An hx509 error code, see <a class="el" href="group__hx509__error.html#ga15791abff76719acb531223fdcbcac87">hx509_get_error_string()</a>. </dd></dl>

</div>
</div>
<a id="gab59b054be16d4607aed4001ee071ecb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab59b054be16d4607aed4001ee071ecb6">&#9670;&nbsp;</a></span>hx509_crl_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hx509_crl_free </td>
          <td>(</td>
          <td class="paramtype">hx509_context&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hx509_crl *&#160;</td>
          <td class="paramname"><em>crl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free a CRL context.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>a hx509 context. </td></tr>
    <tr><td class="paramname">crl</td><td>a CRL context to free. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaaff0e82873a480d002cc7f1b69f430e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaff0e82873a480d002cc7f1b69f430e8">&#9670;&nbsp;</a></span>hx509_crl_lifetime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hx509_crl_lifetime </td>
          <td>(</td>
          <td class="paramtype">hx509_context&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hx509_crl&#160;</td>
          <td class="paramname"><em>crl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>delta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the lifetime of a CRL context.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>a hx509 context. </td></tr>
    <tr><td class="paramname">crl</td><td>a CRL context </td></tr>
    <tr><td class="paramname">delta</td><td>delta time the certificate is valid, library adds the current time to this.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An hx509 error code, see <a class="el" href="group__hx509__error.html#ga15791abff76719acb531223fdcbcac87">hx509_get_error_string()</a>. </dd></dl>

</div>
</div>
<a id="ga7361cfd5f3b413ea4715977fae210760"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7361cfd5f3b413ea4715977fae210760">&#9670;&nbsp;</a></span>hx509_crl_sign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hx509_crl_sign </td>
          <td>(</td>
          <td class="paramtype">hx509_context&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hx509_cert&#160;</td>
          <td class="paramname"><em>signer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hx509_crl&#160;</td>
          <td class="paramname"><em>crl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">heim_octet_string *&#160;</td>
          <td class="paramname"><em>os</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sign a CRL and return an encode certificate.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>a hx509 context. </td></tr>
    <tr><td class="paramname">signer</td><td>certificate to sign the CRL with </td></tr>
    <tr><td class="paramname">crl</td><td>the CRL to sign </td></tr>
    <tr><td class="paramname">os</td><td>return the signed and encoded CRL, free with free_heim_octet_string()</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An hx509 error code, see <a class="el" href="group__hx509__error.html#ga15791abff76719acb531223fdcbcac87">hx509_get_error_string()</a>. </dd></dl>

</div>
</div>
<a id="gae7e5973c6c9a66d599c44d9473ade82a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae7e5973c6c9a66d599c44d9473ade82a">&#9670;&nbsp;</a></span>hx509_ocsp_verify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hx509_ocsp_verify </td>
          <td>(</td>
          <td class="paramtype">hx509_context&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>now</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hx509_cert&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t *&#160;</td>
          <td class="paramname"><em>expiration</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Verify that the certificate is part of the OCSP reply and it's not expired. Doesn't verify signature the OCSP reply or it's done by a authorized sender, that is assumed to be already done.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>a hx509 context </td></tr>
    <tr><td class="paramname">now</td><td>the time right now, if 0, use the current time. </td></tr>
    <tr><td class="paramname">cert</td><td>the certificate to verify </td></tr>
    <tr><td class="paramname">flags</td><td>flags control the behavior </td></tr>
    <tr><td class="paramname">data</td><td>pointer to the encode ocsp reply </td></tr>
    <tr><td class="paramname">length</td><td>the length of the encode ocsp reply </td></tr>
    <tr><td class="paramname">expiration</td><td>return the time the OCSP will expire and need to be rechecked.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An hx509 error code, see <a class="el" href="group__hx509__error.html#ga15791abff76719acb531223fdcbcac87">hx509_get_error_string()</a>. </dd></dl>

</div>
</div>
<a id="gaacc284cfe15ebfd4372aa0725d24e8a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaacc284cfe15ebfd4372aa0725d24e8a0">&#9670;&nbsp;</a></span>hx509_verify_attach_anchors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hx509_verify_attach_anchors </td>
          <td>(</td>
          <td class="paramtype">hx509_verify_ctx&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hx509_certs&#160;</td>
          <td class="paramname"><em>set</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the trust anchors in the verification context, makes an reference to the keyset, so the consumer can free the keyset independent of the destruction of the verification context (ctx). If there already is a keyset attached, it's released.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>a verification context </td></tr>
    <tr><td class="paramname">set</td><td>a keyset containing the trust anchors. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaaf1e783c744e3ce3918d7c00f101f1fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaf1e783c744e3ce3918d7c00f101f1fc">&#9670;&nbsp;</a></span>hx509_verify_attach_revoke()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hx509_verify_attach_revoke </td>
          <td>(</td>
          <td class="paramtype">hx509_verify_ctx&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hx509_revoke_ctx&#160;</td>
          <td class="paramname"><em>revoke_ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Attach an revocation context to the verfication context, , makes an reference to the revoke context, so the consumer can free the revoke context independent of the destruction of the verification context. If there is no revoke context, the verification process is NOT going to check any verification status.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>a verification context. </td></tr>
    <tr><td class="paramname">revoke_ctx</td><td>a revoke context. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaa90ca3387075fbdf3ae014beda0b4108"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa90ca3387075fbdf3ae014beda0b4108">&#9670;&nbsp;</a></span>hx509_verify_destroy_ctx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hx509_verify_destroy_ctx </td>
          <td>(</td>
          <td class="paramtype">hx509_verify_ctx&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free an hx509 verification context.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>the context to be freed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga53a78d7c374e238354600b754f8ef4c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga53a78d7c374e238354600b754f8ef4c7">&#9670;&nbsp;</a></span>hx509_verify_init_ctx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hx509_verify_init_ctx </td>
          <td>(</td>
          <td class="paramtype">hx509_context&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hx509_verify_ctx *&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate an verification context that is used fo control the verification process.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>A hx509 context. </td></tr>
    <tr><td class="paramname">ctx</td><td>returns a pointer to a hx509_verify_ctx object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An hx509 error code, see <a class="el" href="group__hx509__error.html#ga15791abff76719acb531223fdcbcac87">hx509_get_error_string()</a>. </dd></dl>

</div>
</div>
<a id="ga1e84c0d08972e2dd87ba89f105183914"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1e84c0d08972e2dd87ba89f105183914">&#9670;&nbsp;</a></span>hx509_verify_path()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hx509_verify_path </td>
          <td>(</td>
          <td class="paramtype">hx509_context&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hx509_verify_ctx&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hx509_cert&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">hx509_certs&#160;</td>
          <td class="paramname"><em>pool</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Build and verify the path for the certificate to the trust anchor specified in the verify context. The path is constructed from the certificate, the pool and the trust anchors.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>A hx509 context. </td></tr>
    <tr><td class="paramname">ctx</td><td>A hx509 verification context. </td></tr>
    <tr><td class="paramname">cert</td><td>the certificate to build the path from. </td></tr>
    <tr><td class="paramname">pool</td><td>A keyset of certificates to build the chain from.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An hx509 error code, see <a class="el" href="group__hx509__error.html#ga15791abff76719acb531223fdcbcac87">hx509_get_error_string()</a>. </dd></dl>

</div>
</div>
<a id="ga11a6fe7afbd5cee1af2dedeffcaad33c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga11a6fe7afbd5cee1af2dedeffcaad33c">&#9670;&nbsp;</a></span>hx509_verify_set_max_depth()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hx509_verify_set_max_depth </td>
          <td>(</td>
          <td class="paramtype">hx509_verify_ctx&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>max_depth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the maximum depth of the certificate chain that the path builder is going to try.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>a verification context </td></tr>
    <tr><td class="paramname">max_depth</td><td>maxium depth of the certificate chain, include trust anchor. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga50cae1e3d318471ff444770cfec4b0a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga50cae1e3d318471ff444770cfec4b0a8">&#9670;&nbsp;</a></span>hx509_verify_set_proxy_certificate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hx509_verify_set_proxy_certificate </td>
          <td>(</td>
          <td class="paramtype">hx509_verify_ctx&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>boolean</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allow or deny the use of proxy certificates</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>a verification context </td></tr>
    <tr><td class="paramname">boolean</td><td>if non zero, allow proxy certificates. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga7c301cedab40be9a495dea2778202140"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7c301cedab40be9a495dea2778202140">&#9670;&nbsp;</a></span>hx509_verify_set_strict_rfc3280_verification()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hx509_verify_set_strict_rfc3280_verification </td>
          <td>(</td>
          <td class="paramtype">hx509_verify_ctx&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>boolean</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Select strict RFC3280 verification of certificiates. This means checking key usage on CA certificates, this will make version 1 certificiates unuseable.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>a verification context </td></tr>
    <tr><td class="paramname">boolean</td><td>if non zero, use strict verification. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga1490c2944163f25cf02377bae5d0ab37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1490c2944163f25cf02377bae5d0ab37">&#9670;&nbsp;</a></span>hx509_verify_set_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hx509_verify_set_time </td>
          <td>(</td>
          <td class="paramtype">hx509_verify_ctx&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the clock time the the verification process is going to use. Used to check certificate in the past and future time. If not set the current time will be used.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>a verification context. </td></tr>
    <tr><td class="paramname">t</td><td>the time the verifiation is using. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<hr size="1"><address style="text-align: right;"><small>
Generated on Tue Nov 15 2022 14:04:25 for Heimdal x509 library by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.9.1</small></address>
</body>
</html>
